(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[913],{45565:(e,t,r)=>{"use strict";r.r(t);var s={};r.r(s),r.d(s,{BULK_EDIT_GROUP_SETTING:()=>st,CREATE_LOCAL_GROUP:()=>Ze,DELETE_LOCAL_GROUP:()=>je,DELETE_LOCAL_GROUPS:()=>Ke,EDIT_GROUP:()=>He,EDIT_GROUP_SETTING:()=>Qe,FAILED_SAVE_GROUP:()=>Xe,FAILED_SAVE_GROUP_SETTINGS:()=>rt,FINISH_SAVE_GROUP:()=>Je,FINISH_SAVE_GROUP_SETTINGS:()=>tt,MARK_GROUP_FOR_DELETION:()=>qe,RESET_ALL_EDITS:()=>Ve,RESET_BULK_GROUP_SETTING_EDIT:()=>it,RESET_BULK_GROUP_SETTING_EDITS:()=>ot,RESET_EDITS:()=>We,RESET_GROUP_SETTING:()=>Ye,SET_BULK_ERRORS:()=>Be,SET_GROUP_ERROR:()=>xe,START_SAVE_GROUP:()=>ze,START_SAVE_GROUP_SETTINGS:()=>et,applyDefaultGroupSettings:()=>Fe,bulkEditGroupSetting:()=>Ce,createDefaultGroups:()=>$e,createLocalGroup:()=>we,deleteGroup:()=>Le,deleteLocalGroups:()=>Re,editGroup:()=>Se,editGroupSetting:()=>ke,markGroupForDeletion:()=>Ne,resetAllEdits:()=>Oe,resetBulkGroupSettingEdit:()=>Ue,resetBulkGroupSettingEdits:()=>Ae,resetEdits:()=>Ge,saveBulkEdits:()=>Pe,saveGroup:()=>Ie,saveGroupAndSettings:()=>Me,saveGroupSettings:()=>Te,saveGroupSettingsAsBatch:()=>De,saveGroups:()=>ve});var i={};r.r(i),r.d(i,{getAvailableGroups:()=>wt,getBulkErrorsList:()=>Ut,getBulkSettingEdit:()=>Nt,getBulkSettingEdits:()=>Ot,getBulkSettingValue:()=>Lt,getDirtyGroupSettings:()=>It,getDirtyGroups:()=>ht,getEditedGroup:()=>dt,getEditedGroupAttribute:()=>pt,getEditedGroupSetting:()=>bt,getEditedGroupSettings:()=>ft,getEditedGroupsBySetting:()=>St,getEditedMatchableLabel:()=>gt,getError:()=>Ct,getGroupSettingsEdits:()=>yt,getGroupsMarkedForDeletion:()=>Dt,getLocalGroupIds:()=>ut,getMatchableNavIds:()=>Tt,getMatchableType:()=>at,hasBulkSettingEdits:()=>Gt,hasEdits:()=>mt,isDirty:()=>vt,isLocalGroup:()=>lt,isSavingBulkEdits:()=>Rt,isSavingGroupOrSettings:()=>ct,settingHasEdits:()=>Et});var o={};r.r(o),r.d(o,{getAvailableGroups:()=>At});var n=r(6293),u=r(95122),l=r(3571),a=(r(25703),r(31600)),c=(r(87375),r(7980));function d(){return(0,n.createElement)(f,null)}var p=r(73727),g=r(16550),m=r(42236),h=r(48015),E=r(64893),y=r(19144),_=r(91991);function f(){const{url:e,path:t,isExact:r}=(0,g.$B)(),{hash:s,search:i}=(0,g.TH)(),{root:o}=(0,g.UO)(),l=(0,c.useNavigateTo)(),a=(0,h.useSelect)((e=>e("ithemes-security/user-groups-editor").getMatchableNavIds())),{createLocalGroup:d}=(0,h.useDispatch)("ithemes-security/user-groups-editor");return null===a?null:(0,n.createElement)(React.Fragment,null,!r&&(0,n.createElement)(S,{navIds:a,url:e,search:i,hash:s}),(0,n.createElement)(g.rs,null,(0,n.createElement)(g.AW,{path:`${t}/multi`},(0,n.createElement)(v,{navIds:a})),(0,n.createElement)(g.AW,{path:`${t}/:child`},(0,n.createElement)(c.NavigationFill,null,(0,n.createElement)(E.Button,{variant:"link",onClick:async()=>{const{id:t}=await d();l(`${e}/${t}/edit`)},className:"itsec-add-new-user-group-link"},(0,u.__)("New Group","better-wp-security"))),(0,n.createElement)(I,{root:o})),(0,n.createElement)(g.AW,{path:t},a.length>0&&("onboard"===o?(0,n.createElement)(b,null):(0,n.createElement)(g.l_,{to:`${e}/${a[0]}/${i}${s}`})))))}function b(){const{root:e}=(0,g.UO)(),{help:t}=(0,h.useSelect)((e=>e(a.MODULES_STORE_NAME).getModule("user-groups")||{})),r=(0,c.useNavigateTo)(),s=(0,h.useRegistry)(),{applyDefaultGroupSettings:i,createDefaultGroups:o}=(0,h.useDispatch)("ithemes-security/user-groups-editor"),l=()=>{const t=s.select("ithemes-security/user-groups-editor").getMatchableNavIds();r(`/${e}/user-groups/${t[0]}`)};return(0,n.createElement)(React.Fragment,null,(0,n.createElement)(G,null),(0,n.createElement)(c.PageHeader,{title:(0,u.__)("User Groups","better-wp-security"),subtitle:(0,u.__)("User Groups allow you to enable security features for specific sets of users.","better-wp-security"),description:(0,u.__)("Default groups automatically categorize your users by their WordPress capabilities and enable the recommended security settings for each group. Alternatively, start from scratch with custom groups and categorize your users any way you like.","better-wp-security")+" "+(0,u.__)("User Groups won’t change a user’s capabilities, only iThemes Security features are impacted.","better-wp-security"),help:t}),(0,n.createElement)(y.rN,{hasBorder:!0,recommended:!0,messages:(0,u.__)("Recommended: Default User Groups are the simplest way to get started with iThemes Security.","better-wp-security")}),(0,n.createElement)("div",{className:"itsec-user-groups-intro"},(0,n.createElement)(c.SelectableCard,{onClick:async()=>{await o(),await i(),l()},icon:"groups",title:(0,u.__)("Default","better-wp-security"),description:(0,u.__)("Continue with default groups","better-wp-security"),direction:"vertical",recommended:!0}),(0,n.createElement)(c.SelectableCard,{onClick:async()=>{await i(),l()},icon:"edit",title:(0,u.__)("Custom","better-wp-security"),description:(0,u.__)("Create custom groups","better-wp-security"),direction:"vertical"})))}function S(e){let{navIds:t,url:r,search:s,hash:i}=e;const o=(0,h.useSelect)((e=>t.map(e("ithemes-security/user-groups-editor").getEditedMatchableLabel)),[t]),l=t.map(((e,t)=>({title:o[t]||(0,u.__)("Untitled","better-wp-security"),to:`${r}/${e}${s}${i}`,id:e})));return(0,n.createElement)(c.ChildPages,{pages:l})}function I(e){let{root:t}=e;const{child:r}=(0,g.UO)(),{previous:s,next:i,nextPage:o}=(0,c.useNavigation)();return(0,n.createElement)(React.Fragment,null,(0,n.createElement)(G,null),(0,n.createElement)(R,{groupId:r,showSave:"settings"===t}),"settings"!==t&&(0,n.createElement)(E.Flex,null,s&&(0,n.createElement)(E.FlexItem,null,(0,n.createElement)(p.rU,{component:(0,_.Sj)(E.Button),variant:"tertiary",type:"button",to:s},(0,u.__)("Back","better-wp-security"))),(0,n.createElement)(y.Xp,null),i&&(0,n.createElement)(React.Fragment,null,(0,n.createElement)(E.FlexItem,null,(0,n.createElement)(p.rU,{component:(0,_.Sj)(E.Button),variant:"primary",to:i},(0,u.__)("Next","better-wp-security"))),(0,n.createElement)(E.FlexItem,null,(0,n.createElement)(p.rU,{component:(0,_.Sj)(E.Button),variant:"primary",to:o,text:(0,u.__)("Skip User Groups","better-wp-security"),icon:"arrow-right-alt",iconPosition:"right",className:"itsec-button-icon-right"})))))}function v(e){let{navIds:t}=e;const[r,s]=(0,m.Wd)("id",(0,m.Wc)(m.V3,[])),[i,o]=(0,m.Wd)("all",m.dJ);return(0,n.useEffect)((()=>{i&&(s(t),o(void 0))}),[s,i,o,t]),(0,n.createElement)(k,{groupIds:r})}function G(){const e=(0,g.$B)(),{help:t}=(0,h.useSelect)((e=>e(a.MODULES_STORE_NAME).getModule("user-groups")||{}));return(0,n.createElement)(c.HelpFill,null,(0,n.createElement)(c.PageHeader,{title:(0,u.__)("User Groups","better-wp-security"),description:t,breadcrumbs:(0,n.createElement)(c.Breadcrumbs,{title:(0,u.__)("Help","better-wp-security"),match:e})}),(0,n.createElement)(y.ss,{topic:"user-groups"}))}var O=r(92819),N=r(73470),L=r(51783);function R(e){let{groupId:t,showSave:r}=e;const{hash:s,search:i}=(0,g.TH)(),o=(0,N.getQueryArg)(i,"module"),{url:l,path:a}=(0,g.$B)(),{type:c,isDirty:d,isSaving:p,notFound:m}=(0,h.useSelect)((e=>({type:e("ithemes-security/user-groups-editor").getMatchableType(t),isDirty:e("ithemes-security/user-groups-editor").isDirty(t),isSaving:e("ithemes-security/user-groups-editor").isSavingGroupOrSettings(t),notFound:e("ithemes-security/user-groups").isGroupNotFound(t)})),[t]),{saveGroupAndSettings:_,resetEdits:f}=(0,h.useDispatch)("ithemes-security/user-groups-editor"),b=(0,n.useMemo)((()=>[{name:"settings",title:(0,u.__)("Features","better-wp-security"),className:"itsec-manage-user-group-tabs__tab",Component:V},"user-group"===c&&{name:"edit",title:(0,u.__)("Edit Group","better-wp-security"),className:"itsec-manage-user-group-tabs__tab",Component:A}].filter(O.isPlainObject)),[c]);return m?(0,n.createElement)(React.Fragment,null,(0,n.createElement)(y.rN,{type:"error",title:(0,u.__)("No Group Found","better-wp-security"),messages:[(0,u.__)("No user group was found with the requested id.","better-wp-security")]}),(0,n.createElement)("div",{style:{maxWidth:"20rem",margin:"0 auto",display:"block"}},(0,n.createElement)(L.Of,null))):(0,n.createElement)(React.Fragment,null,(0,n.createElement)(ie,{groupId:t,moduleFilter:o}),(0,n.createElement)(g.rs,null,(0,n.createElement)(g.AW,{path:`${a}/:tab`},p?(0,n.createElement)(E.Disabled,null,(0,n.createElement)(w,{groupId:t,base:l,tabs:b,moduleFilter:o})):(0,n.createElement)(w,{groupId:t,base:l,tabs:b,highlight:s.substr(1),moduleFilter:o})),(0,n.createElement)(g.AW,{path:a},(0,n.createElement)(g.l_,{to:`${l}/${b[0].name}/${i}${s}`}))),r&&(0,n.createElement)(E.Flex,null,(0,n.createElement)(y.Xp,null),(0,n.createElement)(E.FlexItem,null,(0,n.createElement)(E.Button,{variant:"secondary",onClick:()=>f(t),disabled:!d},(0,u.__)("Undo Changes","better-wp-security"))),(0,n.createElement)(E.FlexItem,null,(0,n.createElement)(E.Button,{variant:"primary",onClick:()=>_(t),isBusy:p,disabled:p||!d},(0,u.__)("Save","better-wp-security")))))}function w(e){let{groupId:t,base:r,tabs:s,highlight:i,moduleFilter:o}=e;const{url:l,params:{tab:a}}=(0,g.$B)(),d=(0,c.useNavigateTo)(),m=(0,h.useSelect)((e=>e("ithemes-security/user-groups-editor").getError(t)));return o?(0,n.createElement)(E.Card,null,(0,n.createElement)(E.CardHeader,{className:"itsec-user-groups-filtered-features"},(0,n.createElement)(p.rU,{to:l,component:(0,_.Sj)(E.Button),icon:"arrow-left",text:(0,u.__)("All Features","better-wp-security"),variant:"link"})),(0,n.createElement)(V,{moduleFilter:o,groupId:t,highlight:i},(0,n.createElement)(y.KM,{apiError:m}))):(0,n.createElement)(E.Card,null,(0,n.createElement)(y.y2,{tabs:s,isStyled:!0,selected:a,onSelect:e=>{d(`${r}/${e}`,"replace")}},(e=>{let{Component:r}=e;return(0,n.createElement)(r,{groupId:t,highlight:i},(0,n.createElement)(y.KM,{apiError:m}))})))}function k(e){let{groupIds:t,showSave:r=!0}=e;const{isDirty:s,isSaving:i,errors:o}=(0,h.useSelect)((e=>({isDirty:e("ithemes-security/user-groups-editor").hasBulkSettingEdits(),isSaving:e("ithemes-security/user-groups-editor").isSavingBulkEdits(t),errors:e("ithemes-security/user-groups-editor").getBulkErrorsList()}))),{saveBulkEdits:l,resetBulkGroupSettingEdits:a}=(0,h.useDispatch)("ithemes-security/user-groups-editor"),c=(0,n.useMemo)((()=>[{name:"settings",title:(0,u.__)("Features","better-wp-security"),className:"itsec-manage-user-group-tabs__tab",Component:j}]));return(0,n.createElement)(React.Fragment,null,(0,n.createElement)(oe,{groupIds:t}),(0,n.createElement)(E.Card,null,(0,n.createElement)(y.x4,{tabs:c,isStyled:!0},(e=>{let{Component:r}=e;return(0,n.createElement)(r,{groupIds:t},(0,n.createElement)(y.KM,{errors:o}))}))),r&&(0,n.createElement)(E.Flex,null,(0,n.createElement)(y.Xp,null),(0,n.createElement)(E.FlexItem,null,(0,n.createElement)(E.Button,{variant:"secondary",onClick:()=>a(t),disabled:!s},(0,u.__)("Undo Changes","better-wp-security"))),(0,n.createElement)(E.FlexItem,null,(0,n.createElement)(E.Button,{variant:"primary",onClick:()=>l(t),isBusy:i,disabled:i||!s},(0,u.__)("Save","better-wp-security")))))}var T=r(9576);const D=(0,T.compose)([(0,h.withSelect)(((e,t)=>{let{groupId:r}=t;return{label:e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"label")||""}})),(0,h.withDispatch)(((e,t)=>{let{groupId:r}=t;return{edit:t=>e("ithemes-security/user-groups-editor").editGroup(r,t)}}))])((function(e){let{label:t,edit:r,disabled:s=!1}=e;return(0,n.createElement)(E.TextControl,{label:(0,u.__)("Group Name","better-wp-security"),value:t,maxLength:50,disabled:s,onChange:e=>r({label:e})})}));var C=r(94184),U=r.n(C);(0,T.compose)([(0,h.withSelect)((e=>({hasEdits:e("ithemes-security/user-groups-editor").hasEdits("new"),isSaving:e("ithemes-security/user-groups-editor").isCreating("new")}))),(0,h.withDispatch)((e=>({save(){e("ithemes-security/user-groups-editor").createGroup()}})))])((function(e){let{hasEdits:t,save:r,isSaving:s}=e;return(0,n.createElement)(React.Fragment,null,(0,n.createElement)(E.CardBody,{className:"itsec-user-groups-group-tab__edit-fields"},(0,n.createElement)(ne,{groupId:"new"})),(0,n.createElement)(E.CardFooter,null,(0,n.createElement)(y.Xp,null),(0,n.createElement)(E.FlexItem,null,(0,n.createElement)(E.Button,{disabled:!t,variant:"primary",onClick:r,isBusy:s},(0,u.__)("Create","better-wp-security")))))}));const A=(0,T.compose)([(0,h.withSelect)(((e,t)=>{let{groupId:r}=t;return{isLoading:e("core/data").isResolving("ithemes-security/user-groups","getGroup",[r])||e("core/data").isResolving("ithemes-security/core","getIndex")}}))])((function(e){let{groupId:t,isLoading:r,children:s}=e;const i=(0,n.createElement)(React.Fragment,null,(0,n.createElement)(E.CardBody,{className:"itsec-user-groups-group-tab__edit-fields"},s,(0,n.createElement)(ne,{groupId:t,disabled:r})));return r?(0,n.createElement)(E.Disabled,null,i):i}));var P=r(65096),M=r.n(P),F=r(50460);function $(){return $.instance||($.instance=new(M())({schemaId:"id"}),$.instance.addMetaSchema(r(27171))),$.instance}function x(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=$();return(0,h.useSelect)((r=>r("ithemes-security/user-groups").getSettingDefinitions(t,e)),[t,e])}function B(){const{registerCompletionStep:e}=(0,h.useDispatch)(c.ONBOARD_STORE_NAME),{saveGroups:t,saveGroupSettingsAsBatch:r}=(0,h.useDispatch)("ithemes-security/user-groups-editor");(0,_.eH)(B,(()=>{e({id:"savingUserGroups",label:(0,u.__)("Create User Groups","better-wp-security"),priority:15,callback:()=>t(),render:function(){const e=(0,h.useSelect)((e=>{const t=e("ithemes-security/user-groups-editor");return(t.getMatchableNavIds()||[]).map((e=>t.getEditedMatchableLabel(e)))}),[]);return e.length?(0,n.createElement)(React.Fragment,null,(0,n.createElement)("p",null,(0,u.__)("The following User Groups will be created:","better-wp-security")),(0,n.createElement)("ul",null,e.map(((e,t)=>(0,n.createElement)("li",{key:t},e))))):(0,n.createElement)("p",null,(0,u.__)("No User Groups have been created.","better-wp-security"))}}),e({id:"savingUserGroupsSetting",label:(0,u.__)("Setup User Group Settings","better-wp-security"),priority:20,callback:()=>r(),render:function(){const e=x(),{ids:t,labels:r,settings:s}=(0,h.useSelect)((e=>{const t=e("ithemes-security/user-groups-editor"),r=t.getMatchableNavIds()||[];return{ids:r,labels:(0,O.zipObject)(r,r.map((e=>t.getEditedMatchableLabel(e)))),settings:(0,O.zipObject)(r,r.map((e=>t.getEditedGroupSettings(e))))}}),[]);return t.length?(0,n.createElement)(React.Fragment,null,(0,n.createElement)("p",null,(0,u.__)("The following features will be enabled for each User Group:","better-wp-security")),(0,n.createElement)("ul",{className:"itsec-secure-site-user-groups-settings-panel"},t.map((t=>{const i=e.flatMap((e=>s[t]?.[e.id]?(0,O.reduce)(e.settings,((r,i,o)=>(!0===s[t][e.id][o]&&r.push(i.title),r)),[]):[]));return i.length?(0,n.createElement)("li",{key:t},(0,n.createElement)("strong",null,r[t]),(0,n.createElement)("ul",null,i.map(((e,t)=>(0,n.createElement)("li",{key:t},e))))):(0,n.createElement)("li",{key:t},(0,u.sprintf)((0,u.__)("%s: None","better-wp-security"),r[t]))})))):(0,n.createElement)("p",null,(0,u.__)("No User Groups have been created.","better-wp-security"))}})}))}function H(){const{registerProvider:e}=(0,h.useDispatch)(F.G);(0,_.eH)(H,(()=>{e("user-group-settings",(0,u.__)("User Group Settings","better-wp-security"),25,(e=>{let{registry:t,evaluate:r,results:s}=e;return t.select("ithemes-security/user-groups").getSettingDefinitions($()).reduce(((e,t)=>(0,O.reduce)(t.settings,((e,i,o)=>{var n,u,l;return r.stringMatch(i.title)||r.stringMatch(i.description)||r.keywordMatch(i.keywords)?(null!==(l=(n=s.groups)[u=t.id])&&void 0!==l||(n[u]={title:t.title,items:[]}),s.groups[t.id].items.push({title:i.title,description:i.description,route:`/settings/user-groups?module=${t.id}#${t.id}/${o}`}),e++):e}),e)),0)})),e("user-groups",(0,u.__)("User Groups","better-wp-security"),50,(e=>{let{registry:t,evaluate:r,results:s}=e;return(t.select("ithemes-security/user-groups-editor").getAvailableGroups()||[]).reduce(((e,t)=>r.stringMatch(t.label)?(s.items.push({title:t.label,description:t.description,route:`/settings/user-groups/${t.id}`}),e++):e),0)}))}))}const W=(0,T.compose)([(0,h.withSelect)(((e,t)=>{let{groupId:r,module:s,setting:i}=t;return{value:e("ithemes-security/user-groups-editor").getEditedGroupSetting(r,s,i)}})),(0,h.withDispatch)(((e,t)=>{let{groupId:r,module:s,setting:i}=t;return{edit:t=>e("ithemes-security/user-groups-editor").editGroupSetting(r,s,i,t)}}))])((function(e){let{definition:t,value:r,edit:s,className:i,isHighlighted:o,disabled:u=!1}=e;return(0,n.createElement)(E.ToggleControl,{className:U()(i,{"itsec-highlighted-search-result":o}),checked:!0===r,label:t.title,help:t.description,disabled:u,onChange:e=>s(e)})}));function V(e){let{groupId:t,highlight:r,moduleFilter:s,children:i}=e;const o=x({module:s}),{isLoading:u}=(0,h.useSelect)((e=>{let r=!1;if(!e("ithemes-security/user-groups-editor").isLocalGroup(t)){const s=e("ithemes-security/user-groups").getGroupSettings(t),i=e("ithemes-security/user-groups").isResolving("getGroupSettings",[t]);r=!s&&i}return{isLoading:r}}),[t]);let l=(0,n.createElement)(E.CardBody,null,i,(0,n.createElement)(le,{definitions:o,settingComponent:W,groupId:t,disabled:u,highlight:r}));return u&&(l=(0,n.createElement)(E.Disabled,null,l)),(0,n.createElement)(React.Fragment,null,!s&&(0,n.createElement)(ae,null),l)}const Z=(0,T.compose)([(0,h.withSelect)(((e,t)=>{let{module:r,setting:s,groupIds:i}=t;return{value:e("ithemes-security/user-groups-editor").getBulkSettingValue(i,r,s)}})),(0,h.withDispatch)(((e,t)=>{let{module:r,setting:s}=t;return{edit:t=>e("ithemes-security/user-groups-editor").bulkEditGroupSetting(r,s,t)}}))])((function(e){let{definition:t,value:r,edit:s,disabled:i=!1}=e;return(0,n.createElement)(y.Z8,{checked:!0===r,indeterminate:null==r,label:t.title,help:t.description,disabled:i,onChange:e=>s(e)})}));function j(e){let{groupIds:t,children:r}=e;const s=x();let i=(0,n.createElement)(E.CardBody,null,r,(0,n.createElement)(le,{definitions:s,settingComponent:Z,groupIds:t}));return t.length||(i=(0,n.createElement)(E.Disabled,null,i)),(0,n.createElement)(React.Fragment,null,(0,n.createElement)(ae,null),i)}(0,T.compose)([(0,h.withSelect)(((e,t)=>{let{groupId:r}=t;return{minRole:e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"min_role")}})),(0,h.withDispatch)(((e,t)=>{let{groupId:r}=t;return{onChange:t=>e("ithemes-security/user-groups-editor").editGroup(r,t)}}))])((function(e){let{minRole:t,onChange:r}=e;return(0,n.createElement)("div",null,(0,n.createElement)(E.SelectControl,{options:[{value:"administrator",label:(0,u._x)("Administrator","User role")},{value:"editor",label:(0,u._x)("Editor","User role")},{value:"author",label:(0,u._x)("Author","User role")},{value:"contributor",label:(0,u._x)("Contributor","User role")},{value:"subscriber",label:(0,u._x)("Subscriber","User role")}],label:(0,u.__)("Minimum Role","better-wp-security"),value:t,onChange:e=>r({min_role:e}),help:(0,u.__)("Add users with the selected minimum role to this group. To edit roles, go to Users in your WordPress Dashboard.","better-wp-security")}))}));var K=r(59588),q=r.n(K),z=r(31511);const J=q()(((e,t)=>{const r=[{value:"$administrator$",label:(0,u.__)("Administrator Capabilities","better-wp-security")},{value:"$editor$",label:(0,u.__)("Editor Capabilities","better-wp-security")},{value:"$author$",label:(0,u.__)("Author Capabilities","better-wp-security")},{value:"$contributor$",label:(0,u.__)("Contributor Capabilities","better-wp-security")},{value:"$subscriber$",label:(0,u.__)("Subscriber Capabilities","better-wp-security")}];t&&r.unshift({value:"$super-admin$",label:(0,u.__)("Super Admin","better-wp-security")}),(0,O.some)(e,(e=>""===e.canonical))&&r.push({value:"$other$",label:(0,u.__)("Other","better-wp-security"),selectable:!1});for(const t in e){if(!e.hasOwnProperty(t))continue;const{canonical:s,label:i}=e[t];r.push({value:t,parent:s.length>0?`$${s}$`:"$other$",label:i})}return Object.values(r)})),X=(0,T.compose)([(0,h.withSelect)(((e,t)=>{let{groupId:r}=t;return{roles:e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"roles")||[],canonical:e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"canonical")||[],available:e("ithemes-security/core").getRoles(),schema:e("ithemes-security/core").getSchema("ithemes-security-user-group")}})),(0,h.withDispatch)(((e,t)=>{let{groupId:r}=t;return{onChange:t=>e("ithemes-security/user-groups-editor").editGroup(r,t)}}))])((function(e){let{canonical:t,roles:r,onChange:s,available:i,schema:o,disabled:l=!1}=e;const a=(0,O.get)(o,["properties","canonical","items","enum"],[]).includes("super-admin"),c=[...r,...t.map((e=>`$${e}$`))];return(0,n.createElement)(y.gN,{label:(0,u.__)("Select Roles","better-wp-security"),help:(0,u.__)("Add users with the selected roles to this group.","better-wp-security"),value:c,disabled:l,options:J(i,a),onChange:e=>{const[t,r]=(0,z.pL)(e,(e=>e.startsWith("$")&&e.endsWith("$")));s({roles:r,canonical:(0,O.without)(t.map((e=>e.slice(1,-1))),"other")})}})}));var Q=r(87514),Y=r.n(Q);function ee(e){return{value:e.id,label:e.name,user:e}}const te=e=>new Promise(((t,r)=>{Y()({path:(0,N.addQueryArgs)("/wp/v2/users",{search:e,per_page:100,context:"embed",itsec_global:!0})}).then((e=>(e.forEach((0,h.dispatch)("ithemes-security/core").receiveUser),e))).then((e=>t(e.map(ee)))).catch(r)})),re=(0,T.compose)([(0,h.withSelect)(((e,t)=>{let{groupId:r}=t;const s=e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"users")||[],i=[];let o=!1;return s.forEach((t=>{const r=e("ithemes-security/core").getUser(t);r?i.push(r):e("core/data").isResolving("ithemes-security/core","getUser",[t])&&(o=!0)})),{users:i,userIds:s,loading:o}})),(0,h.withDispatch)(((e,t)=>{let{groupId:r}=t;return{receiveUser:e("ithemes-security/core").receiveUser,onChange:t=>e("ithemes-security/user-groups-editor").editGroup(r,t)}})),T.withInstanceId])((function(e){let{instanceId:t,users:r,loading:s,onChange:i,disabled:o=!1}=e;const[l,a]=(0,n.useState)(""),c=`itsec-user-group-panel-users__select-${t}`,d=s?[]:r.map(ee);return(0,n.createElement)(E.BaseControl,{className:"itsec-user-group-panel-users__select-control",label:(0,u.__)("Select Users","better-wp-security"),help:(0,u.__)("Select specific users to add to this group.","better-wp-security"),id:c},(0,n.createElement)(y.qb,{classNamePrefix:"components-itsec-async-select-control",inputId:c,isDisabled:o||s,isLoading:s,isMulti:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:te,value:d,onChange:e=>i({users:(0,O.map)(e,"value")}),inputValue:l,onInputChange:e=>a(e)}))}));var se=r(90071);function ie(e){let{groupId:t,moduleFilter:r}=e;const{root:s}=(0,g.UO)(),i=(0,g.TH)(),{type:o,isDeleting:l,label:a,navIds:d,help:p,module:m}=(0,h.useSelect)((e=>({type:e("ithemes-security/user-groups-editor").getMatchableType(t),isDeleting:e("ithemes-security/user-groups").isDeleting(t),label:e("ithemes-security/user-groups-editor").getEditedMatchableLabel(t),navIds:e("ithemes-security/user-groups-editor").getMatchableNavIds(),help:e("ithemes-security/modules").getModule("user-groups")?.help,module:e("ithemes-security/modules").getModule(r)})),[t,r]),{deleteGroup:y}=(0,h.useDispatch)("ithemes-security/user-groups-editor"),_=(0,c.useNavigateTo)(),f=a||(0,u.__)("Untitled","better-wp-security"),b=(0,c.useBreadcrumbTrail)(m?.label||f),S="user-group"===o;return(0,n.createElement)(c.PageHeader,{title:f,help:p,breadcrumbs:(0,n.createElement)(c.Breadcrumbs,{trail:(0,n.useMemo)((()=>[...b,m&&{to:(0,se.Ep)(i),title:m.title}].filter(O.identity)),[b,m])})},S&&(0,n.createElement)(E.Button,{onClick:async()=>{if(!(await y(t)instanceof Error)){let e;const r=d.findIndex((e=>e===t));-1!==r&&(e=r+1<d.length?r+1:r-1),_(`/${s}/user-groups/${d[e]||""}`)}},isBusy:l,variant:"link",isDestructive:!0},(0,u.__)("Delete Group","better-wp-security")))}function oe(e){let{groupIds:t}=e;const r=(0,h.useSelect)((e=>t.map(e("ithemes-security/user-groups-editor").getEditedMatchableLabel).join(", ")),[t]);return(0,n.createElement)(c.PageHeader,{title:r||(0,u.__)("Select Groups","better-wp-security")})}(0,T.compose)([(0,h.withSelect)((e=>({label:e("ithemes-security/user-groups-editor").getEditedGroupAttribute("new","label")})))])((function(e){let{label:t}=e;return t&&t.length||(t=(0,u.__)("New Group","better-wp-security")),(0,n.createElement)(c.PageHeader,{label:t})}));const ne=function(e){let{groupId:t,disabled:r}=e;return(0,n.createElement)(React.Fragment,null,(0,n.createElement)(D,{groupId:t,disabled:r}),(0,n.createElement)(X,{groupId:t,disabled:r}),(0,n.createElement)(re,{groupId:t,disabled:r}))};var ue=r(87462);function le(e){let{highlight:t,definitions:r,settingComponent:s,...i}=e;const[o,u]=(t||"").split("/");return(0,n.createElement)("form",null,(0,n.createElement)("ul",{className:"itsec-user-groups-group-tab__modules-list"},(0,O.map)(r,(e=>!(0,O.isEmpty)(e.settings)&&(0,n.createElement)("li",{key:e.id,className:"itsec-user-groups-group-tab_settings-list"},(0,n.createElement)("h3",null,e.title),(0,O.map)(e.settings,((t,r)=>(0,n.createElement)(s,(0,ue.Z)({key:r,definition:t,module:e.id,setting:r,isHighlighted:e.id===o&&r===u},i)))))))))}function ae(){const[e,t]=(0,m.Wd)("id",(0,m.Wc)(m.V3,[])),[r]=(0,m.Wd)("back"),{root:s,child:i}=(0,g.UO)(),o=(0,c.useNavigateTo)(),{matchables:l,isLocal:a}=(0,h.useSelect)((e=>({matchables:e("ithemes-security/user-groups").getMatchables()||[],isLocal:i&&e("ithemes-security/user-groups-editor").isLocalGroup(i)})),[i]);if("settings"!==s)return null;let d=(0,u.__)("Select multiple User Groups to edit together.","better-wp-security");return a&&(d=(0,n.createElement)(React.Fragment,null,d,(0,n.createElement)(y.J$,{help:(0,u.__)("Save the User Group first to enable multi-editing.","better-wp-security")}))),(0,n.createElement)("div",{className:"itsec-user-groups-multi-group-selector"},(0,n.createElement)(E.CheckboxControl,{label:d,onChange:e=>{o(e?`/${s}/user-groups/multi?id=${i}&back=${i}`:r?`/${s}/user-groups/${r}`:`/${s}/user-groups`,"replace")},checked:!i,disabled:a}),!i&&(0,n.createElement)("fieldset",null,(0,n.createElement)(E.VisuallyHidden,{as:"legend"},(0,u.__)("User Groups","better-wp-security")),(0,n.createElement)(y.Gs,{label:(0,u.__)("Select All","better-wp-security"),checked:e.length===l.length,onChange:e=>{t(e?l.map((e=>e.id)):[])},className:"itsec-user-groups-multi-group-selector__select-all"}),l.map((r=>(0,n.createElement)(ce,{key:r.id,id:r.id,selected:e,setSelected:t})))))}function ce(e){let{id:t,selected:r,setSelected:s}=e;const{label:i}=(0,h.useSelect)((e=>({label:e("ithemes-security/user-groups-editor").getEditedMatchableLabel(t)})),[t]);return(0,n.createElement)(y.Gs,{label:i,checked:r.includes(t),onChange:e=>{s(e?[...r,t]:(0,O.without)(r,t),"replaceIn")}})}function de(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"info",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...r}}}const pe={API_FETCH(e){let{request:t}=e;return Y()(t).catch(z.xJ)},SELECT(e){let{storeKey:t,selectorName:r,args:s}=e;return(0,h.select)(t)[r](...s)},DISPATCH(e){let{storeKey:t,actionName:r,args:s}=e;return(0,h.dispatch)(t)[r](...s)},CREATE_NOTICE(e){let{status:t,content:r,options:s}=e;s.autoDismiss&&(s.id=s.id||(0,O.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,h.dispatch)("core/notices").removeNotice(s.id,s.context)),s.autoDismiss)),(0,h.dispatch)("core/notices").createNotice(t,r,s)}};var ge,me=new Uint8Array(16);function he(){if(!ge&&!(ge="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ge(me)}const Ee=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,ye=function(e){return"string"==typeof e&&Ee.test(e)};for(var _e=[],fe=0;fe<256;++fe)_e.push((fe+256).toString(16).substr(1));const be=function(e,t,r){var s=(e=e||{}).random||(e.rng||he)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=s[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(_e[e[t+0]]+_e[e[t+1]]+_e[e[t+2]]+_e[e[t+3]]+"-"+_e[e[t+4]]+_e[e[t+5]]+"-"+_e[e[t+6]]+_e[e[t+7]]+"-"+_e[e[t+8]]+_e[e[t+9]]+"-"+_e[e[t+10]]+_e[e[t+11]]+_e[e[t+12]]+_e[e[t+13]]+_e[e[t+14]]+_e[e[t+15]]).toLowerCase();if(!ye(r))throw TypeError("Stringified UUID is invalid");return r}(s)};function*Se(e,t){const r=!(yield h.controls.select("ithemes-security/user-groups-editor","isLocalGroup",e))&&(yield h.controls.select("ithemes-security/user-groups","getGroup",e)),s={...(yield h.controls.select("ithemes-security/user-groups-editor","getEditedGroup",e))||{},...t},i=(0,O.pickBy)(s,((e,t)=>!(0,O.isEqual)(r?.[t],e)));yield{type:He,id:e,edit:i}}function*Ie(e){const t=yield h.controls.select("ithemes-security/user-groups-editor","getEditedGroup",e);if(!t)return;let r;return yield{type:ze,id:e},r=(yield h.controls.select("ithemes-security/user-groups-editor","isLocalGroup",e))?yield h.controls.dispatch("ithemes-security/user-groups","createGroup",{...t,id:e}):yield h.controls.dispatch("ithemes-security/user-groups","updateGroup",e,t),r instanceof Error?yield{type:Xe,id:e,error:r}:(yield{type:Je,id:e,updated:r},yield de("success",(0,u.__)("Saved group.","better-wp-security"),{type:"snackbar"})),r}function*ve(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=yield h.controls.select("ithemes-security/user-groups-editor","getLocalGroupIds"),r=yield h.controls.select("ithemes-security/user-groups-editor","getGroupsMarkedForDeletion");if(!0===e?e=[...new Set([...yield h.controls.select("ithemes-security/user-groups-editor","getDirtyGroups"),...t,...r])]:(0,O.isString)(e)&&(e=[e]),!e.length)return[];const s=[],i=[],o=[];for(const n of e){const e=yield h.controls.select("ithemes-security/user-groups-editor","getEditedGroup",n);r.includes(n)?o.push(n):t.includes(n)?i.push({...e,id:n}):s.push({...e,id:n})}const n=yield h.controls.dispatch("ithemes-security/user-groups","saveGroups",{create:i,update:s,delete:o});if(n instanceof Error)return yield de("error",(0,u.sprintf)((0,u.__)("Could not save user groups: %s","better-wp-security"),n.message)),n;for(const[e,t]of Object.entries(n.byId))t.status>=400?yield{type:Xe,id:e,error:t.body}:yield{type:Je,id:e,updated:t.body};return yield de("success",(0,u.__)("Saved user groups.","better-wp-security"),{type:"snackbar"}),n}function Ge(e){return{type:We,id:e}}function Oe(){return{type:Ve}}function Ne(e){return{type:qe,id:e}}function*Le(e){if(yield h.controls.select("ithemes-security/user-groups-editor","isLocalGroup",e))yield{type:je,id:e};else{const t=yield h.controls.dispatch("ithemes-security/user-groups","deleteGroup",e);if(t instanceof Error)return yield{type:xe,id:e,error:t},t}yield Ge(e),yield{type:xe,id:e,error:null}}function Re(){return{type:Ke}}function we(e){return{type:Ze,id:e||be()}}function*ke(e,t,r,s){const i=!(yield h.controls.select("ithemes-security/user-groups-editor","isLocalGroup",e))&&(yield h.controls.select("ithemes-security/user-groups","getGroupSetting",e,t,r));(0,O.isEqual)(i,s)?yield{type:Ye,id:e,module:t,setting:r}:yield{type:Qe,id:e,module:t,setting:r,value:s}}function*Te(e){const t=yield h.controls.select("ithemes-security/user-groups-editor","getGroupSettingsEdits",e);if(!t)return;yield{type:et,id:e};const r=yield h.controls.dispatch("ithemes-security/user-groups","updateGroupSettings",e,t);return r instanceof Error?yield{type:rt,id:e,error:r}:(yield{type:tt,id:e,updated:r},yield de("success",(0,u.__)("Updated group settings.","better-wp-security"),{type:"snackbar"})),r}function*De(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e?e=yield h.controls.select("ithemes-security/user-groups-editor","getDirtyGroupSettings"):(0,O.isString)(e)&&(e=[e]),!e.length)return{responses:[],byId:{}};const t={};for(const r of e)t[r]=yield h.controls.select("ithemes-security/user-groups-editor","getGroupSettingsEdits",r);const r=yield h.controls.dispatch("ithemes-security/user-groups","saveGroupSettingsAsBatch",t);if(r instanceof Error)return yield de("error",(0,u.sprintf)((0,u.__)("Could not save user groups: %s","better-wp-security"),r.message)),r;for(const[e,t]of Object.entries(r.byId))t.status>=400?yield{type:rt,id:e,error:t.body}:yield{type:tt,id:e,updated:t.body};return yield de("success",(0,u.__)("Saved user groups.","better-wp-security"),{type:"snackbar"}),r}function Ce(e,t,r){return{type:st,module:e,setting:t,value:r}}function Ue(e,t){return{type:it,module:e,setting:t}}function Ae(){return{type:ot}}function*Pe(e){const t=yield h.controls.select("ithemes-security/user-groups-editor","getBulkSettingEdits"),r=yield h.controls.dispatch("ithemes-security/user-groups","patchBulkGroupSettings",e,t);if(r instanceof Error)yield de("error",r.message);else if((0,O.map)(r,"status").every((e=>200===e)))yield de("success",(0,u.__)("Updated group settings.","better-wp-security"),{type:"snackbar"});else{const e=r.filter((e=>{let{status:t}=e;return 200!==t})).flatMap((e=>{let{error:t}=e;return(0,z.NC)(t).getAllErrorMessages()}));yield{type:Be,errors:e}}return yield Ae(),r}function*Me(e){if(yield h.controls.select("ithemes-security/user-groups-editor","hasEdits",e)){const t=yield*Ie(e);if(t instanceof Error)return t}if(yield h.controls.select("ithemes-security/user-groups-editor","settingHasEdits",e)){const t=yield*Te(e);if(t instanceof Error)return t}return null}function*Fe(){const e=yield h.controls.resolveSelect(a.MODULES_STORE_NAME,"getEditedModules"),t=yield h.controls.select("ithemes-security/user-groups-editor","getMatchableNavIds");for(const r of t)for(const t of e)if("active"===t.status.selected)for(const e in t.user_groups)t.user_groups.hasOwnProperty(e)&&"all"===t.user_groups[e].default&&(yield ke(r,t.id,e,!0))}function*$e(){const e={administrator:(0,u.__)("Administrators","better-wp-security"),editor:(0,u.__)("Editors","better-wp-security"),author:(0,u.__)("Authors","better-wp-security"),contributor:(0,u.__)("Contributors","better-wp-security"),subscriber:(0,u.__)("Subscribers","better-wp-security")},t=yield h.controls.resolveSelect(a.MODULES_STORE_NAME,"getEditedModules"),r=yield h.controls.resolveSelect("ithemes-security/user-groups","getMatchables"),s=yield h.controls.select("ithemes-security/user-groups-editor","getLocalGroupIds"),i=yield h.controls.select(c.ONBOARD_STORE_NAME,"getAnswers"),o={administrator:[],editor:[],author:[],contributor:[],subscriber:[]};for(const e of(0,O.map)((0,O.filter)(r,{type:"user-group"}),"id").concat(s)){const t=yield h.controls.select("ithemes-security/user-groups-editor","getEditedGroupAttribute",e,"canonical");for(const r of t)o[r].push(e)}const n={};for(const e of i)(0,O.isPlainObject)(e.canonical_group_substitutions)&&Object.assign(n,e.canonical_group_substitutions);for(const r in e){if(!e.hasOwnProperty(r))continue;const s=o[r];if(n.hasOwnProperty(r)){if(null===n[r]&&!s.length)continue;s.push(n[r])}if(0===s.length){const t=be();yield we(t),yield Se(t,{label:e[r],canonical:[r]}),s.push(t)}"subscriber"===r&&s.push("everybody-else");for(const e of t)if("active"===e.status.selected)for(const t in e.user_groups){if(!e.user_groups.hasOwnProperty(t))continue;if(!e.user_groups[t].default)continue;let i=e.user_groups[t].default;if(Array.isArray(i)||(i=[i]),(0,O.intersection)(["all",r],i).length>0)for(const r of s)yield ke(r,e.id,t,!0)}for(const e of i)if(e.user_groups_settings[r])for(const t in e.user_groups_settings[r])if(e.user_groups_settings[r].hasOwnProperty(t))for(const i of e.user_groups_settings[r][t])for(const e of s)yield ke(e,t,i,!0)}return yield h.controls.select("ithemes-security/user-groups-editor","getMatchableNavIds")}const xe="SET_GROUP_ERROR",Be="SET_BULK_ERRORS",He="EDIT_GROUP",We="RESET_EDITS",Ve="RESET_ALL_EDITS",Ze="CREATE_LOCAL_GROUP",je="DELETE_LOCAL_GROUP",Ke="DELETE_LOCAL_GROUPS",qe="MARK_GROUP_FOR_DELETION",ze="START_SAVE_GROUP",Je="FINISH_SAVE_GROUP",Xe="FAILED_SAVE_GROUP",Qe="EDIT_GROUP_SETTING",Ye="RESET_GROUP_SETTING",et="START_SAVE_GROUP_SETTINGS",tt="FINISH_SAVE_GROUP_SETTINGS",rt="FAILED_SAVE_GROUP_SETTINGS",st="BULK_EDIT_GROUP_SETTING",it="RESET_BULK_GROUP_SETTING_EDIT",ot="RESET_BULK_GROUP_SETTING_EDITS";var nt=r(28306);function ut(e){return e.localGroupIds}function lt(e,t){return e.localGroupIds.includes(t)}const at=(0,h.createRegistrySelector)((e=>(t,r)=>lt(t,r)?"user-group":e("ithemes-security/user-groups").getMatchableType(r))),ct=(0,h.createRegistrySelector)((e=>(t,r)=>t.saving.includes(r)||e("ithemes-security/user-groups").isUpdating(r)||e("ithemes-security/user-groups").isUpdatingSettings(r)));function dt(e,t){return e.edits[t]}const pt=(0,h.createRegistrySelector)((e=>(t,r,s)=>{const i=(0,O.get)(t,["edits",r,s]);return void 0!==i?i:"new"===r||lt(t,r)?void 0:e("ithemes-security/user-groups").getGroupAttribute(r,s)})),gt=(0,h.createRegistrySelector)((e=>(t,r)=>"user-group"!==e("ithemes-security/user-groups-editor").getMatchableType(r)?e("ithemes-security/user-groups").getMatchableLabel(r):e("ithemes-security/user-groups-editor").getEditedGroupAttribute(r,"label")));function mt(e,t){return e.edits[t]&&!(0,O.isEmpty)(e.edits[t])}const ht=(0,nt.Z)((e=>Object.keys(e.edits).filter((t=>!(0,O.isEmpty)(e.edits[t])))),(e=>e.edits));function Et(e,t){return!!e.settingEdits[t]}function yt(e,t){return e.settingEdits[t]}const _t=q()(((e,t)=>(0,O.merge)({},e,t)),{maxSize:1}),ft=(0,h.createRegistrySelector)((e=>(t,r)=>{const s=lt(t,r)?{}:e("ithemes-security/user-groups").getGroupSettings(r),i=yt(t,r);return _t(s,i)})),bt=(0,h.createRegistrySelector)((e=>(t,r,s,i)=>{const o=(0,O.get)(t,["settingEdits",r,s,i]);return void 0!==o?o:!lt(t,r)&&e("ithemes-security/user-groups").getGroupSetting(r,s,i)})),St=(0,h.createRegistrySelector)((e=>t=>{const r=e("ithemes-security/user-groups").getGroupsBySetting();if((0,O.isEmpty)(t.settingEdits)||(0,O.isEmpty)(r))return r;const s=(0,O.cloneDeep)(r);for(const[e,r]of Object.entries(t.settingEdits))for(const[t,i]of Object.entries(r))for(const[r,o]of Object.entries(i))s[t]?.[r]&&(o?s[t][r].push(e):(0,O.pull)(s[t][r],e));return s})),It=(0,nt.Z)((e=>Object.keys(e.settingEdits).filter((t=>!(0,O.isEmpty)(e.settingEdits[t])))),(e=>e.settingEdits));function vt(e,t){return mt(e,t)||Et(e,t)}function Gt(e){return!(0,O.isEmpty)(e.bulkSettingEdits)}function Ot(e){return e.bulkSettingEdits}function Nt(e,t,r){return(0,O.get)(e,["bulkSettingEdits",t,r])}const Lt=(0,h.createRegistrySelector)((e=>(t,r,s,i)=>{const o=Nt(t,s,i);if(void 0!==o)return o;const n=t=>e("ithemes-security/user-groups").getGroupSetting(t,s,i),u=n(r[0]);return r.every((e=>n(e)===u))?u:null})),Rt=(0,h.createRegistrySelector)((e=>(t,r)=>{const s=Ot(t);return e("ithemes-security/user-groups").isBulkPatchingSettings(r,s)})),wt=(0,h.createRegistrySelector)((e=>()=>e("ithemes-security/user-groups").getGroups("available"))),kt=q()(((e,t,r,s)=>{if(t&&!e.length)return null;const[i,o]=(0,O.partition)(e,(e=>"user-group"===e.type));return i.map((e=>e.id)).concat(r).concat(o.map((e=>e.id))).filter((e=>!s.includes(e)))}),{maxSize:1}),Tt=(0,h.createRegistrySelector)((e=>()=>{const t=e("ithemes-security/user-groups").getMatchables(),r=e("core/data").isResolving("ithemes-security/user-groups","getMatchables"),s=e("ithemes-security/user-groups-editor").getLocalGroupIds(),i=e("ithemes-security/user-groups-editor").getGroupsMarkedForDeletion();return kt(t,r,s,i)}));function Dt(e){return e.markedForDelete}function Ct(e,t){return e.errors[t]}function Ut(e){return e.bulkErrors}function*At(){yield function(e,t){for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i];return{type:"DISPATCH",storeKey:e,actionName:t,args:s}}("ithemes-security/user-groups","query","available",{_embed:1})}const Pt={edits:{},settingEdits:{},bulkSettingEdits:{},localGroupIds:[],saving:[],errors:{},bulkErrors:[],markedForDelete:[]};(0,h.registerStore)("ithemes-security/user-groups-editor",{controls:pe,actions:s,selectors:i,resolvers:o,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case He:return{...e,edits:{...e.edits,[t.id]:t.edit}};case Ze:return{...e,localGroupIds:[...e.localGroupIds,t.id]};case je:return{...e,localGroupIds:e.localGroupIds.filter((e=>e!==t.id))};case Ke:return{...e,localGroupIds:[]};case ze:return{...e,saving:[...e.saving,t.id]};case Xe:return{...e,saving:e.saving.filter((e=>e!==t.id)),errors:{...e.errors,[t.id]:t.error}};case Je:return{...e,edits:(0,O.omit)(e.edits,[t.id]),localGroupIds:e.localGroupIds.filter((e=>e!==t.id)),saving:e.saving.filter((e=>e!==t.id)),errors:(0,O.omit)(e.errors,[t.id])};case Qe:return{...e,settingEdits:{...e.settingEdits,[t.id]:{...(0,O.get)(e,["settingEdits",t.id],{}),[t.module]:{...(0,O.get)(e,["settingEdits",t.id,t.module],{}),[t.setting]:t.value}}}};case Ye:const r={...e,settingEdits:{...e.settingEdits,[t.id]:{...(0,O.get)(e,["settingEdits",t.id],{}),[t.module]:(0,O.omit)((0,O.get)(e,["settingEdits",t.id,t.module],{}),[t.setting])}}};return(0,O.isEmpty)(r.settingEdits[t.id][t.module])&&delete r.settingEdits[t.id][t.module],(0,O.isEmpty)(r.settingEdits[t.id])&&delete r.settingEdits[t.id],r;case tt:return{...e,settingEdits:(0,O.omit)(e.settingEdits,[t.id]),errors:(0,O.omit)(e.errors,[t.id])};case rt:return{...e,errors:{...e.errors,[t.id]:t.error}};case We:return{...e,edits:(0,O.omit)(e.edits,[t.id]),settingEdits:(0,O.omit)(e.settingEdits,[t.id]),markedForDelete:e.markedForDelete.filter((e=>e!==t.id)),localGroupIds:e.localGroupIds.filter((e=>e!==t.id))};case Ve:return{...e,edits:{},settingEdits:{},bulkSettingEdits:{},markedForDelete:[],localGroupIds:[]};case st:return{...e,bulkSettingEdits:{...e.bulkSettingEdits,[t.module]:{...e.bulkSettingEdits[t.module]||{},[t.setting]:t.value}}};case it:return{...e,bulkSettingEdits:(0,O.omit)(e.bulkSettingEdits,`${t.module}.${t.setting}`)};case ot:return{...e,bulkSettingEdits:{}};case qe:return{...e,markedForDelete:[...e.markedForDelete,t.id]};case xe:return{...e,errors:t.error?{...e.errors,[t.id]:t.error}:(0,O.omit)(e.errors,[t.id])};case Be:return{...e,bulkErrors:t.errors};default:return e}},persist:["edits","settingEdits","bulkSettingEdits","localGroupIds","markedForDelete"]});var Mt=r(54761);function Ft(){return B(),H(),(0,n.createElement)(c.Page,{id:"user-groups",title:(0,u.__)("User Groups","better-wp-security"),icon:"groups",priority:10,roots:["onboard","settings","import"]},(()=>(0,n.createElement)(d,null)))}(0,Mt.addAction)("ithemes-security.onboard.applyAnswerResponse","ithemes-security/user-groups/onboard.applyAnswerResponse",(function(e,t){for(const r of t.user_groups)e.dispatch("ithemes-security/user-groups-editor").createLocalGroup(r.id)&&e.dispatch("ithemes-security/user-groups-editor").editGroup(r.id,(0,O.pick)(r,["label","users","roles","canonical"]));for(const r in t.user_groups_settings){if(!t.user_groups_settings.hasOwnProperty(r)||!ye(r))continue;const s=t.user_groups_settings[r];if(s)for(const t in s)if(s.hasOwnProperty(t))for(const i of s[t])e.dispatch("ithemes-security/user-groups-editor").editGroupSetting(r,t,i,!0)}})),(0,Mt.addAction)("ithemes-security.onboard.reset","ithemes-security/user-groups/onboard.reset",(function(e){e.dispatch("ithemes-security/user-groups-editor").deleteLocalGroups(),e.dispatch("ithemes-security/user-groups-editor").resetAllEdits()})),(0,Mt.addFilter)("ithemes-security.settings.isConditionalSettingActive","ithemes-security/user-groups/user-group-conditional",(function(e,t,r,s){if(!e||!r["user-groups"])return e;const{registry:i}=s,o=i.select("ithemes-security/user-groups-editor").getEditedGroupsBySetting();for(const e of r["user-groups"])if(!(o[t.id]?.[e]||[]).length)return!1;return!0})),r.p=window.itsecWebpackPublicPath,(0,u.setLocaleData)({"":{}},"ithemes-security-pro"),(0,l.registerPlugin)("itsec-user-groups",{render:()=>(0,n.createElement)(Ft,null)})},50460:(e,t,r)=>{"use strict";r.d(t,{G:()=>F,o:()=>w});var s={};r.r(s),r.d(s,{REGISTER_PROVIDER:()=>A,registerProvider:()=>U});var i={};r.r(i),r.d(i,{getProviders:()=>P});var o=r(87462),n=r(6293),u=r(73727),l=r(16550),a=r(90071),c=r(92819),d=r(64893),p=r(95122),g=r(48015),m=r(9576),h=r(81019),E=r(82839),y=r(78363),_=r(91991),f=r(19144),b=r(86033),S=r(13092);function I(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}var v=new WeakMap,G=new WeakMap,O=new WeakMap,N=new WeakMap,L=new WeakMap;class R{constructor(e,t){I(this,v,{writable:!0,value:void 0}),I(this,G,{writable:!0,value:void 0}),I(this,O,{writable:!0,value:void 0}),I(this,N,{writable:!0,value:void 0}),I(this,L,{writable:!0,value:void 0}),(0,S.Z)(this,v,e),(0,S.Z)(this,G,t),(0,S.Z)(this,O,t.select(F).getProviders()),this._prepare()}_prepare(){(0,S.Z)(this,L,(0,b.Z)(this,v).split(/\s+/g).map((e=>e.trim().toLowerCase())).filter((e=>!!e)));const e=(0,b.Z)(this,v).endsWith(" ");(0,S.Z)(this,N,new RegExp((0,b.Z)(this,L).map(((t,r)=>r+1!==(0,b.Z)(this,L).length||e?`(?=.*\\b${(0,c.escapeRegExp)(t)}\\b)`:`(?=.*\\b${(0,c.escapeRegExp)(t)})`)).join("")+".+","gi"))}_stringMatch(e){return e&&(0,b.Z)(this,N).test(e)}_keywordMatch(e){return!(!e||!e.length)&&e.some((e=>(0,b.Z)(this,L).some(((t,r)=>e.includes(" ")?this._stringMatch(e):r===(0,b.Z)(this,L).length-1?e.startsWith(t):t===e))))}getResults(){if((0,b.Z)(this,v).length<3)return[{},0];let e=0;const t=[],r={stringMatch:e=>this._stringMatch(e),keywordMatch:e=>this._keywordMatch(e)};for(const s of(0,b.Z)(this,O)){const i={title:s.title,items:[],groups:{}};e+=s.callback({evaluate:r,results:i,registry:(0,b.Z)(this,G)}),!i.items.length&&(0,c.isEmpty)(i.groups)||t.push(i)}return[t,e]}}const w=(0,n.forwardRef)((function(e,t){let{onPick:r=c.noop,showResults:s}=e;const[i,u]=(0,n.useState)(""),[l,a]=(0,n.useState)(!1),d=(0,n.useRef)(),f=(0,n.useRef)(),[b,S]=(0,n.useState)([]),I=(0,g.useRegistry)(),v=(0,n.useCallback)((e=>{const t=new R(e,I).getResults();S(t[0]),(0,E.speak)((0,p.sprintf)((0,p._n)("%d result found.","%d results found.",t[1],"better-wp-security"),t[1]))}),[I]),G=(0,m.useDebounce)(v,50),O=(0,n.useCallback)((e=>{d.current&&(e.preventDefault(),d.current.focus())}),[d]);return(0,m.useKeyboardShortcut)("/",O),(0,n.createElement)("div",(0,o.Z)({className:"itsec-search"},(0,_.Zk)((()=>a(!1)))),(0,n.createElement)("div",null,(0,n.createElement)(y.lD,{value:i,onChange:e=>{u(e),G(e)},onFocus:()=>a(!0),onKeyDown:e=>{e.keyCode===h.DOWN&&(e.preventDefault(),f.current.focus())},ref:(0,_.qq)([t,d]),placeholder:(0,p.__)("Search for feature, settings, and more","better-wp-security"),omitSeparators:!0}),(l||s)&&i.length>=3&&(0,n.createElement)(k,{results:b,exitSearch:e=>{r(e),a(!1)},ref:f,onPick:r})))})),k=(0,n.forwardRef)((function(e,t){let{results:r,exitSearch:s,onPick:i}=e;const u=(0,n.useRef)();(0,n.useImperativeHandle)(t,(()=>({focus(){u.current.focus()}})));const g=(0,m.useInstanceId)(k,"itsec-search"),E=g+"__result__",y=function(){const e=(0,l.k6)();return function(t){return e[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"push"]((0,a.ob)(t))}}(),[_,b]=(0,n.useState)("");return(0,c.isEmpty)(r)?null:(0,n.createElement)(React.Fragment,null,(0,n.createElement)(d.VisuallyHidden,{id:g+"__label"},(0,p.__)("Search Results","better-wp-security")),(0,n.createElement)(f.T2,{className:"itsec-search__results",id:g,active:_&&E+_,onNavigate:e=>b(e.substr(E.length)),onKeyDown:e=>{let{keyCode:t}=e;!_||t!==h.ENTER&&t!==h.SPACE||(i(_),y(_),s())},onFocus:()=>{if(!_&&!(0,c.isEmpty)(r)){const[,e]=Object.entries(r)[0];if(e.items?.length)b(e.items[0].route);else if(!(0,c.isEmpty)(e.groups)){const[,t]=Object.entries(e.groups)[0];b(t.items[0].route)}}},role:"listbox",descendantRoles:"option",ref:u,"aria-labelledby":g+"__label"},(0,c.map)(r,((e,t)=>(0,n.createElement)(T,(0,o.Z)({key:t},e,{active:_,idPrefix:E,exitSearch:s}))))))}));function T(e){let{title:t,items:r,groups:s,...i}=e;const u=(0,m.useInstanceId)(k,"itsec-search__kind");return(0,n.createElement)("ul",{className:"itsec-search__kind",role:"group","aria-labelledby":u},(0,n.createElement)("li",{role:"presentation",id:u},t),(r||[]).map((e=>(0,n.createElement)(C,(0,o.Z)({key:e.route},e,i)))),(0,c.map)(s,((e,t)=>(0,n.createElement)(D,(0,o.Z)({key:t},e,i)))))}function D(e){let{title:t,items:r,...s}=e;const i=(0,m.useInstanceId)(k,"itsec-search__group");return(0,n.createElement)("ul",{className:"itsec-search__group",role:"group","aria-labelledby":i},(0,n.createElement)("li",{role:"presentation",id:i},(0,n.createElement)("span",null,t)),(r||[]).map((e=>(0,n.createElement)(C,(0,o.Z)({key:e.route},e,s)))))}function C(e){let{title:t,description:r,route:s,active:i,idPrefix:o,exitSearch:l}=e;return(0,n.createElement)("li",{className:"itsec-search__result",role:"option","aria-selected":i===s||void 0,id:o+s,"aria-label":t},(0,n.createElement)(u.rU,{to:s,tabIndex:-1,onClick:()=>l(s)},(0,n.createElement)("span",null,t),(0,n.createElement)(f.Lu,{content:r,noHtml:!0,tagName:"p"})))}function U(e,t,r,s){return{type:A,slug:e,title:t,priority:r,callback:s}}const A="REGISTER_PROVIDER",P=(0,r(28306).Z)((e=>(0,c.sortBy)(e.providers,"priority")),(e=>e.providers)),M={providers:{}},F="ithemes-security/search";(0,g.registerStore)(F,{actions:s,selectors:i,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M,t=arguments.length>1?arguments[1]:void 0;return t.type===A?{...e,providers:{...e.providers,[t.slug]:(0,c.omit)(t,["type"])}}:e}})},31600:e=>{e.exports=function(){return this.itsec.packages.data}()},7980:e=>{e.exports=function(){return this.itsec.pages.settings}()},87375:e=>{e.exports=function(){return this.itsec["user-groups"].api}()},82839:e=>{e.exports=function(){return this.wp.a11y}()},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},9576:e=>{e.exports=function(){return this.wp.compose}()},48015:e=>{e.exports=function(){return this.wp.data}()},6293:e=>{e.exports=function(){return this.wp.element}()},54761:e=>{e.exports=function(){return this.wp.hooks}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},81019:e=>{e.exports=function(){return this.wp.keycodes}()},25703:e=>{e.exports=function(){return this.wp.notices}()},3571:e=>{e.exports=function(){return this.wp.plugins}()},14776:e=>{e.exports=function(){return this.wp.primitives}()},73470:e=>{e.exports=function(){return this.wp.url}()},99196:e=>{"use strict";e.exports=window.React},91850:e=>{"use strict";e.exports=window.ReactDOM},92819:e=>{"use strict";e.exports=window.lodash}},e=>{e.O(0,[271,655,363,96,434,991,144,783],(()=>(45565,e(e.s=45565))));var t=e.O();((window.itsec=window.itsec||{})["user-groups"]=window.itsec["user-groups"]||{}).settings=t}]);