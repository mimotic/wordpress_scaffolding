(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[293,155],{17897:(e,t,a)=>{"use strict";a.r(t),a.d(t,{BREAKPOINTS:()=>M.j$,BREAKPOINT_ORDER:()=>M.hN,Card:()=>Ae,CardFooter:()=>G,CardFooterSchemaActions:()=>K,CardHeader:()=>R,CardHeaderDate:()=>B,CardHeaderStatus:()=>T,CardHeaderTitle:()=>P,ConfigContext:()=>M.E_,GRID_COLUMNS:()=>M.sv,MasterDetail:()=>ee,MasterDetailBack:()=>X,PromoCard:()=>Ye,areGridLayoutsEqual:()=>M.IF,debugChange:()=>M._U,findSlot:()=>M.pD,getAvatarUrl:()=>M.E$,getCardTitle:()=>M.GP,sortCardsToMatchApiLayout:()=>M.lh,sortCardsToMatchLayout:()=>M.Mf,transformApiLayoutToGrid:()=>M.BP,transformApiLayoutToGridForCard:()=>M.Bi,transformGridLayoutToApi:()=>M.Ai,useCanWrite:()=>M.bK,useConfigContext:()=>M.qt,useRegisterCards:()=>Ce});var r={};a.r(r),a.d(r,{settings:()=>de,slug:()=>oe});var s={};a.r(s),a.d(s,{settings:()=>ke,slug:()=>Ne});var n=a(6293),i=a(95122),c=a(25993),l=a.n(c),o=a(19296),d=a(64893),u=a(9576),m=a(48015),h=a(3571),p=(a(25703),a(78363)),b=a(10906),f=(a(31600),a(91991)),y=a(92819),g=a(89390),E=a(98687),_=a(3023),v=a(75358),N=a(69311),k=a(99307),C=a(11542),I=a(5735),w=a(82521),L=a(51783),x=a(59588),S=a.n(x);const O=window.moment;var D=a.n(O);const A=S()((()=>[{value:"24-hours",label:(0,i.__)("24 Hours","better-wp-security")},{value:"week",label:(0,i.__)("7 Days","better-wp-security")},{value:"30-days",label:(0,i.__)("30 Days","better-wp-security")},{value:"custom",label:(0,i.__)("Custom","better-wp-security")}])),B=(0,u.compose)([(0,m.withSelect)(((e,t)=>{let{card:a}=t;return{queryArgs:e("ithemes-security/dashboard").getDashboardCardQueryArgs(a.id)||{}}})),(0,m.withDispatch)(((e,t)=>{let{card:a}=t;return{update:t=>e("ithemes-security/dashboard").queryDashboardCard(a.id,t)}}))])((function(e){let{queryArgs:t,config:a,update:r}=e;const[s,c]=(0,n.useState)(!1),[l,o]=(0,n.useState)(void 0),[u,m]=(0,n.useState)(void 0);let[h,p]=(0,n.useState)(void 0);const b=function(e,t){return e.period?e.period:t.query_args.period?t.query_args.period.default:void 0}(t,a),f=function(e){if(!e)return"";const t=new window.Date;let a,r;switch(e){case"24-hours":return(0,i.__)("24 Hours","better-wp-security");case"30-days":a=(0,w.dateI18n)("M j",t.setDate(t.getDate()-30)),r=(0,w.dateI18n)("M j");break;case"week":a=(0,w.dateI18n)("M j",t.setDate(t.getDate()-7)),r=(0,w.dateI18n)("M j");break;default:a=(0,w.dateI18n)("M j",e.start),r=(0,w.dateI18n)("M j",e.end)}return(0,i.sprintf)((0,i.__)("%1$s - %2$s","better-wp-security"),a,r)}(b);return h=h||((0,y.isString)(b)?b:"custom"),(0,n.createElement)("div",{className:"itsec-card-header-date"},(0,n.createElement)(d.Button,{onClick:()=>c(!s),title:f,"aria-expanded":s,"aria-label":(0,i.sprintf)((0,i.__)("%s (click to edit)","better-wp-security"),f)},(0,n.createElement)("span",{className:"itsec-card-header-date__period"},f),(0,n.createElement)(d.Dashicon,{icon:"calendar",className:"itsec-card-header-date__icon"})),s&&(0,n.createElement)(d.Modal,{title:(0,i.__)("Change Date Period","better-wp-security"),onRequestClose:()=>c(!1)},(0,n.createElement)(d.SelectControl,{options:A(),value:h,onChange:e=>p(e)}),(0,n.createElement)("div",{className:"itsec-card-header-date__actions"},"custom"===h&&(0,n.createElement)(React.Fragment,null,(0,n.createElement)(d.Dropdown,{renderToggle:e=>{let{isOpen:t,onToggle:a}=e;return(0,n.createElement)(d.Button,{variant:"secondary",onClick:a,"aria-expanded":t,"aria-label":(0,i.sprintf)((0,i.__)("From: %s (click to edit)","better-wp-security"),(0,w.dateI18n)("M j",l)),text:(0,i.sprintf)((0,i.__)("From: %s","better-wp-security"),(0,w.dateI18n)("M j",l))})},renderContent:()=>(0,n.createElement)(d.DatePicker,{currentDate:l,onChange:o,isInvalidDate:e=>{if((0,w.isInTheFuture)(e))return!0;const t=new window.Date;return t.setDate(t.getDate()-60),e<t}})}),(0,n.createElement)(d.Dropdown,{renderToggle:e=>{let{isOpen:t,onToggle:a}=e;return(0,n.createElement)(d.Button,{variant:"secondary",onClick:a,"aria-expanded":t,"aria-label":(0,i.sprintf)((0,i.__)("To: %s (click to edit)","better-wp-security"),(0,w.dateI18n)("M j",u)),text:(0,i.sprintf)((0,i.__)("To: %s","better-wp-security"),(0,w.dateI18n)("M j",u))})},renderContent:()=>(0,n.createElement)(d.DatePicker,{currentDate:u,onChange:m,isInvalidDate:e=>!!(0,w.isInTheFuture)(e)||(0,w.getDate)(l)>e})})),(0,n.createElement)(d.Button,{variant:"primary",className:"itsec-card-header-date__action--apply",onClick:e=>{let a;if(e.preventDefault(),"custom"===h){const e=D()(l).set({hour:0,minute:0,second:0}),t=D()(u).set({hour:23,minute:59,second:59});a={start:(0,w.format)("Y-m-d\\TH:i:s",e),end:(0,w.format)("Y-m-d\\TH:i:s",t)}}else a=h;r({...t,period:a}),c(!1)}},(0,i.__)("Apply","better-wp-security")))))}));function T(e){let{status:t="protected"}=e;return"protected"===t&&(t=(0,i.__)("Protected","better-wp-security")),(0,n.createElement)("span",{className:"itsec-card-header-status"},(0,n.createElement)("span",{className:"itsec-card-header-status__label"},(0,i.__)("Status","better-wp-security")),(0,n.createElement)("span",{className:"itsec-card-header-status__status"},t))}var M=a(65760);function P(e){let{card:t,config:a}=e;return(0,n.createElement)("h2",{className:"itsec-card-header-title"},(0,M.GP)(t,a))}function R(e){let{children:t}=e;return(0,n.createElement)("header",{className:"itsec-card-header itsec-card__util-padding"},t)}const F=(0,u.compose)([(0,m.withSelect)(((e,t)=>{let{card:a}=t;return{period:(e("ithemes-security/dashboard").getDashboardCardQueryArgs(a.id)||{}).period}}))])((function(e){let{card:t,config:a,period:r}=e;r=r||a.query_args.period&&a.query_args.period.default;const s=[],i=[];if(!(0,y.isEmpty)(t.data))for(const e in t.data)if(t.data.hasOwnProperty(e)){for(let a=0;a<t.data[e].data.length;a++){const n=t.data[e].data[a];if(s[a])s[a][e]=n.y;else{const t="24-hours"===r?"g A":"M j";s.push({name:n.t?(0,w.dateI18n)(t,n.t):n.x,[e]:n.y})}}i.push({name:t.data[e].label,dataKey:e})}return(0,n.createElement)("div",{className:"itsec-card--type-line-graph"},(0,n.createElement)(R,null,(0,n.createElement)(P,{card:t,config:a}),(0,n.createElement)(B,{card:t,config:a})),(0,n.createElement)(g.h,{width:"100%",height:"100%"},(0,n.createElement)(E.w,{margin:{top:10,left:-15,right:50,bottom:10},data:s},(0,n.createElement)(_.K,{dataKey:"name"}),(0,n.createElement)(v.B,{allowDecimals:!1}),(0,n.createElement)(N.O,{strokeDasharray:"3 3"}),(0,n.createElement)(k.u,null),(0,n.createElement)(C.D,null),i.map(((e,t)=>(0,n.createElement)(I.x,{type:"monotone",dataKey:e.dataKey,name:e.name,key:e.dataKey,stroke:L.l6[t],isAnimationActive:!1}))))))}));var j=a(45108),H=a(82931),$=a(46208),W=a(43815),Z=a(94184),q=a.n(Z),V=a(31511);function z(e){let{card:t,config:a}=e;const r=[];let s=0;if(t.data&&t.data.data)for(const e in t.data.data)t.data.data.hasOwnProperty(e)&&(s+=t.data.data[e].sum,r.push({name:t.data.data[e].label,value:t.data.data[e].sum}));const c=s>0,l=c?1:.4;return c||r.forEach((e=>e.value=1)),(0,n.createElement)("div",{className:q()("itsec-card--type-pie-chart",{"itsec-card--type-pie-chart--no-data":!c})},(0,n.createElement)(R,null,(0,n.createElement)(P,{card:t,config:a}),a.query_args.period&&(0,n.createElement)(B,{card:t,config:a})),(0,n.createElement)(g.h,{width:"100%",height:200},(0,n.createElement)(H.u,null,(0,n.createElement)($.b,{data:r,dataKey:"value",innerRadius:60,outerRadius:80,fill:"#8884d8",fillOpacity:l,paddingAngle:5,activeShape:e=>{const{cx:a,cy:r,innerRadius:s,outerRadius:o,startAngle:d,endAngle:u,fill:m}=e;return(0,n.createElement)("g",null,(0,n.createElement)("text",{x:a,y:r+10,dy:8,textAnchor:"middle",fill:m,fillOpacity:l,className:"itsec-card-pie-chart__circle-sum"},c?(0,V.z8)(t.data.circle_sum):"—"),(0,n.createElement)("text",{x:a,y:r+30,dy:8,textAnchor:"middle",fill:m,fillOpacity:l,className:"itsec-card-pie-chart__circle-label"},c?t.data.circle_label:(0,i.__)("No Data","better-wp-security")),(0,n.createElement)(j.L,{cx:a,cy:r,innerRadius:s,outerRadius:o,startAngle:d,endAngle:u,fill:m,fillOpacity:l}))},activeIndex:0,isAnimationActive:!1},r.map(((e,t)=>(0,n.createElement)(W.b,{key:t,fill:L.l6[t%L.l6.length]})))))),(0,n.createElement)("table",{className:"itsec-card-pie-chart__values"},(0,n.createElement)("tbody",null,r.map(((e,t)=>(0,n.createElement)("tr",{key:e.name},(0,n.createElement)("th",{scope:"row"},e.name),(0,n.createElement)("td",{style:{color:L.l6[t]}},c?(e.value/s*100).toFixed(0)+"%":"—")))))))}var U=a(87514),Q=a.n(U);const K=(0,u.compose)([(0,m.withSelect)(((e,t)=>({callingRpcs:e("ithemes-security/dashboard").getCallingDashboardCardRpcs(t.card.id)})))])((function(e){let{card:t,callingRpcs:a,onComplete:r,children:s}=e;const i=(0,y.get)(t,["_links","ithemes-security:rpc"],[]),c=(0,y.flatten)(Object.values((0,y.get)(t,"_links",{}))).filter((e=>"text/html"===e.media));return i.length||c.length||s?(0,n.createElement)(G,null,i.map(((e,s)=>(0,n.createElement)("span",{className:"itsec-card-footer__action",key:e.href},(0,n.createElement)(d.Button,{isSmall:!0,variant:0===s?"primary":"secondary",onClick:()=>!a.includes(e.href)&&(async e=>{const a=await(0,m.dispatch)("ithemes-security/dashboard").callDashboardCardRpc(t.id,e);r&&r(e,a)})(e.href),isBusy:a.includes(e.href),"aria-disabled":a.includes(e.href)},e.title)))),c.map((e=>(0,n.createElement)("span",{className:"itsec-card-footer__action",key:e.href},(0,n.createElement)(d.Button,{isSmall:!0,variant:"link",href:e.href},e.title)))),s):null})),G=function(e){let{children:t}=e;return(0,n.createElement)("footer",{className:"itsec-card-footer__actions"},t)};var Y=a(81019);const J=(0,u.compose)([u.pure])((function(e){let{master:t,getId:a,parentInstanceId:r,isSelected:s,DetailRender:i}=e;return(0,n.createElement)("section",{key:a(t),role:"tabpanel",className:"itsec-component-master-detail__detail-container",id:`itsec-component-master-detail-${r}__detail--${a(t)}`,style:s?{}:{display:"none"}},(0,n.createElement)(i,{master:t,isVisible:s}))}));function X(e){let{isSmall:t,select:a,selectedId:r}=e;return(0,n.createElement)(d.Button,{icon:"arrow-left-alt",className:"itsec-component-master-detail__back",onClick:()=>a(0),style:r&&t?{}:{display:"none"},label:(0,i.__)("Back to List","better-wp-security"),showTooltip:!1})}const ee=(0,u.compose)([u.withInstanceId,u.pure])((function(e){let{masters:t,masterRender:a,detailRender:r,ListHeader:s,ListFooter:c,context:l,selectedId:o,select:u,instanceId:m,mode:h="table",idProp:p="id",isSmall:b=!1,direction:f="horizontal",borderless:g=!1,children:E,hasNext:_,loadNext:v,isQuerying:N}=e;const k=(0,y.isString)(p)?e=>e[p]:p,C=function(e,t,a){if(e.length&&!1!==a)return a&&(0,y.find)(e,(e=>t(e)===a))||e[0]}(t,k,o),I={};let w;const L=(0,y.curry)(((e,a)=>{const{keyCode:r}=a;let s;switch(r){case Y.UP:s=0===e?t.length-1:e-1;break;case Y.DOWN:s=e===t.length-1?0:e+1;break;case Y.ENTER:case Y.SPACE:return a.preventDefault(),a.stopPropagation(),void u(k(t[e]));default:return}const n=I[k(t[s])];n&&(a.stopPropagation(),a.preventDefault(),n.focus(),0===s&&(a.nativeEvent.stopImmediatePropagation(),w.scrollTop=0))}));let x,S;"list"===h?(x="ul",S="li"):(x="table",S="tr");const O=t.map(((e,t)=>{const r=o===k(e);return(0,n.createElement)(S,{key:k(e),id:`itsec-component-master-detail-${m}__master--${k(e)}`,tabIndex:r||!o&&0===t?0:-1,role:"tab","aria-selected":r,"aria-controls":`itsec-component-master-detail-${m}__detail--${k(e)}`,onFocus:()=>!b&&u(k(e)),onClick:()=>u(k(e)),onKeyDown:L(t),ref:t=>I[k(e)]=t,className:q()("itsec-component-master-detail__master",{"itsec-component-master-detail__master--selected":r,"itsec-component-master-detail__master--selected-default":0===o&&0===t})},(0,n.createElement)(a,{master:e}))}));let D=!1;if(_){const e=(0,n.createElement)(d.Button,{variant:"link",onClick:v,disabled:N,isBusy:N},(0,i.__)("Load More","better-wp-security"));D="list"===h?(0,n.createElement)("li",null,e):(0,n.createElement)("tfoot",null,(0,n.createElement)("tr",null,(0,n.createElement)("td",{colSpan:100},e)))}return(0,n.createElement)("section",{className:q()("itsec-component-master-detail",`itsec-component-master-detail--direction-${f}`,{"itsec-component-master-detail--is-small":b,"itsec-component-master-detail--has-detail":o,"itsec-component-master-detail--borderless":g})},(0,n.createElement)("section",{className:"itsec-component-master-detail__master-list-container",ref:e=>w=e},s&&(0,n.createElement)(s,{context:l}),(0,n.createElement)(x,{className:"itsec-component-master-detail__master-list",role:"tablist"},E,"table"===h?(0,n.createElement)("tbody",null,O):O,D),c&&(0,n.createElement)(c,{context:l})),t.map((e=>(0,n.createElement)(J,{key:k(e),master:e,getId:k,parentInstanceId:m,isSelected:e===C,DetailRender:r}))))})),te=(0,u.compose)([(0,m.withSelect)(((e,t)=>({removing:e("ithemes-security/dashboard").isRemovingCard(t.card.id),canRemove:e("ithemes-security/dashboard").canEditCard(t.dashboardId,t.card.id)}))),(0,m.withDispatch)(((e,t)=>({remove:()=>e("ithemes-security/dashboard").removeDashboardCard(t.dashboardId,t.card)})))])((function(e){let{card:t,removing:a,canRemove:r,remove:s}=e;return(0,n.createElement)("div",{className:"itsec-empty-state-card itsec-empty-state-card--unknown"},(0,n.createElement)("h3",null,(0,i.__)("Unknown Card","better-wp-security")),(0,n.createElement)(L.Of,null),(0,n.createElement)("p",null,(0,i.__)("Something went wrong with this card. This is most likely due to disabling an iThemes Security Module.","better-wp-security")),r&&(0,n.createElement)(d.Button,{variant:"secondary",isBusy:a,onClick:s},(0,i.__)("Remove Card","better-wp-security")),(0,n.createElement)("span",null,(0,i.__)("Card Type: ","better-wp-security"),(0,n.createElement)("br",null),(0,n.createElement)("code",null,t.original)))})),ae=function(e){let{card:t,config:a}=e;return(0,n.createElement)("div",{className:"itsec-empty-state-card itsec-empty-state-card--error"},a&&(0,n.createElement)(R,null,(0,n.createElement)(P,{card:t,config:a})),(0,n.createElement)("h3",null,(0,i.__)("Unexpected Error","better-wp-security")),(0,n.createElement)(L.gI,null),(0,n.createElement)("p",null,(0,i.__)("An error occurred while rendering this card.","better-wp-security")),(0,n.createElement)("p",null,(0,i.__)("Try refreshing your browser. If the error persists, please contact support.","better-wp-security")))};function re(e){let{title:t,text:a}=e;return(0,n.createElement)("div",{className:"itsec-empty-state-card itsec-empty-state-card--happy"},t&&(0,n.createElement)("h3",null,t),(0,n.createElement)(L.YJ,null),a&&(0,n.createElement)("p",null,a))}function se(e){let{history:t}=e;return(0,n.createElement)(React.Fragment,null,(0,n.createElement)("hr",null),(0,n.createElement)("div",{className:"itsec-card-active-lockouts__history"},(0,n.createElement)("h4",{className:"itsec-card-active-lockouts__history-title"},(0,i.__)("History","better-wp-security")),(0,n.createElement)("ul",null,t.map((e=>(0,n.createElement)(ne,{key:e.id,history:e}))))))}function ne(e){let{history:t}=e;if(!t.label)return;const a=(0,n.createElement)("time",{dateTime:t.time,title:(0,w.dateI18n)("M d, Y g:s A",t.time)},(0,i.sprintf)((0,i.__)("%s ago","better-wp-security"),t.time_relative));return(0,n.createElement)("li",{key:t.id},(0,n.createElement)("code",null,t.label)," – ",a)}const ie=function(e){let{master:t={},isVisible:a}=e;const r=(0,n.useCallback)((()=>{if(!t.links.item)return Promise.reject(new Error("No data available."));const e=t.links.item[0].href.replace("{lockout_id}",t.id);return Q()({url:e}).then((e=>e.detail))}),[t.id,t.links.item]),{value:s}=(0,f.r5)(r,a);return(0,n.createElement)("div",{className:"itsec-card-active-lockouts__detail-container"},(0,n.createElement)("time",{className:"itsec-card-active-lockouts__start-time",dateTime:t.start_gmt},(0,i.sprintf)((0,i.__)("%s ago","better-wp-security"),t.start_gmt_relative)),(0,n.createElement)("h3",{className:"itsec-card-active-lockouts__label"},t.label),(0,n.createElement)("p",{className:"itsec-card-active-lockouts__description"},t.description),s&&s.history.length>0&&(0,n.createElement)(se,{history:s.history}))};function ce(e){let{master:t}=e;return(0,n.createElement)(n.Fragment,null,(0,n.createElement)("time",{className:"itsec-card-active-lockouts__start-time",dateTime:t.start_gmt,title:(0,w.dateI18n)("M d, Y g:s A",t.start_gmt)},(0,i.sprintf)((0,i.__)("%s ago","better-wp-security"),t.start_gmt_relative)),(0,n.createElement)("h3",{className:"itsec-card-active-lockouts__label"},t.label),(0,n.createElement)("p",{className:"itsec-card-active-lockouts__description"},t.description))}const le=S()((function(e,t){return e.map((e=>({...e,links:t})))})),oe="active-lockouts",de={render:(0,u.compose)([(0,f.gU)("query",500,{leading:!0}),u.pure])((function(e){let{card:t,config:a}=e;const[r,s,c]=function(e){const[t,a]=(0,n.useState)([]),{createNotice:r,removeNotice:s}=(0,m.useDispatch)("core/notices"),c=e._links["ithemes-security:ban-lockout"]?.[0].href,l=!!c;return[t,(0,n.useCallback)((async e=>{const t=c.replace("{lockout_id}",e),n=`ban-lockout-${t}`;a((t=>[...t,e])),s(n,"ithemes-security");try{return await Q()({url:t,method:"POST"}),setTimeout((()=>s(n,"ithemes-security")),5e3),r("success",(0,i.__)("Ban Created","better-wp-security"),{id:n,context:"ithemes-security"}),!0}catch(e){return r("error",(0,i.sprintf)((0,i.__)("Error when banning lockout: %s","better-wp-security"),e.message||(0,i.__)("An unexpected error occurred.","better-wp-security")),{id:n,context:"ithemes-security"}),!1}finally{a((t=>t.filter((t=>t!==e))))}}),[c,r,s]),l]}(t),[l,o,u]=function(e){const[t,a]=(0,n.useState)([]),{createNotice:r,removeNotice:s}=(0,m.useDispatch)("core/notices"),c=e._links["ithemes-security:release-lockout"]?.[0].href,l=!!c;return[t,(0,n.useCallback)((async e=>{const t=c.replace("{lockout_id}",e),n=`release-lockout-${t}`;a((t=>[...t,e])),s(n,"ithemes-security");try{return await Q()({url:t,method:"DELETE"}),setTimeout((()=>s(n,"ithemes-security")),5e3),r("success",(0,i.__)("Lockout Released","better-wp-security"),{id:n,context:"ithemes-security"}),!0}catch(e){return r("error",(0,i.sprintf)((0,i.__)("Error when releasing lockout: %s","better-wp-security"),e.message||(0,i.__)("An unexpected error occurred.","better-wp-security")),{id:n,context:"ithemes-security"}),!1}finally{a((t=>t.filter((t=>t!==e))))}}),[c,r,s]),l]}(t),[h,b]=(0,n.useState)(0),[f,g]=(0,n.useState)(""),{isQuerying:E}=(0,m.useSelect)((e=>({isQuerying:e("ithemes-security/dashboard").isQueryingDashboardCard(t.id)})),[t.id]),{queryDashboardCard:_,refreshDashboardCard:v}=(0,m.useDispatch)("ithemes-security/dashboard"),N=e=>b(e),k=(0,y.find)(t.data.lockouts,["id",h]),C=k?.bannable&&c;return(0,n.createElement)("div",{className:"itsec-card--type-active-lockouts"},(0,n.createElement)(R,null,(0,n.createElement)(X,{isSmall:!0,select:N,selectedId:k?.id||0}),(0,n.createElement)(P,{card:t,config:a})),!k?.id&&(0,n.createElement)("div",{className:"itsec-card-active-lockouts__search-container"},(0,n.createElement)(p.lD,{value:f,onChange:e=>{g(e),_(t.id,e?{search:e}:{})},placeholder:(0,i.__)("Search Lockouts","better-wp-security"),isSearching:E,surfaceVariant:"secondary"})),(0,y.isEmpty)(t.data.lockouts)?(0,n.createElement)(re,{title:(0,i.__)("All Clear!","better-wp-security"),text:(0,i.__)("No users are currently locked out of your site.","better-wp-security")}):(0,n.createElement)(ee,{masters:le(t.data.lockouts,t._links),detailRender:ie,masterRender:ce,mode:"list",selectedId:k?.id||0,select:N,isSmall:!0}),k?.id>0&&(u||C)&&(0,n.createElement)(G,null,u&&(0,n.createElement)("span",{className:"itsec-card-footer__action"},(0,n.createElement)(d.Button,{variant:"primary",isSmall:!0,"aria-disabled":l.includes(h),isBusy:l.includes(h),onClick:async e=>{e.preventDefault();const a=await o(h);await v(t.id),a&&b((e=>e===h?0:e))}},(0,i.__)("Release Lockout","better-wp-security"))),C&&(0,n.createElement)("span",{className:"itsec-card-footer__action"},(0,n.createElement)(d.Button,{variant:"primary",isSmall:!0,"aria-disabled":r.includes(h),isBusy:r.includes(h),onClick:async e=>{e.preventDefault();const a=await s(h);await v(t.id),a&&b((e=>e===h?0:e))}},(0,i.__)("Ban","better-wp-security")))))})),elementQueries:[{type:"width",dir:"max",px:500}]};var ue=a(83996),me=a(19144);function he(e){let{query:t,isQuerying:a}=e;const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{types:t,byType:a}=(0,m.useSelect)((e=>{const t=e("ithemes-security/core").getActorTypes()||[],a={};for(const r of t)a[r.slug]=e("ithemes-security/core").getActors(r.slug);return{types:t,byType:a}}),[]),r=[];r.push({label:e,value:""});for(const e of t){r.push({label:(0,i.sprintf)((0,i.__)("Any %s","better-wp-security"),e.label),value:e.slug,optgroup:e.label});for(const t of a[e.slug]||[])r.push({label:t.label,value:e.slug+":"+t.id,optgroup:e.label})}return r}((0,i.__)("All","better-wp-security")),[s,c]=(0,n.useState)({search:"",actor_id:"",actor_type:""}),l=e=>{const a={...s,...e};c(a),t("main",{...(0,y.omitBy)(a,(e=>""===e)),per_page:100})};return(0,n.createElement)("section",{className:"itsec-card-banned-users__search"},(0,n.createElement)(me.Yw,{options:r,hideLabelFromVision:!0,label:(0,i.__)("Ban Reason","better-wp-security"),value:s.actor_type&&s.actor_id?s.actor_type+":"+s.actor_id:s.actor_type,onChange:e=>{if(""===e)l({actor_type:"",actor_id:""});else{const[t,a=""]=e.split(":");l({actor_type:t,actor_id:a})}}}),(0,n.createElement)(p.lD,{value:s.search,onChange:e=>l({search:e}),isSearching:a,surfaceVariant:"secondary",placeholder:(0,i.__)("Search Bans","better-wp-security")}))}function pe(e){let{master:t}=e;return(0,n.createElement)(n.Fragment,null,(0,n.createElement)("th",{scope:"row",className:q()("itsec-card-banned-users__bans--column-label",`itsec-card-banned-users__ban--actor-type-${t.created_by?t.created_by.type:"none"}`,t.created_by&&`itsec-card-banned-users__ban--actor-id-${t.created_by.id}`)},(0,n.createElement)("span",{className:"itsec-card-banned-users__bans-label"},t.label),t.created_at&&(0,n.createElement)("span",{className:"itsec-card-banned-users__bans-date"},(0,w.dateI18n)("M d, Y g:i A",t.created_at))),(0,n.createElement)("td",{className:"itsec-card-banned-users__bans--column-comment"},t.comment))}function be(e){let{master:t}=e;const{updateBan:a,deleteBan:r}=(0,m.useDispatch)("ithemes-security/bans"),{createNotice:s}=(0,m.useDispatch)("core/notices"),{isUpdating:c,isDeleting:l}=(0,m.useSelect)((e=>({isUpdating:e("ithemes-security/bans").isUpdating(t),isDeleting:e("ithemes-security/bans").isDeleting(t)}))),[o,u]=(0,n.useState)(t.comment),h=(0,V.SU)(t,"allow",!1).includes("PUT"),p=(0,y.flatten)(Object.values((0,y.get)(t,"_links",{}))).filter((e=>"text/html"===e.media));return(0,n.createElement)("div",{className:"itsec-card-banned-users__ban"},(0,n.createElement)("div",{className:"itsec-card-banned-users__ban-top"},(0,n.createElement)("dl",null,(0,n.createElement)("dt",null,(0,i.__)("Host","better-wp-security")),(0,n.createElement)("dd",null,t.label),(0,n.createElement)("dt",null,(0,i.__)("Time","better-wp-security")),(0,n.createElement)("dd",null,t.created_at&&(0,w.dateI18n)("M d, Y g:i A",t.created_at)),(0,n.createElement)("dt",null,(0,i.__)("Source","better-wp-security")),(0,n.createElement)("dd",null,t.created_by&&t.created_by.label),!h&&(0,n.createElement)(React.Fragment,null,(0,n.createElement)("dt",null,(0,i.__)("Notes","better-wp-security")),(0,n.createElement)("dd",null,t.comment))),(0,n.createElement)("ul",{className:"itsec-card-banned-users__ban-actions"},(0,V.SU)(t,"allow",!1).includes("DELETE")&&(0,n.createElement)("li",null,(0,n.createElement)(d.Button,{variant:"link",isBusy:l,onClick:()=>r(t),icon:"dismiss"},(0,i.__)("Remove Ban","better-wp-security"))),p.map((e=>(0,n.createElement)("li",{key:e.href},(0,n.createElement)("a",{href:e.href},(0,n.createElement)(d.Icon,{icon:"arrow-right-alt"}),e.title)))))),h&&(0,n.createElement)(d.TextareaControl,{className:"itsec-card-banned-users__ban-notes",label:(0,i.__)("Notes","better-wp-security"),value:o,onChange:u,onBlur:()=>o!==t.comment&&(async()=>{const e=await a(t,{comment:o});e instanceof Error&&s("error",e.message,{context:"ithemes-security"})})(),readOnly:c,maxLength:255,rows:4}))}function fe(e){let{isSmall:t,onSelect:a,selected:r}=e;const{fetchQueryNextPage:s}=(0,m.useDispatch)("ithemes-security/bans"),{bans:c,hasNext:l,isQuerying:o}=(0,m.useSelect)((e=>({bans:e("ithemes-security/bans").getBans(),hasNext:!!e("ithemes-security/bans").getQueryHeaderLink("main","next"),isQuerying:e("ithemes-security/bans").isQuerying("main")})));return(0,n.createElement)(ee,{masters:c,detailRender:be,masterRender:pe,selectedId:r,select:a,idProp:V.AW,direction:"vertical",borderless:!0,isSmall:t,hasNext:l,loadNext:()=>s("main"),isQuerying:o},(0,n.createElement)("thead",null,(0,n.createElement)("tr",null,(0,n.createElement)("th",{className:"itsec-card-banned-users__bans--column-label"},(0,i.__)("Host","better-wp-security")),(0,n.createElement)("th",{className:"itsec-card-banned-users__bans--column-comment"},(0,i.__)("Notes","better-wp-security")))))}var ye=a(54639),ge=a(33590);const Ee=(0,ye.Zz)(ge.ZP),_e={disableInlineErrors:!0};function ve(e){let{id:t,createForm:a,save:r,setSaving:s,afterSave:i}=e;const c=(0,n.useRef)(null),[l,o]=(0,n.useState)({}),[d,u]=(0,n.useState)({}),{createNotice:h}=(0,m.useDispatch)("core/notices"),p=(0,n.useMemo)((()=>{if(a)return(0,V.UC)(a.submissionSchema,a.submissionSchema.uiSchema||{})}),[a]);return(0,n.createElement)("section",{className:"itsec-card-banned-users__create"},p&&(0,n.createElement)(Ee,{id:t,idPrefix:`${t}_part`,formData:l,onChange:e=>o(e.formData),onSubmit:async e=>{s(!0),u({});const t=await r(a.href,e.formData);if(s(!1),t instanceof Error)if("rest_invalid_param"===t.code&&(0,y.isObject)(t.data.params)){const e=(0,y.mapValues)(t.data.params,(e=>({__errors:[e]})));u(e)}else h("error",t.message,{context:"ithemes-security"});else if(i(),o({}),c&&c.current){const e=c.current.formElement.querySelector("input");e&&e.focus()}},schema:p,uiSchema:p.uiSchema||{},omitExtraData:!0,liveValidate:!(0,y.isEmpty)(l),extraErrors:d,formContext:_e,ref:c},(0,n.createElement)(React.Fragment,null)))}const Ne="banned-users-list",ke={render:function(e){let{card:t,config:a,eqProps:r}=e;const[s,c]=(0,n.useState)(!1),[l,o]=(0,n.useState)(!1),{schema:u,isQuerying:h}=(0,m.useSelect)((e=>({schema:e("ithemes-security/core").getSchema("ithemes-security-ban"),isQuerying:e("ithemes-security/bans").isQuerying("main")})),[]),{createBan:p,query:b,invalidateResolutionForStoreSelector:f}=(0,m.useDispatch)("ithemes-security/bans"),y=(0,ue.S)(b,500),[g,E]=(0,n.useState)(0),_=r["max-height"]&&r["max-height"].includes("500px"),v=`itsec-ban-card-create-form__${t.id}`;return(0,n.createElement)("div",{className:q()("itsec-card--type-banned-users",{"itsec-card-banned-users--creating":s})},(0,n.createElement)(R,null,(0,n.createElement)(X,{isSmall:_,select:E,selectedId:g}),(0,n.createElement)(P,{card:t,config:a})),(0,n.createElement)(he,{query:y,isQuerying:h}),(0,n.createElement)(fe,{selected:!s&&g,onSelect:e=>{E(e),c(!1)},isSmall:_}),s&&(0,n.createElement)(ve,{id:v,createForm:s,save:p,setSaving:o,afterSave:()=>f("getBans")}),(0,n.createElement)(G,null,s&&(0,n.createElement)(React.Fragment,null,(0,n.createElement)("span",{className:"itsec-card-footer__action"},(0,n.createElement)(d.Button,{variant:"link",isSmall:!0,disabled:l,onClick:()=>c(!1)},(0,i.__)("Cancel","better-wp-security"))),(0,n.createElement)("span",{className:"itsec-card-footer__action"},(0,n.createElement)(d.Button,{variant:"primary",isSmall:!0,form:v,type:"submit",isBusy:l,disabled:l},(0,i.__)("Save","better-wp-security")))),!s&&(0,n.createElement)(React.Fragment,null,u?.links.filter((e=>"create-form"===e.rel&&(!e.targetHints?.allow||e.targetHints.allow.includes("POST")))).map((e=>(0,n.createElement)("span",{key:e.href,className:"itsec-card-footer__action"},(0,n.createElement)(d.Button,{isSmall:!0,variant:"primary",onClick:()=>c(!s&&e)},e.title)))))))},elementQueries:[{type:"height",dir:"max",px:500}]};function Ce(){const{registerCard:e}=(0,m.useDispatch)("ithemes-security/dashboard");(0,f.eH)(Ce,(()=>[r,s].forEach((t=>{let{slug:a,settings:r}=t;return e(a,r)}))))}var Ie=a(73470);function we(){const{requesting:e,siteInfo:t}=(0,m.useSelect)((e=>({siteInfo:e("ithemes-security/core").getSiteInfo(),dashboards:e("ithemes-security/dashboard").getAvailableDashboards(),requesting:e("ithemes-security/dashboard").isRequestingDashboards()})));let a;if(t){const e=(0,Ie.getPath)(t.url);a=(0,Ie.getAuthority)(t.url),e&&(a+="/"+e)}return!e&&(0,n.createElement)("div",{className:"itsec-admin-bar"},(0,n.createElement)("div",{className:"itsec-admin-bar__primary"},(0,n.createElement)(b.AdminBarSlot,{type:"primary"})),(0,n.createElement)("div",{className:"itsec-admin-bar__secondary"},(0,n.createElement)("span",{className:"itsec-admin-bar__url"},a)))}var Le=a(4942),xe=a(69968),Se=a(87462);const Oe=(0,u.createHigherOrderComponent)((e=>{var t;return t=class extends n.Component{constructor(){super(...arguments),(0,Le.Z)(this,"state",{width:1280,breakpoint:null}),(0,Le.Z)(this,"mounted",!1),(0,Le.Z)(this,"ref",null),(0,Le.Z)(this,"onWindowResize",(()=>{if(!this.mounted)return;const e=(0,n.findDOMNode)(this);if(e instanceof window.HTMLElement){const t=e.offsetWidth,a=xe.Responsive.utils.getBreakpointFromWidth(M.j$,t);this.setState({width:t,breakpoint:a})}}))}componentDidMount(){this.mounted=!0,window.addEventListener("resize",this.onWindowResize),document.getElementById("collapse-button").addEventListener("click",this.onWindowResize),this.onWindowResize()}componentWillUnmount(){this.mounted=!1,window.removeEventListener("resize",this.onWindowResize),document.getElementById("collapse-button").removeEventListener("click",this.onWindowResize)}render(){const{measureBeforeMount:t,...a}=this.props;return t&&!this.mounted?(0,n.createElement)("div",{className:this.props.className,style:this.props.style}):(0,n.createElement)(e,(0,Se.Z)({},a,{width:this.state.width,breakpoint:this.state.breakpoint}))}},(0,Le.Z)(t,"defaultProps",{measureBeforeMount:!0}),t}),"widthProvider");var De=a(35800);const Ae=(0,u.pure)((function(e){let{id:t,dashboardId:a,className:r,gridWidth:s,children:i,...c}=e;const{card:l,config:o}=(0,m.useSelect)((e=>({card:e("ithemes-security/dashboard").getDashboardCard(t),config:e("ithemes-security/dashboard").getDashboardCardConfig(t)||{}})),[t]),d=function(e){const t=(0,m.useSelect)((t=>t("ithemes-security/dashboard").getRegisteredCard(e.slug)),[e.slug]);if(t?.render)return t.render;switch(e.type){case"line":return F;case"pie":return z}return null}(o),u=function(e,t,a){const r=(0,m.useSelect)((t=>t("ithemes-security/dashboard").getRegisteredCard(e.slug)),[e.slug])?.elementQueries;return(0,n.useMemo)((()=>{if(!r)return{};const e={height:t.height?(0,y.toInteger)(t.height.replace("px","")):0};t.width&&t.width.endsWith("%")?e.width=(0,y.toInteger)(t.width.replace("%",""))*a/100:e.width=t.width?(0,y.toInteger)(t.width.replace("px","")):0;const s={};for(const t of r){if(!e[t.type])continue;let a=!1;switch(t.dir){case"max":a=e[t.type]<=t.px;break;case"min":a=e[t.type]>=t.px}a&&(s[`${t.dir}-${t.type}`]=(s[`${t.dir}-${t.type}`]||"")+t.px+"px ")}return(0,y.mapValues)(s,(e=>e.trim()))}),[r,t,a])}(o,c.style,s);return"unknown"===l.card?(0,n.createElement)("article",(0,Se.Z)({className:q()(r,"itsec-card","itsec-card--unknown")},c),(0,n.createElement)(te,{card:l,dashboardId:a})):d?(0,n.createElement)("article",(0,Se.Z)({className:q()(r,"itsec-card"),id:`itsec-card-${l.id}`},c,u),(0,n.createElement)(De.ErrorBoundary,{FallbackComponent:(0,f.vl)({card:l,config:o})(ae)},(0,n.createElement)(d,{card:l,config:o,dashboardId:a,eqProps:u})),i):(0,n.createElement)("article",(0,Se.Z)({className:q()(r,"itsec-card","itsec-card--no-rendered")},c),(0,n.createElement)(ae,{card:l,config:o}))})),Be=(0,u.compose)([(0,m.withDispatch)((e=>({openEditCards:e("ithemes-security/dashboard").openEditCards})))])((function(e){let{openEditCards:t}=e;return(0,n.createElement)("div",{className:"itsec-card-grid-empty-state"},(0,n.createElement)(d.Button,{onClick:t},(0,n.createElement)(d.Dashicon,{icon:"plus-alt",size:60}),(0,n.createElement)("span",null,(0,i.__)("Add Security Cards","better-wp-security"))))}));class Te extends n.Component{constructor(e){super(e),(0,Le.Z)(this,"_onLayoutChange",((e,t)=>{if(!(0,M.IF)(t,this.state.layout)){this.setState({layout:t});const e=(0,M.Ai)(this.props.dashboardId,t);this.props.saveLayout(this.props.dashboardId,e)}})),(0,Le.Z)(this,"onBreakpointChange",(e=>{this.setState({breakpoint:e})})),(0,Le.Z)(this,"onStartMove",(()=>{this.setState({isMoving:!0})})),(0,Le.Z)(this,"onStopMove",(()=>{this.setState({isMoving:!1})})),this.state={layout:(0,M.BP)(e.dashboardId,e.cards,e.layout),isMoving:!1,breakpoint:e.breakpoint||"wide",breakpointInitialized:!!e.breakpoint},this.onLayoutChange=(0,y.debounce)(this._onLayoutChange,1e3)}componentDidUpdate(e){if(this.state.breakpointInitialized||!this.props.breakpoint||e.breakpoint||this.setState({breakpoint:this.props.breakpoint,breakpointInitialized:!0}),this.props.layout!==e.layout&&(this.props.dashboardId!==e.dashboardId||this.props.cards.length!==e.cards.length)){const e=(0,M.BP)(this.props.dashboardId,this.props.cards,this.props.layout);this.setState({layout:e})}if(this.props.dashboardId===e.dashboardId&&this.props.cards.length>e.cards.length){const e=(0,M.BP)(this.props.dashboardId,this.props.cards,(0,M.Ai)(this.props.dashboardId,this.state.layout));this.setState({layout:e}),this.props.saveLayout(this.props.dashboardId,(0,M.Ai)(this.props.dashboardId,e))}}componentWillUnmount(){this.onLayoutChange.cancel()}render(){const{cards:e,dashboardId:t,usingTouch:a}=this.props;return e.length?(0,n.createElement)(xe.Responsive,{breakpoints:M.j$,onBreakpointChange:this.onBreakpointChange,cols:M.sv,rowHeight:200,width:this.props.width,layouts:this.state.layout,onLayoutChange:this.onLayoutChange,margin:[20,20],isDraggable:!a,isResizable:!a,className:this.state.isMoving?"itsec-card-grid--moving":"",draggableHandle:".itsec-card-header, .itsec-card--unknown, .itsec-card__drag-handle",onDragStart:this.onStartMove,onDragStop:this.onStopMove,onResizeStart:this.onStartMove,onResizeStop:this.onStopMove},(0,M.Mf)(e,this.state.layout,this.state.breakpoint).map((e=>(0,n.createElement)(Ae,{id:e.id,dashboardId:t,key:e.id.toString(),gridWidth:this.props.width})))):(0,n.createElement)(Be,null)}}const Me=(0,u.compose)([(0,m.withSelect)(((e,t)=>({cards:e("ithemes-security/dashboard").getDashboardCards(t.dashboardId),layout:e("ithemes-security/dashboard").getDashboardLayout(t.dashboardId),usingTouch:e("ithemes-security/dashboard").isUsingTouch(),cardsLoaded:e("ithemes-security/dashboard").areCardsLoaded(t.dashboardId),layoutLoaded:e("ithemes-security/dashboard").isLayoutLoaded(t.dashboardId)}))),(0,u.ifCondition)((e=>{let{cardsLoaded:t,layoutLoaded:a}=e;return t&&a})),Oe,u.pure,(0,m.withDispatch)(((e,t)=>({openEditCards:e("ithemes-security/dashboard").openEditCards,saveLayout:e("ithemes-security/dashboard").saveDashboardLayout,refresh(){e("ithemes-security/dashboard").refreshDashboardCards(t.dashboardId)}}))),(0,f.nP)(12e4,(e=>{let{refresh:t}=e;return t()}))])(Te);var Pe=a(78349),Re=a.n(Pe),Fe=a(11394),je=a.n(Fe);function He(){const[e,t]=(0,n.useState)(""),[a,r]=(0,n.useState)(""),[s,c]=(0,n.useState)({}),{canCreate:l,canCreateLoaded:o,addingScratch:d,addingDefault:u}=(0,m.useSelect)((e=>({canCreate:e("ithemes-security/dashboard").canCreateDashboards(),canCreateLoaded:e("ithemes-security/dashboard").isCanCreateDashboardsLoaded(),addingScratch:e("ithemes-security/dashboard").isAddingDashboard("create-dashboard-scratch"),addingDefault:e("ithemes-security/dashboard").isAddingDashboard("create-dashboard-default")}))),{addDashboard:h}=(0,m.useDispatch)("ithemes-security/dashboard");if(!l&&o)return(0,n.createElement)("div",{className:"itsec-create-dashboard"},(0,n.createElement)("p",null,(0,i.__)("You don’t have permission to create new dashboards. Try switching to a dashboard or ask an administrator to invite you to one.","better-wp-security")));const p=t=>r=>{r.preventDefault();const s={};switch(t){case"scratch":s.label=a;break;case"default":s.label=e,s.preset="default";break;default:return}s.label.trim().length<=0?c({[t]:!0}):h(s,`create-dashboard-${t}`)};return(0,n.createElement)("div",{className:"itsec-create-dashboard"},(0,n.createElement)("section",{className:"itsec-create-dashboard__start itsec-create-dashboard__start--default"},(0,n.createElement)("header",null,(0,n.createElement)(Re(),{height:100}),(0,n.createElement)("h2",null,(0,i.__)("Start with the default layout.","better-wp-security")),(0,n.createElement)("p",null,(0,i.__)("You can continue to customize this later.","better-wp-security"))),(0,n.createElement)($e,{label:e,onLabelChange:t,onSubmit:p("default"),isBusy:u,isDisabled:d,hasError:s.default})),(0,n.createElement)("section",{className:"itsec-create-dashboard__start itsec-create-dashboard__start--scratch"},(0,n.createElement)("header",null,(0,n.createElement)(je(),{height:100,className:"itsec-create-dashboard__scratch-icon"}),(0,n.createElement)("h2",null,(0,i.__)("Start from Scratch.","better-wp-security")),(0,n.createElement)("p",null,(0,i.__)("Start building a dashboard with security cards.","better-wp-security"))),(0,n.createElement)($e,{label:a,onLabelChange:r,onSubmit:p("scratch"),isBusy:d,isDisabled:u,hasError:s.scratch})))}function $e(e){let{label:t,onLabelChange:a,onSubmit:r,isDisabled:s,isBusy:c,hasError:l}=e;const o=(0,u.useInstanceId)(He);return(0,n.createElement)("form",{onSubmit:r},(0,n.createElement)(d.TextControl,{className:q()("itsec-create-dashboard__name",{"itsec-create-dashboard__name--hide-help-text":!l}),label:(0,i.__)("Dashboard Name","better-wp-security"),placeholder:(0,i.__)("Dashboard Name…","better-wp-security"),id:`itsec-create-dashboard__name--${o}`,value:t,onChange:a,disabled:c||s,help:(0,i.__)("Entering a dashboard name is required.","better-wp-security"),required:!0}),(0,n.createElement)("div",{className:"itsec-create-dashboard__trigger-container"},(0,n.createElement)(d.Button,{className:"itsec-create-dashboard__trigger",type:"submit",isBusy:c,disabled:s},(0,i.__)("Create Board","better-wp-security"))))}const We=(0,u.compose)([(0,m.withSelect)(((e,t)=>({cardAtLimit:e("ithemes-security/dashboard").isCardAtDashboardLimit(t.dashboardId,t.ldo.aboutLink),isAdding:e("ithemes-security/dashboard").isAddingCard(`edit-cards-add-${t.ldo.aboutLink}-to-${t.dashboardId}`)}))),(0,m.withDispatch)(((e,t)=>({add(a){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e("ithemes-security/dashboard").addDashboardCard(a,r,`edit-cards-add-${t.ldo.aboutLink}-to-${t.dashboardId}`)}})))])((function(e){let{ldo:t,cardAtLimit:a,isAdding:r,add:s}=e;return!a&&(0,n.createElement)("li",{className:"itsec-edit-cards__card-choice itsec-edit-cards__card-choice--add"},(0,n.createElement)("span",{className:"itsec-edit-cards__card-choice-title"},t.title),(0,n.createElement)(d.Button,{disabled:r,onClick:()=>s(t.href),className:"itsec-edit-cards__action itsec-edit-cards__action--add",label:(0,i.__)("Add","better-wp-security"),icon:"plus",showTooltip:!1}))})),Ze=(0,u.compose)([(0,m.withSelect)(((e,t)=>({config:e("ithemes-security/dashboard").getAvailableCard(t.card.card)}))),(0,m.withDispatch)(((e,t)=>({remove:()=>e("ithemes-security/dashboard").removeDashboardCard(t.dashboardId,t.card)})))])((function(e){let{card:t,config:a,remove:r}=e;return(0,n.createElement)("li",{className:"itsec-edit-cards__card-choice itsec-edit-cards__card-choice--remove"},(0,n.createElement)(d.Button,{className:"itsec-edit-cards__action itsec-edit-cards__action--remove",label:(0,i.__)("Remove","better-wp-security"),icon:"no",showTooltip:!1,onClick:r}),(0,n.createElement)("span",{className:"itsec-edit-cards__card-choice-title"},(0,M.GP)(t,a)))})),qe=S()((e=>(0,y.sortBy)(e,[e=>{const t=(0,m.select)("ithemes-security/dashboard").getAvailableCard(e.card);return(0,M.GP)(e,t)}]))),Ve=(0,u.compose)([(0,m.withSelect)(((e,t)=>({cards:e("ithemes-security/dashboard").getDashboardCards(t.dashboardId),isAdding:e("ithemes-security/dashboard").isAddingCard(t.selected,{}),availableCardLDOs:e("ithemes-security/dashboard").getDashboardAddableCardLDOs(t.dashboardId)})))])((function(e){let{dashboardId:t,cards:a,availableCardLDOs:r}=e;return(0,n.createElement)("div",{className:"itsec-edit-cards"},(0,n.createElement)("header",null,(0,n.createElement)("h3",null,(0,i.__)("Edit Cards","better-wp-security")),(0,n.createElement)("p",null,(0,i.__)("Add or remove cards on your dashboard.","better-wp-security"))),(0,n.createElement)("section",null,(0,n.createElement)("ul",{className:"itsec-edit-cards__card-choices"},r.map((e=>(0,n.createElement)(We,{ldo:e,key:e.href,dashboardId:t}))),qe(a).map((e=>(0,n.createElement)(Ze,{key:e.id,card:e,dashboardId:t}))),(0,n.createElement)(b.EditCardsSlot,null))))}));function ze(e){let{dashboardId:t}=e;const a=(0,M.bK)(),r=(0,V.bv)("settings"),{canManage:s}=(0,M.qt)(),{canCreate:c,canEdit:l,editingCards:o}=(0,m.useSelect)((e=>({canCreate:e("ithemes-security/dashboard").canCreateDashboards(),canEdit:e("ithemes-security/dashboard").canEditDashboard(t),editingCards:e("ithemes-security/dashboard").isEditingCards()})),[t]),{openEditCards:u,closeEditCards:h}=(0,m.useDispatch)("ithemes-security/dashboard");return a||s?(0,n.createElement)("div",{className:"itsec-dashboard-toolbar"},(0,n.createElement)(d.Toolbar,{label:(0,i.__)("Dashboard Toolbar","better-wp-security")},s&&(0,n.createElement)(d.ToolbarButton,{text:(0,i.__)("Settings","better-wp-security"),icon:"admin-settings",href:r}),(0,n.createElement)(b.AdminBarSlot,null),l&&(0,n.createElement)(React.Fragment,null,(0,n.createElement)(d.ToolbarButton,{text:(0,i.__)("Edit Cards","better-wp-security"),icon:"layout",className:"itsec-admin-bar-edit-cards__trigger","aria-expanded":o,onClick:o?h:u}),o&&(0,n.createElement)(d.Popover,{className:"itsec-admin-bar-edit-cards__content",position:"bottom",headerTitle:(0,i.__)("Edit Cards","better-wp-security"),expandOnMobile:!0,onFocusOutside:h,onClose:h,focusOnMount:"container"},(0,n.createElement)(Ve,{dashboardId:t,close:h}))),(l||c)&&(0,n.createElement)(Ue,null))):null}function Ue(){const{page:e}=(0,m.useSelect)((e=>({page:e("ithemes-security/dashboard").getCurrentPage()}))),{viewHelp:t,viewPrevious:a}=(0,m.useDispatch)("ithemes-security/dashboard");return(0,n.createElement)(d.ToolbarButton,{icon:"editor-help",className:"itsec-admin-bar__help",onClick:()=>{"help"===e?a():t()},text:"help"===e?(0,i.__)("Exit Help","better-wp-security"):(0,i.__)("Help","better-wp-security")})}function Qe(){const{page:e}=(0,m.useSelect)((e=>({page:e("ithemes-security/dashboard").getCurrentPage()}))),{viewHelp:t,viewPrevious:a}=(0,m.useDispatch)("ithemes-security/dashboard");return(0,n.createElement)("div",{className:"itsec-dashboard-help"},(0,n.createElement)("div",{className:"itsec-help-header"},(0,n.createElement)("h1",{className:"itsec-help-header__title"},(0,i.__)("Help","better-wp-security")),(0,n.createElement)(d.Button,{onClick:()=>{"help"===e?a():t()},icon:"arrow-left-alt",text:(0,i.__)("Back","better-wp-security"),className:"itsec-help-header__back-link"})),(0,n.createElement)(me.ss,{topic:"dashboard"}))}const Ke=(0,u.pure)((e=>{let{page:t,dashboardId:a}=e;switch(Ce(),t){case"view-dashboard":return(0,n.createElement)(Me,{dashboardId:a});case"create-dashboard":return(0,n.createElement)(He,null);case"help":return(0,n.createElement)(Qe,null);default:return null}}));function Ge(e){let{context:t}=e;const{page:a,primaryDashboard:r,dashboardId:s,isUsingTouch:i,notices:c}=(0,m.useSelect)((e=>({page:e("ithemes-security/dashboard").getCurrentPage(),primaryDashboard:e("ithemes-security/dashboard").getPrimaryDashboard(),dashboardId:e("ithemes-security/dashboard").getViewingDashboardId(),isUsingTouch:e("ithemes-security/dashboard").isUsingTouch(),notices:e("core/notices").getNotices("ithemes-security")})),[]),{usingTouch:l,viewDashboard:y,viewCreateDashboard:g}=(0,m.useDispatch)("ithemes-security/dashboard"),{removeNotice:E}=(0,m.useDispatch)("core/notices");(0,f.OR)("touchstart",(()=>i||l()));const _=(0,u.usePrevious)(r);return(0,n.useEffect)((()=>{void 0===_&&(r?y(r):g())}),[r]),void 0===r?null:(0,n.createElement)(o.a,{theme:p.uH},(0,n.createElement)(d.SlotFillProvider,null,(0,n.createElement)(M.E_.Provider,{value:t},(0,n.createElement)("div",{className:`itsec-dashboard itsec-app-page--${a}`},(0,n.createElement)(d.Popover.Slot,null),(0,n.createElement)(d.NoticeList,{notices:c,onRemove:e=>E(e,"ithemes-security")}),(0,n.createElement)(ze,{dashboardId:s}),(0,n.createElement)(b.BelowToolbarSlot,{fillProps:{page:a,dashboardId:s}}),(0,n.createElement)(we,{dashboardId:s}),(0,n.createElement)(Ke,{page:a,dashboardId:s})),(0,n.createElement)(h.PluginArea,null))))}function Ye(e){let{title:t}=e;return(0,n.createElement)("li",{className:"itsec-edit-cards__card-choice itsec-edit-cards__card-choice--promo"},(0,n.createElement)("span",{className:"itsec-edit-cards__card-choice-title"},(0,n.createElement)("span",null,(0,i.__)("Pro: ","better-wp-security")),t),(0,n.createElement)(d.Button,{className:"itsec-edit-cards__action itsec-edit-cards__action--add",label:(0,i.__)("Go Pro","better-wp-security"),href:"https://ithemes.com/security/?utm_source=wordpressadmin&utm_medium=dashboardcard&utm_campaign=itsecfreecta",icon:"external"}))}a.p=window.itsecWebpackPublicPath,(0,i.setLocaleData)({"":{}},"better-wp-security"),l()((()=>{const e=document.getElementById("itsec-dashboard-root");if(e){const t="1"===e.dataset.canManage,a=e.dataset.installType;(0,n.render)((0,n.createElement)(Ge,{context:{canManage:t,installType:a}}),e)}}))},65760:(e,t,a)=>{"use strict";a.d(t,{Ai:()=>g,BP:()=>E,Bi:()=>_,E$:()=>x,E_:()=>u,GP:()=>w,IF:()=>k,Mf:()=>C,_U:()=>L,bK:()=>h,hN:()=>p,j$:()=>f,lh:()=>I,pD:()=>v,qt:()=>m,sv:()=>b});var r=a(92819),s=a(59588),n=a.n(s),i=a(48015),c=a(95122),l=a(54761),o=a(6293),d=a(31511);const u=(0,o.createContext)({canManage:!1,installType:""});function m(){return(0,o.useContext)(u)}function h(){const{canCreate:e,canEdit:t}=(0,i.useSelect)((e=>({canCreate:e("ithemes-security/dashboard").canCreateDashboards(),canEdit:e("ithemes-security/dashboard").canEditDashboard(e("ithemes-security/dashboard").getViewingDashboardId())})),[]);return e||t}const p=Object.freeze(["huge","wide","large","medium","mobile"]),b=Object.freeze({huge:8,wide:6,large:4,medium:2,mobile:1}),f=Object.freeze(p.reduce(((e,t)=>({...e,[t]:250*b[t]+20*(b[t]-1)})),{})),y=["minW","minH","maxW","maxH"];function g(e,t){const a=(0,i.select)("ithemes-security/dashboard"),r={};for(const e in t){if(!t.hasOwnProperty(e))continue;const s=t[e];for(const t of s){const s=a.getDashboardCard(parseInt(t.i));s&&(r[s.id]?(r[s.id].size[e]={w:t.w,h:t.h},r[s.id].position[e]={x:t.x&&t.x!==1/0?t.x:0,y:t.y&&t.y!==1/0?t.y:0}):r[s.id]={id:s.id,card:s.card,size:{[e]:{w:t.w,h:t.h}},position:{[e]:{x:t.x&&t.x!==1/0?t.x:0,y:t.y&&t.y!==1/0?t.y:0}}})}}return{cards:Object.values(r)}}function E(e,t,a){let{cards:s={}}=a;const n=(0,r.zipObject)(Object.keys(f),(0,r.times)(Object.keys(f).length,(()=>[]))),c={};for(const t of s){c[t.id]=!0;const a=(0,i.select)("ithemes-security/dashboard").getAvailableCard(t.card);if(a||"unknown"===t.card)for(const r of p)n[r].push(_(e,t,a,r,n[r]))}if(Object.keys(c).length<t.length)for(const a of t)if(!c[a.id]){const t=(0,i.select)("ithemes-security/dashboard").getAvailableCard(a.card);if(t)for(const r of p)n[r].push(_(e,a,t,r,n[r]))}return n}function _(e,t,a,s,n){if(!f[s])return;const c={i:t.id.toString(),x:(0,r.get)(t,["position",s,"x"]),y:(0,r.get)(t,["position",s,"y"]),w:(0,r.get)(t,["size",s,"w"],(0,r.get)(a,["size","defaultW"],1)),h:(0,r.get)(t,["size",s,"h"],(0,r.get)(a,["size","defaultH"],2))};if(a&&a.size)for(const e of y)a.size.hasOwnProperty(e)&&(c[e]=a.size[e]);if(c.minW&&c.minW>c.w&&(c.w=c.minW),c.minH&&c.minH>c.h&&(c.h=c.minH),c.maxW&&c.w>c.maxW&&(c.w=c.maxW),c.maxH&&c.h>c.maxH&&(c.h=c.maxH),n&&void 0===c.x&&void 0===c.x){const e=v(b[s],n,{w:c.w,h:c.h});e&&(c.x=e.x,c.y=e.y)}return c.x=void 0===c.x||null===c.x?0:c.x,c.y=void 0===c.y||null===c.y?1/0:c.y,(0,i.select)("ithemes-security/dashboard").canEditDashboard(e)||(c.static=!0),"unknown"===t.card&&(c.isResizable=!1),c.minW===c.maxW&&c.minH===c.maxH&&(c.isResizable=!1),c}function v(e,t,a){const r=[];for(const a of t){const{x:t,y:s,w:n,h:i}=a;for(let a=0;a<i;a++){r[a]||(r[a]=new Array(e).fill(0));for(let i=0;i<n;i++)r[a+s]||(r[a+s]=new Array(e).fill(0)),r[a+s][i+t]=1}}const{w:s,h:n}=a;for(let t=0;t<r.length;t++)e:for(let a=0;a<e;a++)if(!r[t]||1!==r[t][a]){for(let i=0;i<n;i++)for(let n=0;n<s;n++)if(t+i>r.length||a+n>=e||r[t+i]&&1===r[t+i][a+n])continue e;return{x:a,y:t}}return{x:0,y:r.length}}function N(e,t){return e.x===t.x&&e.y===t.y&&e.w===t.w&&e.h===t.h}const k=n()((function(e,t){if(e===t)return!0;if(Object.keys(e).length!==Object.keys(t).length)return!1;const a=new Map;for(let r=0;r<p.length;r++){const s=p[r];if(e[s]||t[s]){if(!e[s]&&t[s]||e[s]&&!t[s])return!1;if(e[s].length!==t[s].length)return!1;for(let t=0;t<e[s].length;t++)a.set(e[s][t].i,e[s][t]);for(let e=0;e<t[s].length;e++){const r=a.get(t[s][e].i);if(!r)return!1;if(!N(r,t[s][e]))return!1;a.delete(r.i)}if(a.size>0)return!1}}return!0})),C=n()((function(e,t,a){const s=(0,r.keyBy)(t[a],"i"),n=[...e];return n.sort((function(e,t){const a=e.id.toString(),r=t.id.toString();if(!s[a]&&!s[r])return 0;if(s[a]&&!s[r])return 1;if(!s[a]&&s[r])return-1;const n=s[a].y,i=s[r].y,c=s[a].x,l=s[r].x;return n>i?1:n<i?-1:c>l?1:c<l?-1:0})),n})),I=n()((function(e,t){const a=(0,r.keyBy)(t.cards,"id"),s=[...e];return s.sort((function(e,t){const r=e.id,s=t.id;if(!a[r]&&!a[s])return 0;if(a[r]&&!a[s])return 1;if(!a[r]&&a[s])return-1;const n=a[r].position.mobile.y,i=a[s].position.mobile.y,c=a[r].position.mobile.x,l=a[s].position.mobile.x;return n>i?1:n<i?-1:c>l?1:c<l?-1:0})),s}));function w(e,t){if(!t)return(0,c.__)("Unknown Card","better-wp-security");let a=t.label;return a=(0,l.applyFilters)(`ithemes-security.dashboard.getCardTitle.${t.slug}`,a,e),(0,l.applyFilters)("ithemes-security.dashboard.getCardTitle",a,e,t)}function L(e,t,a,r){Object.entries(a).forEach((t=>{let[a,r]=t;return e[a]!==r&&console.log(`Prop '${a}' changed`)})),Object.entries(r).forEach((e=>{let[a,r]=e;return t[a]!==r&&console.log(`State '${a}' changed`)}))}function x(e){return(0,r.get)(e,["avatar_urls",96],d.sE)}},33590:(e,t,a)=>{"use strict";a.d(t,{bB:()=>$,ZP:()=>K});var r={};a.r(r),a.d(r,{BaseInput:()=>d,CheckboxWidget:()=>h,CheckboxesWidget:()=>p,IncludeExcludeWidget:()=>O,RadioWidget:()=>w,SelectWidget:()=>_,TextareaWidget:()=>v,ToggleWidget:()=>m});var s={};a.r(s),a.d(s,{EntitySelectField:()=>T,FileTreeField:()=>H,TextareaListField:()=>P,TitleField:()=>A});var n=a(92819),i=a(87462),c=a(6293),l=a(64893),o=a(19144);const d=function(e){const{id:t,label:a,value:r,readonly:s,disabled:d,onBlur:u,onFocus:m,options:h,onChange:p,schema:b,uiSchema:f={},...y}=e;h.inputType?y.type=h.inputType:y.type||("number"===b.type?(y.type="number",y.step="any"):"integer"===b.type?(y.type="number",y.step="1"):y.type="text"),h.autocomplete&&(y.autoComplete=h.autocomplete),b.multipleOf&&(y.step=b.multipleOf),void 0!==b.minimum&&(y.min=b.minimum),void 0!==b.maximum&&(y.max=b.maximum);const g=f["ui:description"]||b.description;return(0,c.createElement)(l.TextControl,(0,i.Z)({label:a,help:(0,c.createElement)(o.Lu,{noWrap:!0,content:g}),readOnly:s,disabled:d,value:r||""},(0,n.omit)(y,["autofocus","formContext","registry","rawErrors"]),{onChange:e=>p(""===e?h.emptyValue:e),onBlur:u&&(e=>u(y.id,e.target.value)),onFocus:m&&(e=>m(y.id,e.target.value))}))};var u=a(54639);function m(e){let{schema:t,uiSchema:a={},id:r,value:s,disabled:n,readonly:i,label:d,onBlur:m,onFocus:h,onChange:p}=e;const b=u.P6.schemaRequiresTrueValue(t),f=a["ui:description"]||t.description;return(0,c.createElement)(l.ToggleControl,{checked:s||!1,onChange:p,required:b,disabled:n,readOnly:i,label:d,help:(0,c.createElement)(o.Lu,{noWrap:!0,content:f}),onBlur:m&&(e=>m(r,e.target.checked)),onFocus:h&&(e=>h(r,e.target.checked))})}function h(e){let{schema:t,uiSchema:a={},id:r,value:s,disabled:n,readonly:i,label:d,onBlur:m,onFocus:h,onChange:p}=e;const b=u.P6.schemaRequiresTrueValue(t),f=a["ui:description"]||t.description;return(0,c.createElement)(l.CheckboxControl,{checked:s||!1,onChange:p,required:b,disabled:n,readOnly:i,label:d,help:(0,c.createElement)(o.Lu,{noWrap:!0,content:f}),onBlur:m&&(e=>m(r,e.target.checked)),onFocus:h&&(e=>h(r,e.target.checked))})}function p(e){const{disabled:t,options:a,value:r,readonly:s,onChange:n,label:i,schema:l,uiSchema:d={}}=e,{enumOptions:u,enumDisabled:m=[],enumDescriptions:h=[]}=a,p=d["ui:description"]||l.description,b=u.map(((e,t)=>({...e,disabled:m.includes(e.value),help:h[t]&&(0,c.createElement)(o.Lu,{noWrap:!0,content:h[t]})})));return(0,c.createElement)(o.w2,{value:r||[],onChange:n,options:b,label:i||d["ui:title"]||l.title,help:(0,c.createElement)(o.Lu,{noWrap:!0,content:p}),readOnly:s,disabled:t})}const{asNumber:b,guessType:f}=u.P6,y=new Set(["number","integer"]);function g(e,t){const{type:a,items:r}=e;if(""!==t){if("array"===a&&r&&y.has(r.type))return t.map(b);if("boolean"===a)return"true"===t;if("number"===a)return b(t);if(e.enum){if(e.enum.every((e=>"number"===f(e))))return b(t);if(e.enum.every((e=>"boolean"===f(e))))return"true"===t}return t}}function E(e,t){return t?[].slice.call(e.target.options).filter((e=>e.selected)).map((e=>e.value)):e.target.value}const _=function(e){const{schema:t,uiSchema:a={},id:r,options:s,value:n,label:i,required:d,disabled:u,readonly:m,multiple:h,onChange:p,onBlur:b,onFocus:f,placeholder:y}=e,{enumOptions:_,enumDisabled:v}=s,N=h?[]:"",k=[];h||void 0!==t.default||k.push({value:"",label:y});for(const e of _)k.push({...e,disabled:v&&v.includes(e.value)});const C=a["ui:description"]||t.description;return(0,c.createElement)(l.SelectControl,{multiple:h,options:k,value:void 0===n?N:n,label:i,help:(0,c.createElement)(o.Lu,{noWrap:!0,content:C}),required:d,disabled:u,readOnly:m,onChange:e=>p(g(t,e)),onBlur:b&&(e=>b(r,g(t,E(e,h)))),onFocus:f&&(e=>f(r,g(t,E(e,h))))})};function v(e){let{schema:t,uiSchema:a={},id:r,value:s,disabled:d,readonly:u,label:m,onBlur:h,onFocus:p,onChange:b,...f}=e;const y=a["ui:description"]||t.description;return(0,c.createElement)(l.TextareaControl,(0,i.Z)({value:void 0===s?"":s,onChange:b,disabled:d,readOnly:u,label:m,help:(0,c.createElement)(o.Lu,{noWrap:!0,content:y}),onBlur:h&&(e=>h(r,e.target.value)),onFocus:p&&(e=>p(r,e.target.value))},(0,n.without)(f,["autofocus","formContext","registry","rawErrors"])))}const{asNumber:N,guessType:k}=u.P6,C=new Set(["number","integer"]);function I(e,t){const{type:a,items:r}=e;if(""!==t){if("array"===a&&r&&C.has(r.type))return t.map(N);if("boolean"===a)return"true"===t;if("number"===a)return N(t);if(e.enum){if(e.enum.every((e=>"number"===k(e))))return N(t);if(e.enum.every((e=>"boolean"===k(e))))return"true"===t}return t}}function w(e){let{schema:t,uiSchema:a={},id:r,options:s,value:n,label:i,required:d,disabled:u,readonly:m,onChange:h,onBlur:p,onFocus:b}=e;const{enumOptions:f}=s,y=a["ui:description"]||t.description;return(0,c.createElement)(l.RadioControl,{selected:n,options:f,label:i,help:(0,c.createElement)(o.Lu,{noWrap:!0,content:y}),required:d,disabled:u,readOnly:m,onChange:e=>h(I(t,e)),onBlur:p&&(e=>p(r,I(t,e.target.value))),onFocus:b&&(e=>b(r,I(t,e.target.value)))})}var L=a(95122),x=a(82839),S=a(81019);function O(e){let{id:t,disabled:a,options:r,value:s,onChange:i,schema:o,autofocus:d,readonly:u}=e;const{enumOptions:m,enumDisabled:h=[],excludeList:{title:p=(0,L.__)("Excluded","better-wp-security"),description:b=(0,L.__)("The list of items to exclude from the selection.","better-wp-security"),button:f=(0,L.__)("Include","better-wp-security")}={},includeList:{title:y=(0,L.__)("Included","better-wp-security"),description:g=(0,L.__)("The list of items to include in the selection.","better-wp-security"),button:E=(0,L.__)("Exclude","better-wp-security")}={},title:_=o.title,description:v=o.description}=r;(0,c.useEffect)((()=>{const e=m.map((e=>e.value)),t=s.filter((t=>e.includes(t)));t.length!==s.length&&i(t)}),[s,m,i]);const[N,k]=(0,n.partition)(m,(e=>!s.includes(e.value)));return(0,c.createElement)("div",{className:"itsec-rjsf-include-exclude-widget"},_&&(0,c.createElement)(l.BaseControl.VisualLabel,null,_),v&&(0,c.createElement)("p",null,v),(0,c.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__sides",id:t},(0,c.createElement)(D,{id:t+"__exclude",options:N,label:p,description:b,button:f,disabled:a||u,disabledOptions:h,autofocus:d,onToggle:e=>{(0,x.speak)((0,L.sprintf)((0,L.__)("Moved %1$s to %2$s.","better-wp-security"),(0,n.find)(N,{value:e}).label,y)),i([...s,e])}}),(0,c.createElement)(D,{id:t+"__include",options:k,label:y,description:g,button:E,disabled:a||u,disabledOptions:h,onToggle:e=>{(0,x.speak)((0,L.sprintf)((0,L.__)("Moved %1$s to %2$s.","better-wp-security"),(0,n.find)(k,{value:e}).label,p)),i(s.filter((t=>t!==e)))}})))}function D(e){let{id:t,label:a,description:r,options:s,button:i,onToggle:d,disabled:u,disabledOptions:m=[],autofocus:h}=e;const p=t+"__option__",[b,f]=(0,c.useState)("");return b&&!(0,n.find)(s,{value:b})&&f(""),(0,c.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__side"},(0,c.createElement)(l.BaseControl,{id:t,help:(0,c.createElement)(o.Lu,{noWrap:!0,content:r}),className:"itsec-rjsf-include-exclude-widget__listbox"},(0,c.createElement)("span",{className:"components-base-control__label",id:t+"__label"},a),(0,c.createElement)(o.T2,{role:"listbox",id:t,active:b&&p+b,"aria-labelledby":t+"__label","aria-describedby":r&&t+"__help",onNavigate:e=>f(e.substr(p.length)),onKeyDown:e=>{let{keyCode:t}=e;if(!b||t!==S.DELETE&&t!==S.BACKSPACE)return;const a=(0,n.findIndex)(s,{value:b}),r=a+1<s.length?a+1:a-1;d(b),f(s[r]?.value||"")},autoFocus:h},s.map((e=>(0,c.createElement)("div",{id:p+e.value,key:e.value,role:u||m.includes(e.value)?"presentation":"option","aria-selected":e.value===b||void 0,onClick:u||m.includes(e.value)?void 0:()=>f(e.value)},e.label))))),(0,c.createElement)(l.Button,{variant:"secondary",disabled:!b,className:"itsec-rjsf-include-exclude-widget__move",onClick:()=>d(b),"aria-keyshortcuts":"Delete Backspace"},i))}function A(e){const{id:t,title:a,required:r}=e;return(0,c.createElement)("span",{className:"itsec-rjsf-title-field",id:t},a,r&&(0,c.createElement)("span",{className:"required"},"*"))}const{getUiOptions:B}=u.P6;function T(e){let{uiSchema:t,schema:a,idSchema:r,name:s,formData:n,disabled:i,readonly:l,onChange:d}=e;const u=B(t);return(0,c.createElement)(o.fv,{id:r.$id,value:n,disabled:i,readonly:l,onChange:d,isMultiple:"array"===a.type,label:t["ui:title"]||a.title||s,description:t["ui:description"]||a.description,path:u.path,query:u.query,labelAttr:u.labelAttr,idAttr:u.idAttr,searchArg:u.searchArg})}const{getUiOptions:M}=u.P6;function P(e){let{uiSchema:t,schema:a,name:r,formData:s,disabled:n,readonly:i,onChange:l}=e;const d=t["ui:title"]||a.title||r,u=t["ui:description"]||a.description,m=M(t),{rows:h,placeholder:p}=m;return(0,c.createElement)(o.yA,{label:d,help:(0,c.createElement)(o.Lu,{noWrap:!0,content:u}),disabled:n,readonly:i,rows:h,value:s,onChange:l,placeholder:p})}var R=a(87514),F=a.n(R),j=a(73470);function H(e){let{idSchema:t,formData:a,onChange:r,uiSchema:s,schema:i,name:d,disabled:u,readonly:m,autofocus:h}=e;const p=t.$id,b=s["ui:title"]||i.title||d,f=s["ui:description"]||i.description,[y,g]=(0,c.useState)([]),[E,_]=(0,c.useState)("");(0,c.useEffect)((()=>{F()({path:(0,j.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:"/"})}).then(g)}),[]);const v=e=>{r(a.includes(e)?a.filter((t=>t!==e)):[...a,e])};return(0,c.createElement)("div",{className:"itsec-rjsf-file-tree"},f&&(0,c.createElement)(o.Lu,{content:f,tagName:"p"}),(0,c.createElement)("div",{className:"itsec-rjsf-file-tree__controls"},(0,c.createElement)("div",null,(0,c.createElement)(o.mp,{tree:y,id:p,label:(0,L.__)("File Selector","better-wp-security"),active:E,setActive:_,onActivate:v,onLoad:async e=>{const t=await F()({path:(0,j.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:e})}),a=(0,n.cloneDeep)(y);(0,o.in)(a,(a=>{if(a.id===e)return a.children=t,o.in.halt})),g(a)}}),(0,c.createElement)(l.Button,{variant:"secondary",disabled:!E,className:"itsec-rjsf-file-tree__select",onClick:()=>v(E),"aria-keyshortcuts":"Enter Space"},(0,L.__)("Select","better-wp-security"))),(0,c.createElement)(o.yA,{value:a,onChange:r,className:"itsec-rjsf-file-tree__list",label:b,disabled:u,readonly:m,autoFocus:h})))}function $(e){let{name:t,...a}=e;return(0,c.createElement)(l.Fill,(0,i.Z)({name:`RjsfField${t}`},a))}function W(e){let{name:t,...a}=e;return(0,c.createElement)(l.Slot,(0,i.Z)({name:`RjsfField${t}`},a))}const{ADDITIONAL_PROPERTY_FLAG:Z,getUiOptions:q}=u.P6;function V(e){const{id:t,classNames:a,disabled:r,label:s,onKeyChange:n,onDropPropertyClick:i,readonly:o,required:d,schema:u,uiSchema:m}=e,h=`${s} Key`,p=u.hasOwnProperty(Z),{removable:b}=q(m);return p&&!1!==b?(0,c.createElement)("div",{className:a},(0,c.createElement)("div",{className:"row"},(0,c.createElement)("div",{className:"col-xs-5 form-additional"},(0,c.createElement)(l.TextControl,{label:h,required:d,id:`${t}-key`,onBlur:e=>n(e.target.value)})),(0,c.createElement)("div",{className:"form-additional form-group col-xs-5"},e.children),(0,c.createElement)("div",{className:"col-xs-2"},(0,c.createElement)(l.Button,{icon:"no-alt",isDestructive:!0,disabled:r||o,onClick:i(s)})))):(0,c.createElement)("div",{className:a},e.children)}const{canExpand:z}=u.P6;function U(e){let{className:t,onClick:a,disabled:r}=e;return(0,c.createElement)("div",{className:"row"},(0,c.createElement)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${t}`},(0,c.createElement)(l.Button,{icon:"plus-alt2",className:"btn-add col-xs-12","aria-label":(0,L.__)("Add","better-wp-security"),tabIndex:"0",onClick:a,disabled:r})))}const Q={FieldTemplate:function(e){const{children:t,errors:a,hidden:r,schema:s,uiSchema:n,formContext:i,onChange:o}=e;if(r)return null;const{resettable:d}=q(n);return(0,c.createElement)(V,e,t,(0,c.createElement)(W,{name:e.id,fillProps:e}),d&&(0,c.createElement)(l.Button,{className:"itsec-rjsf-reset-field",variant:"secondary",onClick:()=>o(s.default)},(0,L.__)("Restore Default","better-wp-security")),!0!==i?.disableInlineErrors&&a)},ObjectFieldTemplate:function(e){const{TitleField:t,DescriptionField:a,schema:r,uiSchema:s,properties:n}=e;if(!n.length)return null;const i=(s["ui:sections"]||[]).reduce(((e,t)=>({...e,[t.fields.find((e=>!!r.properties[e]))]:t})),{});return(0,c.createElement)("div",{className:"itsec-rjsf-object-fieldset",id:e.idSchema.$id},(s["ui:title"]||e.title)&&(0,c.createElement)(t,{id:`${e.idSchema.$id}__title`,title:e.title||s["ui:title"],required:e.required,formContext:e.formContext}),e.description&&(0,c.createElement)(a,{id:`${e.idSchema.$id}__description`,description:(0,c.createElement)(o.Lu,{noWrap:!0,content:e.description}),formContext:e.formContext}),n.map((e=>{let{name:t,content:a}=e;return i[t]?(0,c.createElement)(c.Fragment,{key:t},(0,c.createElement)("h3",{className:"itsec-rjsf-section-title"},i[t].title),i[t].description&&(0,c.createElement)("p",{className:"itsec-rjsf-section-description"},(0,c.createElement)(o.Lu,{noWrap:!0,content:i[t].description})),a):a})),z(r,s,e.formData)&&(0,c.createElement)(U,{className:"object-property-expand",onClick:e.onAddClick(r),disabled:e.disabled||e.readonly}))},ErrorList:function(e){let{errors:t}=e;return(0,c.createElement)(o.KM,{errors:t.map((function(){let{stack:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})).filter((e=>!!e))})},widgets:r,fields:s},K=Q},78349:(e,t,a)=>{var r=a(99196);function s(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".a,.e,.j,.k{fill:#e1f2fc;}.a,.e,.f,.g,.i,.j,.k{stroke:#0083e3;}.a{stroke-width:3px;}.b{fill:#0083e3;}.c,.f{fill:#fff;}.d,.g,.h,.i{fill:none;}.e,.i,.j{stroke-width:2px;}.h{stroke:#3fa2f7;}.j,.k{stroke-miterlimit:10;}")),r.createElement("g",{transform:"translate(-180.964 -417.881)",key:1},[r.createElement("g",{transform:"translate(182 419.381)",key:0},[r.createElement("path",{className:"a",d:"M349.371,304.5a4.867,4.867,0,0,0-4.871,4.863v86.914a3.244,3.244,0,0,0,3.247,3.242H482.523a3.244,3.244,0,0,0,3.247-3.242V309.363A4.867,4.867,0,0,0,480.9,304.5Z",transform:"translate(-327.18 -304.5)",key:0}),r.createElement("path",{className:"b",d:"M371,415.666H503.175V334H371Z",transform:"translate(-348.552 -328.291)",key:1}),r.createElement("path",{className:"c",d:"M373,416.892H504.4V336H373Z",transform:"translate(-350.164 -329.904)",key:2}),r.createElement("path",{className:"d",d:"M272.384,797.451c-2.16,0-4.861-1.293-6.017-1.844-.164-.079-.281-.135-.368-.174V793H437.654v2.433c-.087.041-.2.095-.368.174-1.146.552-3.828,1.844-5.97,1.844H272.384Z",transform:"translate(-263.871 -698.465)",key:3}),r.createElement("path",{className:"a",d:"M437.734,792.5H265.5v2.928c.2,0,3.874,2.1,6.686,2.1H431.094c2.793,0,6.44-2.109,6.632-2.109.006,0,.008-.017.008-.017Z",transform:"translate(-263.468 -698.061)",key:4}),r.createElement("path",{className:"b",d:"M266.363,805l-.193.387H437.63l.193-.387Z",transform:"translate(-264.008 -708.143)",key:5}),r.createElement("path",{className:"b",d:"M666.481,793.935h-19.6A1.9,1.9,0,0,1,645,792.019V792h23.416v.019a1.9,1.9,0,0,1-1.887,1.916",transform:"translate(-569.527 -697.658)",key:6}),r.createElement("path",{className:"b",d:"M703.525,319.007a.677.677,0,1,1-.677-.677.678.678,0,0,1,.677.677",transform:"translate(-615.633 -315.654)",key:7}),r.createElement("path",{className:"e",d:"M20.642,45.638H.9a2.882,2.882,0,0,1-2.9-2.9V-4.1A2.888,2.888,0,0,1,.9-7H20.642a2.863,2.863,0,0,1,2.9,2.9V42.735A2.857,2.857,0,0,1,20.642,45.638Z",transform:"translate(2.194 54.316)",key:8}),r.createElement("path",{className:"f",d:"M28.529,23.5H5.5V64.333H28.529Z",transform:"translate(-3.855 29.718)",key:9}),r.createElement("path",{className:"g",d:"M58.04,9.694a.183.183,0,0,1-.194.194H54.364a.194.194,0,1,1,0-.387h3.483a.183.183,0,0,1,.194.194Z",transform:"translate(-43.106 41.009)",key:10}),r.createElement("path",{className:"g",d:"M62.944.717A.387.387,0,1,1,62.557.33a.388.388,0,0,1,.387.387Z",transform:"translate(-49.558 48.405)",key:11}),r.createElement("path",{className:"g",d:"M40.944,8.717a.387.387,0,1,1-.387-.387.388.388,0,0,1,.387.387Z",transform:"translate(-31.816 41.953)",key:12}),r.createElement("path",{className:"h",d:"M130.887,52.5H130.5v3.677h.387c-.025,0,0-.035,0,0V52.5c0,.035-.025,0,0,0Z",transform:"translate(-104.665 6.331)",key:13}),r.createElement("path",{className:"i",d:"M-2.806,27.33h0c-.13,0-.194.035-.194,0v1.742c0-.035.064,0,.194,0h0V27.33Z",transform:"translate(3 26.63)",key:14}),r.createElement("path",{className:"i",d:"M-2.806,52H-3c.045,0,0,.035,0,0v3.677c0-.035.045,0,0,0h.194V52Z",transform:"translate(3 6.734)",key:15}),r.createElement("path",{className:"i",d:"M-2.806,77H-3c.045,0,0,.035,0,0v3.677c0-.035.045,0,0,0h.194V77Z",transform:"translate(3 -13.428)",key:16})]),r.createElement("g",{transform:"translate(253.524 447.613)",key:1},[r.createElement("path",{className:"j",d:"M2.982,4.465A17.458,17.458,0,0,1,9.228,3.37a.776.776,0,0,1,.78.772h0V5.506s-.114.352.364.215a.746.746,0,0,1,.129-.029c.715-.1,3.758-.418,3.758-.418s.179.06.179-.317V2.986s-.031-.179.334-.226A25.127,25.127,0,0,1,21.7,2.734c.089.01.306-.032.269.478V4.985s-.109.33.4.3c.04,0,.078,0,.118,0,.691.064,3.65.419,3.65.419s.309.125.262-.293V3.38s-.009-.182.266-.164A32.889,32.889,0,0,1,33.73,4.44a.212.212,0,0,1,.17.236v13.2s-.334,10.6-9.007,17.65a17.767,17.767,0,0,1-6.635,3.75.769.769,0,0,1-.466-.037A25.17,25.17,0,0,1,4.475,26.524C4.018,25.388,2.5,21.817,2.5,19.781V5.183A.765.765,0,0,1,2.982,4.465Z",transform:"translate(-2.5 -2.501)",key:0}),r.createElement("path",{className:"j",d:"M54.534,56.782V51.025a.8.8,0,0,0-.617-.746,54.758,54.758,0,0,0-10.6-1.039h-.232A56.638,56.638,0,0,0,32.417,50.3a.794.794,0,0,0-.617.745v5.781c0,.456.012,7.641,4.7,13.012a27.463,27.463,0,0,0,6.224,5.476.953.953,0,0,0,.9,0,27.428,27.428,0,0,0,6.215-5.476C54.642,64.326,54.536,56.869,54.534,56.782Z",transform:"translate(-27.464 -42.389)",key:1})]),r.createElement("g",{transform:"translate(189.856 486.12)",key:2},[r.createElement("path",{className:"k",d:"M2.667,3.184A6.075,6.075,0,0,1,4.841,2.8a.27.27,0,0,1,.271.269h0v.474s-.04.122.127.075a.26.26,0,0,1,.045-.01c.249-.033,1.308-.145,1.308-.145s.062.021.062-.11V2.67s-.011-.062.116-.079a8.744,8.744,0,0,1,2.412-.009c.031,0,.107-.011.094.166v.617s-.038.115.14.106h.041c.24.022,1.27.146,1.27.146s.108.043.091-.1V2.807s0-.063.093-.057a11.444,11.444,0,0,1,2.456.426.074.074,0,0,1,.059.082V7.85a8.96,8.96,0,0,1-3.134,6.142,6.182,6.182,0,0,1-2.309,1.3.268.268,0,0,1-.162-.013A8.759,8.759,0,0,1,3.187,10.86,8.255,8.255,0,0,1,2.5,8.514V3.434A.266.266,0,0,1,2.667,3.184Z",transform:"translate(-2.5 -2.501)",key:0}),r.createElement("path",{className:"k",d:"M39.711,51.864v-2a.277.277,0,0,0-.215-.26,19.055,19.055,0,0,0-3.689-.362h-.081a19.709,19.709,0,0,0-3.712.369.276.276,0,0,0-.215.259V51.88a7.41,7.41,0,0,0,1.634,4.528A9.556,9.556,0,0,0,35.6,58.314a.332.332,0,0,0,.314,0,9.544,9.544,0,0,0,2.163-1.906A7.439,7.439,0,0,0,39.711,51.864Z",transform:"translate(-30.291 -46.856)",key:1})])])])}s.defaultProps={viewBox:"0 0 176.802 102.47"},e.exports=s,s.default=s},11394:(e,t,a)=>{var r=a(99196);function s(e){return r.createElement("svg",e,[r.createElement("defs",{key:0},r.createElement("style",null,".a{fill:#fff;}.b{fill:#e1f2fc;stroke:#707070;}.c{fill:#0083e3;}.d{stroke:none;}.e{fill:none;}")),r.createElement("g",{transform:"translate(-1056 -520.655)",key:1},[r.createElement("rect",{className:"a",width:"39.001",height:"20.501",transform:"translate(1125.858 576.267) rotate(45)",key:0}),r.createElement("rect",{className:"a",width:"37.501",height:"20.501",transform:"translate(1073.167 523.325) rotate(45)",key:1}),r.createElement("g",{className:"b",transform:"translate(1063.11 597.823) rotate(-45)",key:2},[r.createElement("rect",{className:"d",width:"99.254",height:"21.001",key:0}),r.createElement("rect",{className:"e",x:"0.5",y:"0.5",width:"98.254",height:"20.001",key:1})]),r.createElement("path",{className:"c",d:"M318.38,317.685h0a5.134,5.134,0,1,0-7.26,0A5.138,5.138,0,0,0,318.38,317.685Zm-5.663-1.6a2.875,2.875,0,1,1,4.068,0A2.858,2.858,0,0,1,312.718,316.088Z",transform:"translate(823.787 288.967)",key:3}),r.createElement("path",{className:"c",d:"M95.132,23.558s0,0,0,0l.007-.007.31-.31-.007-.008A12.607,12.607,0,0,0,77.626,5.415l-.007-.007-.31.31-.008.008a.009.009,0,0,0,0,.005L3.213,79.81l.03.03a1.733,1.733,0,0,0-.785,1.233L.021,98.869a1.752,1.752,0,0,0,1.735,1.988,1.893,1.893,0,0,0,.238-.015l17.8-2.438a1.749,1.749,0,0,0,1.233-.785l.03.03ZM86.217,5.528a9.112,9.112,0,0,1,7.563,14.2L81.131,7.078A9.044,9.044,0,0,1,86.217,5.528Zm-8.6,4.828L90.5,23.238,21.047,92.693,16.2,87.846,71.951,32.094l-3.338-3.338L12.861,84.508l-4.7-4.7ZM3.8,97.059,5.809,82.4,18.454,95.051Z",transform:"translate(1055.996 519.131)",key:4}),r.createElement("path",{className:"c",d:"M28.5,44.631l3.193-3.193L6.135,15.882,16.562,5.455,21.508,10.4,17.92,13.985l2.833,2.833,3.585-3.588,2.883,2.883L23.635,19.7l2.833,2.833,3.588-3.588,2.883,2.883L27.63,27.133l2.833,2.833,5.305-5.305,3.515,3.515L35.7,31.763,38.528,34.6l3.588-3.588,0,0,3.193-3.193L18.16.664a2.256,2.256,0,0,0-3.193,0L1.344,14.285a2.256,2.256,0,0,0,0,3.193Z",transform:"translate(1055.487 520.652)",key:5}),r.createElement("path",{className:"c",d:"M261.994,244.481c-.04-.04-.082-.08-.125-.117L233.453,215.95l-8.5,8.5,2.825,2.825,5.308-5.308L257.2,246.081l-10.428,10.428L219.833,229.57l-3.193,3.2L245.176,261.3a2.256,2.256,0,0,0,3.193,0l13.623-13.621s0,0,.005-.005A2.263,2.263,0,0,0,261.994,244.481Z",transform:"translate(893.521 358.693)",key:6})])])}s.defaultProps={viewBox:"0 0 100.176 100"},e.exports=s,s.default=s},10906:e=>{e.exports=function(){return this.itsec.dashboard.api}()},31600:e=>{e.exports=function(){return this.itsec.packages.data}()},82839:e=>{e.exports=function(){return this.wp.a11y}()},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},9576:e=>{e.exports=function(){return this.wp.compose}()},48015:e=>{e.exports=function(){return this.wp.data}()},82521:e=>{e.exports=function(){return this.wp.date}()},25993:e=>{e.exports=function(){return this.wp.domReady}()},6293:e=>{e.exports=function(){return this.wp.element}()},54761:e=>{e.exports=function(){return this.wp.hooks}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},81019:e=>{e.exports=function(){return this.wp.keycodes}()},25703:e=>{e.exports=function(){return this.wp.notices}()},3571:e=>{e.exports=function(){return this.wp.plugins}()},14776:e=>{e.exports=function(){return this.wp.primitives}()},73470:e=>{e.exports=function(){return this.wp.url}()},99196:e=>{"use strict";e.exports=window.React},91850:e=>{"use strict";e.exports=window.ReactDOM},92819:e=>{"use strict";e.exports=window.lodash}},e=>{e.O(0,[271,387,655,363,96,639,904,991,144,783],(()=>(17897,e(e.s=17897))));var t=e.O();((window.itsec=window.itsec||{}).dashboard=window.itsec.dashboard||{}).dashboard=t}]);