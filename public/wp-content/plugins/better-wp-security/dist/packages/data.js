(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[118],{90583:(e,t,s)=>{"use strict";s.r(t),s.d(t,{BANS_STORE_NAME:()=>Re,CORE_STORE_NAME:()=>ks,HELP_STORE_NAME:()=>xe,MODULES_STORE_NAME:()=>Xt,apiFetch:()=>h,apiFetchBatch:()=>C,apiFetchResult:()=>_,awaitPromise:()=>b,controls:()=>U,createNotice:()=>D,dispatch:()=>A,fetch:()=>v,parseFetchResponse:()=>R,select:()=>T,updateSettings:()=>N});var r={};s.r(r),s.d(r,{FAILED_CREATE_BAN:()=>re,FAILED_DELETE_BAN:()=>ce,FAILED_QUERY:()=>ee,FAILED_UPDATE_BAN:()=>ue,FINISH_CREATE_BAN:()=>se,FINISH_DELETE_BAN:()=>de,FINISH_QUERY:()=>z,FINISH_UPDATE_BAN:()=>oe,RECEIVE_BAN:()=>ie,RECEIVE_QUERY:()=>J,START_CREATE_BAN:()=>te,START_DELETE_BAN:()=>le,START_QUERY:()=>X,START_UPDATE_BAN:()=>ne,createBan:()=>Y,deleteBan:()=>K,failedCreateBan:()=>H,failedDeleteBan:()=>W,failedUpdateBan:()=>k,fetchQueryNextPage:()=>q,finishCreateBan:()=>V,finishDeleteBan:()=>$,finishUpdateBan:()=>Q,path:()=>P,query:()=>x,receiveBan:()=>w,receiveQuery:()=>L,refreshQuery:()=>O,startCreateBan:()=>B,startDeleteBan:()=>j,startUpdateBan:()=>G,updateBan:()=>Z});var i={};s.r(i),s.d(i,{getBan:()=>Se,getBans:()=>ye,getQueryHeader:()=>me,getQueryHeaderLink:()=>ge,getQueryHeaderLinks:()=>fe,getQueryParams:()=>pe,getQueryResults:()=>Ee,isDeleting:()=>he,isQuerying:()=>_e,isUpdating:()=>Ie});var n={};s.r(n),s.d(n,{getBans:()=>Te});var o={};s.r(o),s.d(o,{RECEIVE_HELP:()=>De,enableHelp:()=>Ne,fetchHelp:()=>be});var u={};s.r(u),s.d(u,{getHelp:()=>Me,isEnabled:()=>Ue});var l={};s.r(l),s.d(l,{getHelp:()=>Fe});var d={};s.r(d),s.d(d,{EDIT_MODULE:()=>nt,EDIT_SETTING:()=>yt,EDIT_SETTINGS:()=>at,FAILED_SAVING_MODULES:()=>lt,FAILED_SAVING_SETTINGS:()=>mt,FINISH_SAVING_MODULES:()=>dt,FINISH_SAVING_SETTINGS:()=>pt,RECEIVE_MODULE:()=>it,RECEIVE_MODULES:()=>rt,RECEIVE_SETTINGS:()=>ct,RESET_MODULE_EDITS:()=>ot,RESET_SETTING_EDIT:()=>Et,RESET_SETTING_EDITS:()=>gt,START_SAVING_MODULES:()=>ut,START_SAVING_SETTINGS:()=>ft,activateModule:()=>Qe,deactivateModule:()=>je,editModule:()=>Ve,editSetting:()=>Ye,editSettings:()=>$e,fetchModules:()=>ze,receiveModule:()=>tt,receiveModules:()=>et,receiveSettings:()=>st,resetModuleEdits:()=>ke,resetSettingEdits:()=>Ze,saveModules:()=>Ge,saveSettings:()=>Ke,setModulesStatus:()=>We,updateSettings:()=>Je});var c={};s.r(c),s.d(c,{__unstableGetAllEditedSettings:()=>wt,__unstableGetAllSettings:()=>Lt,areSettingsDirty:()=>Ot,getActiveModules:()=>_t,getDirtyModules:()=>bt,getDirtySettings:()=>xt,getEditedModule:()=>ht,getEditedModules:()=>It,getEditedSetting:()=>Ft,getEditedSettings:()=>Ut,getError:()=>qt,getModule:()=>Tt,getModuleEdits:()=>vt,getModules:()=>St,getSetting:()=>Ct,getSettingEdits:()=>Mt,getSettingSchema:()=>Bt,getSettings:()=>Dt,isActive:()=>At,isModuleDirty:()=>Nt,isSavingModule:()=>Rt,isSavingSettings:()=>Pt});var a={};s.r(a),s.d(a,{__unstableGetAllEditedSettings:()=>Qt,__unstableGetAllSettings:()=>kt,getActiveModules:()=>Yt,getEditedModule:()=>$t,getEditedModules:()=>jt,getEditedSetting:()=>Jt,getEditedSettings:()=>Kt,getModule:()=>Wt,getModules:()=>Vt,getSetting:()=>Zt,getSettings:()=>Gt});var y={};s.r(y),s.d(y,{getActorTypes:()=>ls,getActors:()=>ds,getBatchMaxItems:()=>ys,getCurrentUser:()=>es,getCurrentUserId:()=>ts,getFeatureFlags:()=>as,getIndex:()=>is,getRequirementsInfo:()=>us,getRoles:()=>os,getSchema:()=>ns,getSiteInfo:()=>cs,getUser:()=>zt,isSavingCurrentUser:()=>rs,isSavingUser:()=>ss});var E={};s.r(E),s.d(E,{LOAD_INITIAL_FEATURE_FLAGS:()=>Ms,RECEIVE_ACTORS:()=>Ds,RECEIVE_ACTOR_TYPES:()=>Ns,RECEIVE_BATCH_MAX_ITEMS:()=>Us,RECEIVE_CURRENT_USER_ID:()=>bs,RECEIVE_INDEX:()=>vs,RECEIVE_SITE_INFO:()=>Cs,RECEIVE_USER:()=>Rs,__unstableLoadInitialFeatureFlags:()=>Ts,fetchIndex:()=>Es,receiveActorTypes:()=>Is,receiveActors:()=>hs,receiveBatchMaxItems:()=>As,receiveCurrentUserId:()=>Ss,receiveIndex:()=>gs,receiveSiteInfo:()=>_s,receiveUser:()=>ps,saveCurrentUser:()=>fs,saveUser:()=>ms});var g={};s.r(g),s.d(g,{getActorTypes:()=>ws,getActors:()=>Bs,getBatchMaxItems:()=>Vs,getCurrentUser:()=>Ls,getIndex:()=>Fs,getRequirementsInfo:()=>Os,getRoles:()=>xs,getSchema:()=>Ps,getSiteInfo:()=>Hs,getUser:()=>qs});var f=s(48015),m=s(92819),p=s(87514),S=s.n(p),I=s(31511);function h(e){return{type:"API_FETCH",request:e}}function _(e){return{type:"API_FETCH_RESULT",request:e}}function T(e,t){for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];return{type:"SELECT",storeKey:e,selectorName:t,args:r}}function A(e,t){for(var s=arguments.length,r=new Array(s>2?s-2:0),i=2;i<s;i++)r[i-2]=arguments[i];return{type:"DISPATCH",storeKey:e,actionName:t,args:r}}function v(e,t){return{type:"FETCH",request:e,init:t}}function R(e){return{type:"PARSE_FETCH_RESPONSE",response:e}}function b(e,t){return{type:"AWAIT_PROMISE",promise:e,delay:t}}function N(e,t){return{type:"UPDATE_SETTINGS",module:e,settings:t}}function D(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"info",t=arguments.length>1?arguments[1]:void 0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:"CREATE_NOTICE",status:e,content:t,options:{context:"ithemes-security",...s}}}function C(e){return{type:"API_FETCH_BATCH",batch:e}}const M={AWAIT_PROMISE:e=>{let{promise:t,delay:s}=e;return s?Promise.all([t,(r=s,new Promise((e=>setTimeout(e,r))))]):t;var r},API_FETCH(e){let{request:t}=e;return S()(t).catch(I.xJ)},API_FETCH_RESULT(e){let{request:t}=e;return S()({...t,parse:!1}).then(I.x4.fromResponse).catch(I.xJ).catch((e=>e.getResponse?I.x4.fromResponse(e.getResponse()):new I.x4(I.x4.ERROR,new I.PN("unknown_error","Unknown error"))))},SELECT(e){let{storeKey:t,selectorName:s,args:r}=e;const i=(0,f.select)(t)[s];return i.hasResolver?(e=>{let{storeKey:t,selectorName:s,args:r}=e;return new Promise((e=>{const i=()=>(0,f.select)("core/data").hasFinishedResolution(t,s,r),n=()=>(0,f.select)(t)[s].apply(null,r),o=n();if(i())return e(o);const u=(0,f.subscribe)((()=>{i()&&(u(),e(n()))}))}))})({storeKey:t,selectorName:s,args:r}):i(...r)},DISPATCH(e){let{storeKey:t,actionName:s,args:r}=e;return(0,f.dispatch)(t)[s](...r)},PARSE_FETCH_RESPONSE:async function(e){let{response:t}=e;return await t.json()},FETCH(e){let{request:t,init:s}=e;return window.fetch(t,s)},UPDATE_SETTINGS:(0,f.createRegistryControl)((e=>t=>{let{module:s,settings:r}=t;return e.dispatch("ithemes-security/modules").updateSettings(s,r)})),CREATE_NOTICE(e){let{status:t,content:s,options:r}=e;r.autoDismiss&&(r.id=r.id||(0,m.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>(0,f.dispatch)("core/notices").removeNotice(r.id,r.context)),r.autoDismiss)),(0,f.dispatch)("core/notices").createNotice(t,s,r)},API_FETCH_BATCH:(0,f.createRegistryControl)((e=>async t=>{let{batch:s}=t;const r=await e.resolveSelect(ks).getBatchMaxItems(),i=(0,m.chunk)(s,r||25),n=[],o=[];if(!i.length)return[];for(const e of i)try{const t=await M.API_FETCH({request:{path:"/batch/v1",method:"POST",data:{requests:e}}});o.push(...t.responses)}catch(t){n.push(t),o.push(...(0,m.times)(e.length,(0,m.constant)({body:t,status:500,headers:{}})))}if(n.length===i.length)throw n[0];return o}))},U=M;var F=s(73470);const P="/ithemes-security/v1/bans";function*x(e){let t,s,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};yield{type:X,queryId:e,queryParams:r};try{t=yield h({path:(0,F.addQueryArgs)(P,r),parse:!1}),s=yield R(t)}catch(t){return yield{type:ee,queryId:e,queryParams:r,error:t},t}return yield L(e,r.context||"view",t,s,"replace"),yield{type:z,queryId:e,queryParams:r,response:t},t}function*O(e){const t=yield T("ithemes-security/bans","getQueryParams",e);yield*x(e,t)}function*q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"append";const s=yield T("ithemes-security/bans","getQueryHeaderLink",e,"next");if(!s)return[];let r,i;yield{type:X,queryId:e};try{r=yield h({url:s.link,parse:!1}),i=yield R(r)}catch(t){return yield{type:ee,queryId:e,error:t},t}const n=(0,F.getQueryArg)(s.link,"context")||"view";return yield L(e,n,r,i,t),yield{type:z,queryId:e,response:r},r}function L(e,t,s,r,i){return{type:J,queryId:e,context:t,response:s,items:r,mode:i}}function w(e){return{type:ie,ban:e}}function B(e){return{type:te,ban:e}}function H(e,t){return{type:re,ban:e,error:t}}function V(e,t){return{type:se,ban:e,response:t}}function G(e,t){return{type:ne,self:e,ban:t}}function k(e,t){return{type:ue,self:e,error:t}}function Q(e,t){return{type:oe,self:e,response:t}}function j(e){return{type:le,self:e}}function W(e,t){return{type:ce,self:e,error:t}}function $(e){return{type:de,self:e}}function*Y(e,t){const s={method:"POST",data:t};let r;(0,F.isURL)(e)?s.url=e:s.path=`${P}/${e}`,yield B(t);try{r=yield h(s)}catch(e){return yield H(t,e),e}return yield V(t,r),yield w(r),r}function*Z(e,t){const s=(0,m.isObject)(e)?(0,I.AW)(e):e;let r;yield G(s,t);try{r=yield h({url:s,method:"PUT",data:t})}catch(e){return yield k(s,e),e}return yield Q(s,r),yield w(r),r}function*K(e){const t=(0,m.isObject)(e)?(0,I.AW)(e):e;yield j(t);try{yield h({url:t,method:"DELETE"})}catch(e){return yield W(t,e),e}return yield $(t),null}const J="RECEIVE_QUERY",X="START_QUERY",z="FINISH_QUERY",ee="FAILED_QUERY",te="START_CREATE_BAN",se="FINISH_CREATE_BAN",re="FAILED_CREATE_BAN",ie="RECEIVE_BAN",ne="START_UPDATE_BAN",oe="FINISH_UPDATE_BAN",ue="FAILED_UPDATE_BAN",le="START_DELETE_BAN",de="FINISH_DELETE_BAN",ce="FAILED_DELETE_BAN";var ae=s(28306);const ye=(0,f.createRegistrySelector)((e=>()=>e("ithemes-security/bans").getQueryResults("main"))),Ee=(0,ae.Z)(((e,t)=>{const s=(0,m.get)(e,["queries",t,"selves"],[]),r=e.bySelf,i=s.length,n=new Array(i);let o=-1;for(;++o<i;){const e=r[s[o]];e&&(n[o]=e.item)}return n}),((e,t)=>[e.queries[t],e.bySelf]));function ge(e,t,s){return(0,m.find)((0,m.get)(e,["queries",t,"links"],[]),{rel:s})}function fe(e,t,s){return(0,m.filter)((0,m.get)(e,["queries",t,"links"],[]),{rel:s})}function me(e,t,s){return(0,m.get)(e,["queries",t,"headers",s])}function pe(e,t){return(0,m.get)(e,["queryParams",t])}function Se(e,t){return e.bySelf[t]}function Ie(e,t){const s=(0,m.isObject)(t)?(0,I.AW)(t):t;return e.updating.includes(s)}function he(e,t){const s=(0,m.isObject)(t)?(0,I.AW)(t):t;return e.deleting.includes(s)}function _e(e,t){return e.querying.includes(t)}function*Te(){yield A("ithemes-security/bans","query","main",{per_page:100})}var Ae=s(38085);const ve={bySelf:{},queries:{},queryParams:{},querying:[],creating:[],updating:[],deleting:[]},Re="ithemes-security/bans";function*be(e){const t=`https://ithemes.com/wp-json/ithemes/v1/inline-help/itsec/${encodeURIComponent(e)}`,s=yield v(t,{credentials:"omit",referrer:"no-referrer"});if(!s.ok)return;if(s.status>=400)return;const r=yield R(s);yield{type:De,topic:e,help:r}}function*Ne(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];yield N("global",{enable_remote_help:e})}(0,f.registerStore)(Re,{controls:U,actions:r,selectors:i,resolvers:n,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J:return{...e,queries:{...e.queries,[t.queryId]:{selves:"replace"===t.mode?(0,m.map)(t.items,I.AW):[...(0,m.get)(e,["queries",t.queryId,"selves"],[]),...(0,m.map)(t.items,I.AW)],headers:(0,m.fromPairs)(Array.from(t.response.headers.entries())),links:(0,Ae.parse)(t.response.headers.get("link"),{extended:!0}).map((e=>({...e,rel:e.rel[0]})))}},bySelf:{...e.bySelf,...(0,m.fromPairs)(t.items.filter((s=>{const r=(0,I.AW)(s);return!e.bySelf[r]||"embed"===e.bySelf[r].context||e.bySelf[r].context===t.context})).map((e=>[(0,I.AW)(e),{context:t.context,item:e}])))}};case X:return{...e,querying:[...e.querying,t.queryId],queryParams:{...e.queryParams,[t.queryId]:t.queryParams||e.queryParams[t.queryId]}};case z:case ee:return{...e,querying:e.querying.filter((e=>e!==t.queryId))};case ie:return{...e,bySelf:{...e.bySelf,[(0,I.AW)(t.ban)]:{context:"edit",item:t.ban}}};case te:return{...e,creating:[...e.creating,t.ban]};case se:case re:return{...e,creating:e.creating.filter((e=>e!==t.ban))};case ne:return{...e,updating:[...e.updating,t.self]};case oe:case ue:return{...e,updating:e.updating.filter((e=>e!==t.self))};case le:return{...e,deleting:[...e.deleting,t.self],bySelf:(0,m.omit)(e.bySelf,[t.self])};case de:case ce:return{...e,deleting:e.deleting.filter((e=>e!==t.self))};default:return e}}});const De="RECEIVE_HELP",Ce=[];function Me(e,t){return e.byTopic[t]||Ce}const Ue=(0,f.createRegistrySelector)((e=>()=>e("ithemes-security/modules").getSettings("global")?.enable_remote_help));function*Fe(e){yield be(e)}const Pe={byTopic:{}},xe="ithemes-security/help",Oe=((0,f.registerStore)(xe,{controls:U,actions:o,selectors:u,resolvers:l,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,t=arguments.length>1?arguments[1]:void 0;return t.type===De?{...e,byTopic:{...e.byTopic,[t.topic]:t.help}}:e}}),e=>e instanceof Date),qe=e=>null!=e&&"object"==typeof e,Le=e=>qe(e)&&(e=>0===Object.keys(e).length)(e),we=(e,t)=>{if(e===t)return{};if(!qe(e)||!qe(t))return t;const s=e,r=t;return Oe(s)||Oe(r)?s.valueOf()==r.valueOf()?{}:r:Object.keys(r).reduce(((e,t)=>{if(((e,...t)=>Object.prototype.hasOwnProperty.call(e,...t))(s,t)){const i=we(s[t],r[t]);return!Le(i)||Oe(i)||!Le(s[t])&&Le(r[t])?(e[t]=i,e):e}return e}),{})},Be=we;var He=s(95122);function*Ve(e,t){const s=yield f.controls.select(Xt,"getModule",e);s?yield{type:nt,module:e,edit:Be(s,t)}:yield{type:nt,module:e,edit:t}}function*Ge(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e?e=yield f.controls.select(Xt,"getDirtyModules"):(0,m.isString)(e)&&(e=[e]),!e.length)return[];const t=[];for(const s of e){const e=yield f.controls.select(Xt,"getModuleEdits",s);t.push({method:"PUT",path:`/ithemes-security/v1/modules/${s}`,body:e})}let s;try{yield{type:ut,modules:e},s=yield C(t)}catch(t){return yield{type:lt,modules:e},yield D("error",t.message),t}const r=[],i={};for(let n=0;n<t.length;n++){const t=e[n],o=s[n];o.status>=400?i[t]=o.body:(r.push(t),yield tt(o.body))}return(0,m.isEmpty)(i)||(yield{type:lt,errors:i}),r.length&&(yield{type:dt,modules:r}),s}function*ke(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!0===e?e=yield f.controls.select(Xt,"getDirtyModules"):(0,m.isString)(e)&&(e=[e]),yield{type:ot,modules:e}}function*Qe(e){try{const t=yield Xe(e,"active");yield tt(t),yield{type:dt,modules:[e]},t.side_effects&&(yield ze())}catch(t){yield{type:lt,errors:{[e]:t}}}}function*je(e){try{const t=yield Xe(e,"inactive");yield tt(t),yield{type:dt,modules:[e]},t.side_effects&&(yield ze())}catch(t){yield{type:lt,errors:{[e]:t}}}}function*We(e){const t={requests:(0,m.map)(e,((e,t)=>({path:`/ithemes-security/v1/modules/${t}`,method:"PUT",body:{status:{selected:e}}})))},s=yield C(t);for(let e=0;e<s.length;e++){const t=s[e];t.status>=400?yield D("error",t.body.message):yield tt(t.body)}}function*$e(e,t){const s=yield f.controls.select(Xt,"getSettings",e);if(!s)return void(yield{type:at,module:e,edit:t});const r={};let i=!1;for(const e in t)t.hasOwnProperty(e)&&((0,m.isEqual)(t[e],s[e])||(r[e]=t[e],i=!0));i?yield{type:at,module:e,edit:r}:yield Ze(e)}function*Ye(e,t,s){const r=yield f.controls.select(Xt,"getSetting",e,t);(0,m.isEqual)(r,s)?yield{type:Et,module:e,setting:t}:yield{type:yt,module:e,setting:t,value:s}}function*Ze(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];!0===e?e=yield f.controls.select(Xt,"getDirtySettings"):(0,m.isString)(e)&&(e=[e]),yield{type:gt,modules:e}}function*Ke(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!0===e?e=yield f.controls.select(Xt,"getDirtySettings"):(0,m.isString)(e)&&(e=[e]),!e.length)return[];const t=[];for(const s of e){const e=yield f.controls.select(Xt,"getSettingEdits",s);t.push({method:"PATCH",path:`/ithemes-security/v1/settings/${s}`,body:e})}let s;try{yield{type:ft,modules:e},s=yield C(t)}catch(t){return yield{type:mt,modules:e},yield D("error",t.message),t}const r=[],i={};for(let n=0;n<t.length;n++){const t=e[n],o=s[n];o.status>=400?i[t]=o.body:(r.push(t),yield st(t,o.body))}return(0,m.isEmpty)(i)||(yield{type:mt,errors:i}),r.length&&(yield D("success",(0,He.__)("Saved settings.","better-wp-security"),{type:"snackbar"}),yield{type:pt,modules:r}),s}function*Je(e,t){let s;yield{type:ft,modules:[e]};try{s=yield h({path:`/ithemes-security/v1/settings/${e}`,method:"PATCH",data:t}),yield st(e,s)}catch(t){return yield{type:mt,errors:{[e]:t}},t}return yield{type:pt,modules:[e]},s}function Xe(e,t){return h({method:"PUT",path:`/ithemes-security/v1/modules/${e}`,data:{status:{selected:t}}})}function*ze(){const e=yield h({path:"/ithemes-security/v1/modules?context=edit&_embed=1"});yield et(e)}function et(e){return{type:rt,modules:e}}function tt(e){return{type:it,module:e}}function st(e,t){return{type:ct,module:e,settings:t}}const rt="RECEIVE_MODULES",it="RECEIVE_MODULE",nt="EDIT_MODULE",ot="RESET_MODULE_EDITS",ut="START_SAVING_MODULES",lt="FAILED_SAVING_MODULES",dt="FINISH_SAVING_MODULES",ct="RECEIVE_SETTINGS",at="EDIT_SETTINGS",yt="EDIT_SETTING",Et="RESET_SETTING_EDIT",gt="RESET_SETTING_EDITS",ft="START_SAVING_SETTINGS",mt="FAILED_SAVING_SETTINGS",pt="FINISH_SAVING_SETTINGS";function St(e){return e.modules}const It=(0,ae.Z)((e=>e.modules.map((t=>({...t,...e.moduleEdits[t.id]||{}})))),(e=>[e.modules,e.moduleEdits])),ht=(0,ae.Z)(((e,t)=>({...e.modules[t]||{},...e.moduleEdits[t]||{}})),((e,t)=>[e.modules[t],e.moduleEdits[t]])),_t=(0,ae.Z)((e=>e.modules.filter((e=>"active"===e.status.selected)).map((e=>e.id))),(e=>e.modules));function Tt(e,t){return e.modules.find((e=>e.id===t))}function At(e,t){return"active"===Tt(e,t)?.status.selected}function vt(e,t){return e.moduleEdits[t]}function Rt(e,t){return e.savingModules.includes(t)}function bt(e){return Object.keys(e.moduleEdits)}function Nt(e,t){return!!e.moduleEdits[t]}function Dt(e,t){var s;return null!==(s=e.settings[t])&&void 0!==s?s:{}}function Ct(e,t,s){return e.settings[t]?.[s]}function Mt(e,t){return e.settingEdits[t]}const Ut=(0,ae.Z)(((e,t)=>({...e.settings[t]||{},...e.settingEdits[t]||{}})),((e,t)=>[e.settings[t],e.settingEdits[t]]));function Ft(e,t,s){return e.settingEdits[t]?.[s]||e.settings[t]?.[s]}function Pt(e,t){return e.savingSettings.includes(t)}function xt(e){return Object.keys(e.settingEdits)}function Ot(e,t){return e.settingEdits[t]&&!(0,m.isEmpty)(e.settingEdits[t])}function qt(e,t){return e.errors[t]}function Lt(e){return e.settings}const wt=(0,ae.Z)((e=>(0,m.reduce)(e.settings,((t,s,r)=>(t[r]={...s,...e.settingEdits[r]||{}},t)),{})),(e=>[e.settings,e.settingEdits]));function Bt(e,t,s){return Tt(e,t)?.settings?.schema.properties[s]}const Ht={modules:[],moduleEdits:{},savingModules:[],settings:{},settingEdits:{},savingSettings:[],errors:{}},Vt={*fulfill(){yield ze()},isFulfilled:e=>e.modules.length>0},Gt={*fulfill(e){const t=yield h({path:`/ithemes-security/v1/settings/${e}`});yield st(e,t)},isFulfilled:(e,t)=>e.settings.hasOwnProperty(t)},kt={*fulfill(){yield f.controls.resolveSelect(Xt,"getModules")},isFulfilled:e=>!(0,m.isEmpty)(e.settings)};function*Qt(){yield f.controls.resolveSelect(Xt,"__unstableGetAllSettings")}function*jt(){yield f.controls.resolveSelect(Xt,"getModules")}const Wt={*fulfill(){yield f.controls.resolveSelect(Xt,"getModules")},isFulfilled:(e,t)=>e.modules.includes((e=>e.id===t))};function*$t(){yield f.controls.resolveSelect(Xt,"getModules")}function*Yt(){yield f.controls.resolveSelect(Xt,"getModules")}function*Zt(e){yield f.controls.resolveSelect(Xt,"getSettings",e)}function*Kt(e){yield f.controls.resolveSelect(Xt,"getSettings",e)}function*Jt(e){yield f.controls.resolveSelect(Xt,"getSettings",e)}const Xt="ithemes-security/modules",zt=((0,f.registerStore)(Xt,{controls:U,actions:d,selectors:c,resolvers:a,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case rt:return{...e,modules:[...t.modules],settings:{...e.settings,...t.modules.reduce(((e,t)=>{const s=(0,m.get)(t,["_embedded","ithemes-security:settings",0]);return s?{...e,[t.id]:s}:e}),{})}};case it:return{...e,modules:e.modules.map((e=>e.id===t.module.id?t.module:e)),settings:{...e.settings,[t.module.id]:(0,m.get)(t.module,["_embedded","ithemes-security:settings",0],e.settings[t.module.id])}};case nt:return{...e,moduleEdits:{...e.moduleEdits,[t.module]:t.edit}};case ot:return{...e,moduleEdits:(0,m.omit)(e.moduleEdits,t.modules)};case ut:return{...e,savingModules:[...e.savingModules,...t.modules]};case dt:return{...e,savingModules:e.savingModules.filter((e=>!t.modules.includes(e))),moduleEdits:(0,m.omit)(e.moduleEdits,t.modules),errors:(0,m.omit)(e.errors,t.modules)};case lt:return{...e,savingModules:(0,m.without)(e.savingModules,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};case ct:return{...e,settings:{...e.settings,[t.module]:t.settings}};case at:return{...e,settingEdits:{...e.settingEdits,[t.module]:t.edit}};case yt:return{...e,settingEdits:{...e.settingEdits,[t.module]:{...e.settingEdits[t.module]||{},[t.setting]:t.value}}};case Et:return{...e,settingEdits:{...e.settingEdits,[t.module]:(0,m.omit)(e.settingEdits[t.module]||{},t.setting)}};case gt:return{...e,settingEdits:(0,m.omit)(e.settingEdits,t.modules)};case ft:return{...e,savingSettings:[...e.savingSettings,...t.modules]};case pt:return{...e,savingSettings:e.savingSettings.filter((e=>!t.modules.includes(e))),settingEdits:(0,m.omit)(e.settingEdits,t.modules),errors:(0,m.omit)(e.errors,t.modules)};case mt:return{...e,savingSettings:(0,m.without)(e.savingSettings,...Object.keys(t.errors||{}),...t.modules||[]),errors:{...e.errors,...t.errors}};default:return e}},persist:["moduleEdits","settingEdits"]}),(0,ae.Z)(((e,t)=>e.users.optimisticEdits[t]?(0,m.merge)((0,m.cloneDeep)(e.users.byId[t]),e.users.optimisticEdits[t]):e.users.byId[t]),((e,t)=>[e.users.byId[t],e.users.optimisticEdits[t]])));function es(e){return zt(e,ts(e))}function ts(e){return e.users.currentId}function ss(e,t){return e.users.saving.includes(t)}function rs(e){return ss(e,e.users.currentId)}function is(e){return e.index}function ns(e,t){const s=e.index;if(!s)return null;for(const e in s.routes){if(!s.routes.hasOwnProperty(e))continue;const r=s.routes[e].schema;if(r&&r.title===t)return r}return null}function os(e){return e.index?.roles||null}function us(e){return e.index?.requirements_info||null}function ls(e){return e.actors.types}function ds(e,t){return e.actors.byType[t]}function cs(e){return e.siteInfo}const as=(0,f.createRegistrySelector)((e=>t=>e(Xt).getSetting("feature-flags","enabled")||t.featureFlags));function ys(e){return e.batchMaxItems}function*Es(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t="/ithemes-security/v1?context=help";e&&(t+="&_="+Date.now());const s=yield h({path:t});return yield gs(s),s}function gs(e){return{type:vs,index:e}}function*fs(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];yield*ms("me",e,t)}function*ms(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=yield T("ithemes-security/core","getCurrentUserId");"me"===e&&(e=r);const i=`/wp/v2/users/${e===r?"me":e}`;yield{type:"START_SAVING_USER",id:e,data:t,optimistic:s};try{const s=yield h({method:"PUT",path:i,data:t});yield ps(s),yield{type:"FINISH_SAVING_USER",id:e,user:s}}catch(t){yield{type:"FAILED_SAVING_USER",id:e,error:t}}}function ps(e){return{type:Rs,user:e}}function Ss(e){return{type:bs,userId:e}}function Is(e){return{type:Ns,types:e}}function hs(e,t){return{type:Ds,actorType:e,actors:t}}function _s(e){return{type:Cs,siteInfo:e}}function Ts(e){return{type:Ms,flags:e}}function As(e){return{type:Us,maxItems:e}}const vs="RECEIVE_INDEX",Rs="RECEIVE_USER",bs="RECEIVE_CURRENT_USER_ID",Ns="RECEIVE_ACTOR_TYPES",Ds="RECEIVE_ACTORS",Cs="RECEIVE_SITE_INFO",Ms="LOAD_INITIAL_FEATURE_FLAGS",Us="RECEIVE_BATCH_MAX_ITEMS";function*Fs(){const e=yield h({path:"/ithemes-security/v1?context=help"});yield gs(e)}const Ps={*fulfill(){yield f.controls.resolveSelect("ithemes-security/core","getIndex")},isFulfilled:e=>!!e.index},xs={*fulfill(){yield f.controls.resolveSelect("ithemes-security/core","getIndex")},isFulfilled:e=>!!e.index},Os={*fulfill(){yield f.controls.resolveSelect("ithemes-security/core","getIndex")},isFulfilled:e=>!!e.index},qs={*fulfill(e){const t=yield T("ithemes-security/core","getCurrentUserId"),s=yield h({path:`/wp/v2/users/${e===t?"me":e}?context=edit`});yield ps(s)},isFulfilled:(e,t)=>!!e.users.byId[t]},Ls={*fulfill(){const e=yield h({path:"/wp/v2/users/me?context=edit"});yield ps(e),yield Ss(e.id)},isFulfilled:e=>e.users.currentId&&e.users.byId[e.users.currentId]},ws={*fulfill(){const e=yield h({path:"/ithemes-security/v1/actors?_embed=1"}),t=[];for(const s of e){const e=(0,m.get)(s,["_embedded","wp:items",0],[]);yield hs(s.slug,e),t.push({slug:s.slug,label:s.label})}yield Is(t)},isFulfilled:e=>e.actors.types.length>0},Bs={*fulfill(){yield T("ithemes-security/core","getActorTypes")},isFulfilled:(e,t)=>!!e.actors.byType[t]},Hs={*fulfill(){const e=yield h({path:"/?_fields=name,description,url,home,multisite"});yield _s(e)},isFulfilled:e=>!!e.siteInfo};function*Vs(){const e=yield h({path:"/batch/v1",method:"OPTIONS"});yield As(e.endpoints[0].args.requests.maxItems)}const Gs={users:{currentId:0,byId:{},saving:[],optimisticEdits:{}},index:null,actors:{types:[],byType:{}},siteInfo:null,featureFlags:[],batchMaxItems:0};s.p=window.itsecWebpackPublicPath;const ks="ithemes-security/core";(0,f.registerStore)(ks,{controls:U,selectors:y,resolvers:g,actions:E,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gs,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case vs:return{...e,index:t.index};case"START_SAVING_USER":return{...e,users:{...e.users,saving:[...e.users.saving,t.id],optimisticEdits:t.optimistic?{...e.users.optimisticEdits,[t.id]:t.data}:e.users.optimisticEdits}};case"FINISH_SAVING_USER":case"FAILED_SAVING_USER":return{...e,users:{...e.users,saving:e.users.saving.filter((e=>e!==t.id)),optimisticEdits:(0,m.omit)(e.users.optimisticEdits,t.id)}};case Rs:return{...e,users:{...e.users,byId:{...e.users.byId,[t.user.id]:t.user}}};case bs:return{...e,users:{...e.users,currentId:t.userId}};case Ns:return{...e,actors:{...e.actors,types:t.types}};case Ds:return{...e,actors:{...e.actors,byType:{...e.actors.byType,[t.actorType]:t.actors}}};case Cs:return{...e,siteInfo:t.siteInfo};case Ms:return{...e,featureFlags:t.flags};case Us:return{...e,batchMaxItems:t.maxItems};default:return e}}})},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},48015:e=>{e.exports=function(){return this.wp.data}()},6293:e=>{e.exports=function(){return this.wp.element}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},73470:e=>{e.exports=function(){return this.wp.url}()},92819:e=>{"use strict";e.exports=window.lodash}},e=>{e.O(0,[469],(()=>(90583,e(e.s=90583))));var t=e.O();((window.itsec=window.itsec||{}).packages=window.itsec.packages||{}).data=t}]);