(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[448],{88753:(e,t,a)=>{"use strict";a.r(t);var s=a(6293),r=a(95122),n=a(3571),c=a(48015),i=a(91991),l=a(94184),o=a.n(l),d=a(59588),u=a.n(d),m=a(82521),p=a(64893),h=a(9576),w=a(19144),E=a(1528);function _(e){let{card:t,config:a}=e;const[n,c]=(0,s.useState)(void 0);return(0,s.createElement)("div",{className:"itsec-card--type-malware-scan itsec-card--type-malware--scan-only"},(0,s.createElement)(E.CardHeader,null,(0,s.createElement)(E.CardHeaderTitle,{card:t,config:a})),(0,s.createElement)("section",{className:"itsec-card-malware-scan__description"},(0,s.createElement)("p",null,(0,s.createInterpolateElement)((0,r.__)("This <a>site scan is powered by iThemes</a>. We use several datapoints to check for known malware, blocklist status, website errors and out-of-date software. These datapoints are not 100% accurate, but we try our best to provide thorough results.","better-wp-security"),{a:(0,s.createElement)("a",{href:"https://help.ithemes.com/hc/en-us/articles/360046334433"})})),(0,s.createElement)("p",null,(0,r.__)("Enable Database Logging to see a history of completed Site Scans.","better-wp-security"))),(0,s.createElement)(E.CardFooterSchemaActions,{card:t,onComplete:(e,t)=>e.endsWith("/scan")&&c(t)}),n&&(0,s.createElement)(p.Modal,{title:(0,r.__)("Scan Results","better-wp-security"),onRequestClose:()=>c(void 0)},(0,s.createElement)(w.yR,{results:n,showSiteUrl:!1})))}const f=u()(((e,t)=>String(e).replace(/https?:\/\//,"")===String(t).replace(/https?:\/\//,"")));function g(e){let{card:t,config:a}=e;const n=(0,h.useInstanceId)(g),{siteInfo:i}=(0,c.useSelect)((e=>({siteInfo:e("ithemes-security/core").getSiteInfo()}))),[l,d]=(0,s.useState)(0),[u,_]=(0,s.useState)(void 0),[b,S]=(0,s.useState)(!1);return(0,s.createElement)("div",{className:"itsec-card--type-malware-scan"},(0,s.createElement)(E.CardHeader,null,(0,s.createElement)(E.CardHeaderTitle,{card:t,config:a}),(0,s.createElement)(E.CardHeaderDate,{card:t,config:a})),(0,s.createElement)("section",{className:"itsec-card-malware-scan__scans-section"},(0,s.createElement)("table",{className:"itsec-card-malware-scan__scans"},(0,s.createElement)("thead",null,(0,s.createElement)("tr",null,(0,s.createElement)("th",null,(0,r.__)("Time","better-wp-security")),(0,s.createElement)("th",null,(0,r.__)("Status","better-wp-security")),(0,s.createElement)("th",null,(0,s.createElement)("span",{className:"screen-reader-text"},(0,r.__)("Actions","better-wp-security"))))),(0,s.createElement)("tbody",null,t.data.scans.map((e=>{const t=e.id,a=e.status,c=e.description;return(0,s.createElement)("tr",{key:t},(0,s.createElement)("th",{scope:"row"},(0,m.dateI18n)("M d, Y g:i A",e.time)),(0,s.createElement)("td",null,(0,s.createElement)("span",{className:o()("itsec-card-malware-scan__scan-status",`itsec-card-malware-scan__scan-status--${a}`)},c)),(0,s.createElement)("td",null,(0,s.createElement)(p.Button,{variant:"link","aria-pressed":l===t,onClick:()=>d(t)},(0,r.__)("View","better-wp-security")),l===t&&(0,s.createElement)(p.Modal,{title:(0,r.sprintf)((0,r.__)("View Scan Details for %s","better-wp-security"),(0,m.dateI18n)("M d, Y g:i A",e.time)),onRequestClose:()=>{d(0),S(!1)}},(0,s.createElement)(w.yR,{results:e,showSiteUrl:!f(e.url,i?.url)}),(0,s.createElement)(p.Button,{className:"itsec-card-malware-scan__raw-details-toggle",variant:"link",onClick:()=>S(!b),"aria-expanded":b,"aria-controls":`itsec-card-malware-scan__raw-details--${n}`},b?(0,r.__)("Hide Raw Details","better-wp-security"):(0,r.__)("Show Raw Details","better-wp-security")),(0,s.createElement)("div",{id:`itsec-card-malware-scan__raw-details--${n}`,style:{visibility:b?"visible":"hidden"}},b&&(0,s.createElement)(w.s8,{json:e})))))}))))),(0,s.createElement)(E.CardFooterSchemaActions,{card:t,onComplete:(e,t)=>e.endsWith("/scan")&&_(t)}),u&&(0,s.createElement)(p.Modal,{title:(0,r.__)("Scan Results","better-wp-security"),onRequestClose:()=>_(void 0)},(0,s.createElement)(w.yR,{results:u,showSiteUrl:!1})))}const b={render:e=>"file"===e.card?.data.log_type?(0,s.createElement)(_,e):(0,s.createElement)(g,e)};function S(){const{registerCard:e}=(0,c.useDispatch)("ithemes-security/dashboard");return(0,i.eH)(S,(()=>e("malware-scan",b))),null}a.p=window.itsecWebpackPublicPath,(0,r.setLocaleData)({"":{}},"ithemes-security-pro"),(0,n.registerPlugin)("itsec-site-scanner-dashboard",{render:()=>(0,s.createElement)(S,null)})},1528:e=>{e.exports=function(){return this.itsec.dashboard.dashboard}()},31600:e=>{e.exports=function(){return this.itsec.packages.data}()},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},9576:e=>{e.exports=function(){return this.wp.compose}()},48015:e=>{e.exports=function(){return this.wp.data}()},82521:e=>{e.exports=function(){return this.wp.date}()},6293:e=>{e.exports=function(){return this.wp.element}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},81019:e=>{e.exports=function(){return this.wp.keycodes}()},3571:e=>{e.exports=function(){return this.wp.plugins}()},14776:e=>{e.exports=function(){return this.wp.primitives}()},73470:e=>{e.exports=function(){return this.wp.url}()},99196:e=>{"use strict";e.exports=window.React},91850:e=>{"use strict";e.exports=window.ReactDOM},92819:e=>{"use strict";e.exports=window.lodash}},e=>{e.O(0,[271,655,991,144],(()=>(88753,e(e.s=88753))));var t=e.O();((window.itsec=window.itsec||{})["site-scanner"]=window.itsec["site-scanner"]||{}).dashboard=t}]);