(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[662,155],{46385:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AdvancedNavigation:()=>Ee,AsideFill:()=>j,Breadcrumbs:()=>fe,ChildPages:()=>x,ErrorRenderer:()=>De,Help:()=>Re,HelpFill:()=>Ae,Logo:()=>$e,Main:()=>W,Navigation:()=>de,NavigationFill:()=>pe,ONBOARD_STORE_NAME:()=>Ft,Page:()=>C,PageHeader:()=>ve,PrimaryForm:()=>Ne,PrimaryFormSection:()=>Oe,PrimarySchemaForm:()=>we,PrimarySchemaFormActions:()=>xe,PrimarySchemaFormInputs:()=>Ce,SecureSiteEndFill:()=>lr,SelectableCard:()=>Se,Sidebar:()=>q,TOOLS_STORE_NAME:()=>mn,ToolFill:()=>Wn,Toolbar:()=>K,ToolbarFill:()=>z,history:()=>Lr,useBreadcrumbTrail:()=>_e,useConfigContext:()=>ne,useCurrentPage:()=>M,useHelpBreadcrumbTrail:()=>ye,useModuleSchemaValidator:()=>ae,useNavigateTo:()=>re,useNavigation:()=>A});var r={};n.r(r),n.d(r,{CLEAR_SITE_TYPE:()=>ot,CLEAR_VISITED_LOCATIONS:()=>ht,EDIT_ANSWER:()=>ct,RECEIVE_SITE_TYPE:()=>st,RECEIVE_SITE_TYPES:()=>it,RECORD_VISITED_LOCATION:()=>Et,REGISTER_COMPLETION_STEP:()=>pt,REGISTER_QUESTION_COMPONENT:()=>mt,SELECT_SITE_TYPE:()=>at,SET_COMPLETION_STEP:()=>gt,SET_ERROR:()=>dt,SET_IS_ANSWERING:()=>ut,answerQuestion:()=>Ge,applyAnswerResponse:()=>ze,clearSiteType:()=>je,clearVisitedLocations:()=>lt,completeOnboarding:()=>Ye,editAnswer:()=>Ve,receiveSiteType:()=>Je,receiveSiteTypes:()=>Xe,recordVisitedLocation:()=>rt,registerCompletionStep:()=>nt,registerQuestionComponent:()=>tt,repeatQuestion:()=>Qe,resetOnboarding:()=>Ke,selectSiteType:()=>Ze});var l={};n.r(l),n.d(l,{getAnswerRequest:()=>It,getAnswers:()=>bt,getCompletionStep:()=>xt,getCompletionSteps:()=>Lt,getEditedAnswer:()=>St,getLastError:()=>Ot,getLastVisitedLocation:()=>Ct,getNextQuestion:()=>vt,getQuestionComponent:()=>Tt,getRestoreSiteTypeRequest:()=>wt,getSelectedSiteType:()=>yt,getSelectedSiteTypeId:()=>_t,getSiteTypes:()=>ft,isAnswering:()=>Nt});var i={};n.r(i),n.d(i,{getNextQuestion:()=>At,getSelectedSiteType:()=>kt,getSiteTypes:()=>Mt});var s={};n.r(s),n.d(s,{FAILED_TOGGLE_TOOL:()=>jt,FINISH_TOGGLE_TOOL:()=>Vt,FINISH_TOOL:()=>Ht,RECEIVE_TOOLS:()=>qt,START_TOGGLE_TOOL:()=>Zt,START_TOOL:()=>Wt,fetchTools:()=>Pt,runTool:()=>Bt,toggleTool:()=>Ut});var a={};n.r(a),n.d(a,{getLastError:()=>an,getLastResult:()=>ln,getResolvedTools:()=>Yt,getRunning:()=>nn,getTool:()=>tn,getTools:()=>Xt,getToolsConfig:()=>en,isRunning:()=>rn,isUpdating:()=>sn});var o={};n.r(o),n.d(o,{getResolvedTools:()=>un,getTool:()=>dn,getTools:()=>cn});var c=n(6293),u=n(95122),d=n(25993),m=n.n(d),p=n(90071),g=n(17563),E=n(92819),h=n(16550),f=n(42236),_=n(35800),y=n(19296),b=n(64893),v=n(3571),S=n(78363),N=n(47069),O=n(9576),T=n(48015),L=n(31600);const I=(0,c.createContext)({pages:[],childPages:{},addPage:()=>{},removePage:()=>{},addChildPages:()=>{},removeChildPages:()=>{}});function w(e){let{children:t}=e;const[n,r]=(0,c.useState)([]),[l,i]=(0,c.useState)({}),s=(0,c.useCallback)((e=>{r((t=>{const n=t.findIndex((t=>t.id===e.id));let r;return-1===n?r=[...t,e]:(r=[...t],r[n]=e),(0,E.sortBy)(r,"priority")}))}),[]),a=(0,c.useCallback)((e=>{r((t=>t.filter((t=>t.id!==e))))}),[]),o=(0,c.useCallback)(((e,t)=>{i((n=>({...n,[e]:t})))})),u=(0,c.useCallback)((e=>{i((t=>(0,E.omit)(t,e)))}));return(0,c.createElement)(I.Provider,{value:{pages:n,childPages:l,addPage:s,removePage:a,addChildPages:o,removeChildPages:u}},t)}function C(e){let{id:t,title:n,icon:r,roots:l=["settings"],priority:i=90,location:s="primary",featureFlag:a,ignore:o,children:u}=e;const d=(0,c.useContext)(I);return(0,c.useEffect)((()=>(d.addPage({id:t,title:n,icon:r,roots:l,priority:i,location:s,featureFlag:a,ignore:o,render:u}),()=>{d.removePage(t)})),[t,n]),null}function x(e){const{pages:t}=e,n=(0,c.useContext)(I),r=(0,O.useInstanceId)(x,"");return(0,N.ZP)((()=>(n.addChildPages(r,t),()=>{n.removeChildPages(r)})),[t]),null}function R(){let{root:e,location:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{featureFlags:n}=(0,T.useSelect)((e=>({featureFlags:e(L.CORE_STORE_NAME).getFeatureFlags()})),[]),{root:r}=(0,h.UO)(),{pages:l}=(0,c.useContext)(I);return l.filter((l=>l.roots.includes(e||r)&&(!t||l.location===t)&&(!l.featureFlag||n.includes(l.featureFlag))))}function M(){const e=R(),{page:t}=(0,h.UO)();return e.find((e=>e.id===t))}function k(){const{childPages:e}=(0,c.useContext)(I);return(0,c.useMemo)((()=>(0,E.flatMap)(e)))}function A(e){const{root:t,page:n,child:r,tab:l}=(0,h.UO)(),i=function(e){const t=R();if(!t.length)return;if(!e)return t[0];const n=t.findIndex((t=>t.id===e));return t[n+1]?.id}(n),s=k().map((e=>e.id)),a=(0,h.k6)();let o,c;if(e){let i,s;for(let t=0;t<e.length;t++)if(e[t]===l){i=e[t-1],s=e[t+1];break}o=i&&`/${t}/${n}/${r}/${i}`,c=s&&`/${t}/${n}/${r}/${s}`}if((!o||!c)&&s){let e,l;for(let t=0;t<s.length;t++)if(s[t]===r){e=s[t-1],l=s[t+1];break}o=o||e&&`/${t}/${n}/${e}`,c=c||l&&`/${t}/${n}/${l}`}return!c&&i&&(c=`/${t}/${i}`),{previous:o,goPrevious(){o&&a.push((0,p.ob)(o))},next:c,goNext(){c&&a.push((0,p.ob)(c))},nextPage:i&&`/${t}/${i}`,goNextPage(){i&&a.push((0,p.ob)(`/${t}/${i}`))}}}I.displayName="PageRegistration";var F=n(73727),D=n(19144),$=n(87462),P=n(94184),B=n.n(P),U=n(91991);function q(e){let{className:t,logo:n="color",children:r}=e;const{root:l}=(0,h.UO)(),[i,s]=(0,c.useState)(!1);return(0,c.createElement)("div",(0,$.Z)({},(0,U.Zk)((()=>i&&s(!1))),{tabIndex:-1,className:B()("itsec-settings-sidebar",t,`itsec-settings-sidebar--root-${l}`,{"itsec-settings-sidebar--expanded":i})}),(0,c.createElement)("div",{className:"itsec-settings-sidebar__inner"},(0,c.createElement)(F.rU,{to:"/",className:"itsec-settings-sidebar__logo"},(0,c.createElement)($e,{style:n})),(0,c.createElement)(b.Button,{icon:"menu-alt2",label:(0,u.__)("Toggle Sidebar","better-wp-security"),className:"itsec-settings-sidebar__toggle",showTooltip:!1,isPressed:i,onClick:e=>{e.currentTarget.focus(),s(!i)},"aria-expanded":i}),r))}function W(e){let{children:t}=e;const n=M(),r=(0,c.useRef)(),l=(0,h.TH)(),{hash:i}=l;(0,c.useEffect)((()=>{r.current?.focus(),r.current?.ownerDocument.body.scrollTo(0,0)}),[l]);const[s,a]=(0,c.useState)(!1);return(0,c.createElement)("div",{className:"itsec-settings-main",ref:r,tabIndex:-1},(0,c.createElement)(K,null),(0,c.createElement)("div",{className:B()("itsec-settings-main__wrapper",{"itsec-settings-main__wrapper--has-aside":s})},(0,c.createElement)("main",{"aria-labelledby":"itsec-page-header",className:B()("itsec-settings-main__content",{[`itsec-page--${n?.id}`]:!!n})},(0,c.createElement)(_.ErrorBoundary,{FallbackComponent:De},(0,c.createElement)(Re,null),"#help"===i?(0,c.createElement)("div",{hidden:!0},t):t)),(0,c.createElement)(Z,null,(e=>(0,c.createElement)(H,{fills:e,setHasAside:a})))))}function H(e){let{fills:t,setHasAside:n}=e;return(0,c.useEffect)((()=>n(t.length>0)),[t]),t.length?(0,c.createElement)("aside",{className:"itsec-aside"},t):null}const{Slot:Z,Fill:j}=(0,b.createSlotFill)("Aside");var V=n(50460),G=n(31511);const{Slot:Q,Fill:z}=(0,b.createSlotFill)("Toolbar");function K(){const{root:e}=(0,h.UO)(),t=(0,G.bv)("dashboard"),n=(0,O.useMediaQuery)("(max-width: 600px)"),[r,l]=(0,c.useState)(!1),i=(0,O.useFocusOnMount)();return(0,c.createElement)("div",{role:"region","aria-label":(0,u.__)("Toolbar","better-wp-security"),className:"itsec-settings-toolbar"},"onboard"!==e&&!n&&(0,c.createElement)(V.o,null),(0,c.createElement)(b.Toolbar,{label:(0,u.__)("Toolbar Actions","better-wp-security")},"onboard"!==e&&(0,c.createElement)(React.Fragment,null,n&&(0,c.createElement)(React.Fragment,null,(0,c.createElement)(b.ToolbarButton,{icon:"search",text:(0,u.__)("Search","better-wp-security"),"aria-expanded":r,onClick:()=>l(!r)}),r&&(0,c.createElement)(b.Popover,{className:"itsec-settings-search__popover",expandOnMobile:!0,headerTitle:(0,u.__)("Search","better-wp-security"),focusOnMount:"container",onClose:()=>l(!1),onFocusOutside:()=>{}},(0,c.createElement)(V.o,{showResults:!0,ref:i,onPick:()=>l(!1)}))),(0,c.createElement)(b.ToolbarButton,{icon:"shield-alt",href:t,text:(0,u.__)("Dashboard","better-wp-security")})),(0,c.createElement)(Q,null)))}var Y=n(65096),X=n.n(Y),J=n(66e3),ee=n(54761);const te=(0,c.createContext)({serverType:"",installType:"",onboardComplete:!1});function ne(){return(0,c.useContext)(te)}function re(){const e=(0,h.k6)();return(0,c.useCallback)((function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"push";return e[n]((0,p.ob)(t))}),[e])}function le(){return le.instance||(le.instance=new(X())({schemaId:"id"}),le.instance.addMetaSchema(n(27171)),le.instance.addFormat("html",{type:"string",validate:()=>!0})),le.instance}function ie(e,t){const n=n=>((e,t,n)=>{const{serverType:r,installType:l,activeModules:i,settings:s,featureFlags:a}=n;if(e["server-type"]&&!e["server-type"].includes(r))return!1;if(e["install-type"]&&e["install-type"]!==l)return!1;if(e["active-modules"])for(const t of e["active-modules"])if(!i.includes(t))return!1;if(e["feature-flags"])for(const t of e["feature-flags"])if(!a?.includes(t))return!1;return!(e.settings&&!le().compile(e.settings)(s))&&(0,ee.applyFilters)("ithemes-security.settings.isConditionalSettingActive",!0,t,e,n)})(n,e,t),r=(t,l)=>l.properties?{...l,properties:Object.entries(l.properties).reduce(((l,i)=>{let[s,a]=i;const o=`${t}.${s}`;return e.settings.conditional[o]&&!n(e.settings.conditional[o])||(l[s]=r(o,a)),l}),{})}:l,l=Object.entries(e.settings.schema.properties).reduce(((t,l)=>{let[i,s]=l;return e.settings.interactive.includes(i)?(e.settings.conditional[i]&&!n(e.settings.conditional[i])||(t[i]=r(i,s)),t):t}),{});return{...e.settings.schema,properties:l}}function se(e,t){const{serverType:n,installType:r}=ne(),l=(0,T.useRegistry)(),{activeModules:i,featureFlags:s}=(0,T.useSelect)((e=>({activeModules:e(L.MODULES_STORE_NAME).getActiveModules(),featureFlags:e(L.CORE_STORE_NAME).getFeatureFlags()})),[]);return e?ie(e,{serverType:n,installType:r,activeModules:i,settings:t,registry:l,featureFlags:s}):null}function ae(e){const t=le(),{module:n,settings:r}=(0,T.useSelect)((t=>({module:t(L.MODULES_STORE_NAME).getModule(e),settings:t(L.MODULES_STORE_NAME).getEditedSettings(e)})),[e]),l=se(n,r),i=(0,c.useCallback)((()=>!0)),s=(0,c.useMemo)((()=>l?t.compile(l):i),[l]);return(0,c.useCallback)((()=>!!s(r)||{errors:s.errors,errorText:oe(s.errors,e,l)}),[s,r])}function oe(e,t,n){const r=[];for(const{message:l,schemaPath:i,dataPath:s}of e){let e=J.IB.create(i),a=e.parent(n);for(;a&&!a.title;)e=J.IB.create(e.path.slice(0,e.path.length-1)),a=e.parent(n);a?.title?r.push(`${a.title} ${l}.`):r.push(`${t}${s} ${l}.`)}return r}function ce(){return[{slug:"login",label:(0,u.__)("Login Security","better-wp-security")},{slug:"lockout",label:(0,u.__)("Lockouts","better-wp-security")},{slug:"site-check",label:(0,u.__)("Site Check","better-wp-security")},{slug:"utility",label:(0,u.__)("Utilities","better-wp-security")},{slug:"advanced",label:(0,u.__)("Advanced","better-wp-security")}]}function ue(){const{featureFlags:e,siteInfo:t,requirementsInfo:n}=(0,T.useSelect)((e=>({featureFlags:e(L.CORE_STORE_NAME).getFeatureFlags(),siteInfo:e(L.CORE_STORE_NAME).getSiteInfo(),requirementsInfo:e(L.CORE_STORE_NAME).getRequirementsInfo()})),[]);return(0,c.useCallback)(((r,l)=>{const i=new G.PN;if(!r.requirements)return i;const s=e=>e.validate===l||"activate"===l;if(r.requirements.ssl&&s(r.requirements.ssl)&&"https:"!==document.location.protocol&&i.add("ssl",(0,u.__)("Your site must support SSL.","better-wp-security"),r.requirements.ssl),r.requirements["feature-flags"]&&s(r.requirements["feature-flags"]))for(const t of r.requirements["feature-flags"].flags)e.includes(t)||i.add("feature-flags",(0,u.sprintf)((0,u.__)("The '%s' feature flag must be enabled.","better-wp-security"),t),r.requirements["feature-flags"]);if(r.requirements.multisite&&s(r.requirements.multisite)&&("enabled"===r.requirements.multisite.status&&!1===t?.multisite?i.add("multisite",(0,u.__)("Multisite must be enabled.","better-wp-security"),r.requirements.multisite):"disabled"===r.requirements.multisite.status&&!0===t?.multisite&&i.add("multisite",(0,u.__)("Multisite is not supported.","better-wp-security"),r.requirements.multisite)),r.requirements.server&&s(r.requirements.server)&&n){!r.requirements.server.php||(a=n.server.php,o=r.requirements.server.php,a.localeCompare(o,void 0,{numeric:!0,sensitivity:"base"})>=0)||i.add("server",(0,u.sprintf)((0,u.__)("You must be running PHP version %s or later.","better-wp-security"),r.requirements.server.php),r.requirements.server);const e=(r.requirements.server.extensions||[]).filter((e=>!n.server.extensions[e]));1===e.length?i.add("server",(0,u.sprintf)((0,u.__)("The %s PHP extension is required.","better-wp-security"),e[0]),r.requirements.server):e.length>0&&i.add("server",(0,u.sprintf)((0,u._n)("The following PHP extension is required: %l.","The following PHP extensions are required: %l.",e.length,"better-wp-security").replace("%l","%s"),e.join(", ")),r.requirements.server)}var a,o;return i}),[e,t,n])}function de(e){let{guided:t=!1,allowBack:n=!1,allowForward:r=!1,children:l}=e;const i=R({location:"primary"}),{root:s,page:a}=(0,h.UO)(),o=function(){const{url:e}=(0,h.$B)(),{pathname:t}=(0,h.TH)(),{pathname:n}=(0,p.ob)(e);return t.replace(n,"")}(),u=i.findIndex((e=>e.id===a));return(0,c.createElement)("nav",null,(0,c.createElement)("ul",{className:B()("itsec-nav",{"itsec-nav--guided":t})},i.map(((e,i)=>{let d=!t;(n&&i<=u||r&&i>=u)&&(d=!0);let m=a===e.id;m&&e.ignore&&e.ignore.find((e=>o.startsWith(e)))&&(m=!1);const p=t?"yes-alt":e.icon||"admin-generic";return(0,c.createElement)("li",{key:e.id,className:B()("itsec-nav__item",{"itsec-nav__item--active":m,"itsec-nav__item--completed":t&&i<u})},(0,c.createElement)("span",{className:"itsec-nav__item-title"},d?(0,c.createElement)(F.rU,{to:`/${s}/${e.id}`},(0,c.createElement)(b.Dashicon,{icon:p}),(0,c.createElement)("span",{className:"itsec-nav__item-title-text"},e.title)):(0,c.createElement)(React.Fragment,null,(0,c.createElement)(b.Dashicon,{icon:p}),(0,c.createElement)("span",{className:"itsec-nav__item-title-text"},e.title))),m?(0,c.createElement)(React.Fragment,null,l,(0,c.createElement)(me,{item:e})):null)}))))}function me(e){let{item:t}=e;const n=k();return(0,c.createElement)(ge,{fillProps:{item:t}},(e=>0===c.Children.count(e)&&0===n.length?null:(0,c.createElement)("ul",{className:"itsec-nav__children"},n.map((e=>{let{to:t,title:n,...r}=e;return(0,c.createElement)("li",{key:t},(0,c.createElement)(F.OL,(0,$.Z)({to:t},r),n))})),c.Children.map(e,((e,t)=>(0,c.createElement)("li",{key:t},e))))))}const{Fill:pe,Slot:ge}=(0,b.createSlotFill)("Navigation");function Ee(){const e=R({location:"advanced"}),{root:t}=(0,h.UO)();return(0,c.createElement)("ul",{className:"itsec-settings-advanced-nav"},(0,c.createElement)("li",null,(0,c.createElement)(F.OL,{to:`/${t}/configure/advanced`},(0,c.createElement)(b.Dashicon,{icon:"privacy"}),(0,c.createElement)("span",{className:"itsec-settings-advanced-nav__item-title"},(0,u.__)("Advanced","better-wp-security")))),e.map((e=>(0,c.createElement)("li",{key:e.id},(0,c.createElement)(F.OL,{to:`/${t}/${e.id}`},(0,c.createElement)(b.Dashicon,{icon:e.icon}),(0,c.createElement)("span",{className:"itsec-settings-advanced-nav__item-title"},e.title))))))}var he=n(81019);function fe(e){let{title:t,trail:n,match:r}=e;const l=_e(t,r);return n=n||l,n.length<=1?null:(0,c.createElement)("nav",{className:"itsec-breadcrumbs","aria-label":(0,u.__)("Breadcrumbs","better-wp-security")},(0,c.createElement)("ul",{className:"itsec-breadcrumbs"},n.map(((e,t)=>{const r=t===n.length-1?"page":null;return e.to?(0,c.createElement)("li",{key:t},(0,c.createElement)(F.rU,{to:e.to,"aria-current":r},e.title)):e.childPages?(0,c.createElement)("li",{key:t},(0,c.createElement)(be,{selected:e.selected,childPages:e.childPages,"aria-current":r})):null})).filter(E.identity)))}function _e(e,t){const n=(0,h.$B)(),r=(0,h.TH)(),{url:l,params:{root:i,page:s,child:a}}=t||n,o=R({root:i});let u=k();M()?.id!==s&&(u=[]);const d=o.find((e=>e.id===s)),m=u.find((e=>e.id===a));return(0,c.useMemo)((()=>{const t=[];return t.push({title:d.title,to:`/${i}/${d.id}`}),m&&u.length&&t.push({title:m.title,selected:m,childPages:u}),e&&e!==m?.title&&e!==d.title&&t.push({title:e,to:r.pathname.startsWith(l)?(0,p.Ep)(r):l}),t}),[e,i,d,m,r])}function ye(e){const{url:t}=(0,h.$B)(),n=_e((0,u.__)("Help","better-wp-security"));return(0,c.useMemo)((()=>{const r=[...n];return e&&r.splice(r.length-1,0,{to:t,title:e}),r}),[n,e])}function be(e){let{childPages:t,selected:n,"aria-current":r}=e;const l=(0,O.useFocusOnMount)();return(0,c.createElement)(b.Dropdown,{className:"itsec-breadcrumbs__menu",popoverProps:{position:"bottom center",className:"itsec-breadcrumbs__menu-popover",focusOnMount:"container"},renderToggle:e=>{let{isOpen:t,onToggle:r}=e;return(0,c.createElement)(b.Button,{"aria-haspopup":!0,"aria-expanded":t,onClick:r,onKeyDown:e=>{t||e.keyCode!==he.DOWN||(e.preventDefault(),e.stopPropagation(),r())},text:n.title,icon:t?"arrow-up":"arrow-down",iconPosition:"right"})},renderContent:()=>(0,c.createElement)(b.NavigableMenu,{role:"menu"},t.map((e=>{let{id:t,to:i,title:s}=e;return(0,c.createElement)(F.rU,{key:i,to:i,ref:n.id===t?l:null,"aria-current":n.id===t?r:null},s)})))})}function ve(e){let{title:t,subtitle:n,description:r,help:l,align:i="left",breadcrumbs:s=!0,children:a}=e;const o=(0,h.TH)();return(0,c.createElement)("header",{className:B()("itsec-page-header",`itsec-page-header--align-${i}`,{"itsec-page-header--has-actions":!!a,"itsec-page-header--has-help":!!l})},!0===s&&(0,c.createElement)(fe,{title:t}),s,(0,c.createElement)("div",{className:"itsec-page-header__text"},(0,c.createElement)("h1",{id:"itsec-page-header"},t,l&&(0,c.createElement)(D.J$,{help:l,to:{...o,hash:"#help"}})),n&&(0,c.createElement)("h2",null,n),r&&(0,c.createElement)(D.Lu,{content:r,tagName:"p"})),a&&(0,c.createElement)("div",{className:"itsec-page-header__actions"},a))}function Se(e){let{to:t,onClick:n,title:r,description:l,icon:i,fillIcon:s,recommended:a,direction:o="horizontal",className:u}=e;const d=B()("itsec-selectable-card",`itsec-selectable-card--${o}`,u,{"itsec-selectable-card--fill-icon":s,"itsec-selectable-card--recommended":a}),m=(0,c.createElement)(b.Card,null,(0,c.createElement)(b.CardBody,null,(0,c.createElement)("div",{className:"itsec-selectable-card__content"},(0,c.createElement)(b.Icon,{icon:i}),(0,c.createElement)("div",{className:"itsec-selectable-card__text"},(0,c.createElement)("h4",{className:"itsec-selectable-card__title"},r),(0,c.createElement)("p",{className:"itsec-selectable-card__description"},l)))));return t?(0,c.createElement)(F.rU,{to:t,className:d},m):n?(0,c.createElement)("button",{"aria-label":r,type:"button",onClick:n,className:d},m):m}function Ne(e){let{onSubmit:t=(()=>{}),saveLabel:n=(0,u.__)("Save","better-wp-security"),isSaving:r,saveDisabled:l=!1,onCancel:i,cancelHref:s,cancelLabel:a=(0,u.__)("Cancel","better-wp-security"),id:o,children:d,buttons:m,errors:p,apiError:g}=e;const E=(0,O.useInstanceId)(Ne,"itsec-primary-form");return o=o||E,(0,c.createElement)(React.Fragment,null,(0,c.createElement)(b.Card,{className:"itsec-primary-form"},(0,c.createElement)(b.CardBody,null,(0,c.createElement)(D.KM,{errors:p,apiError:g}),(0,c.createElement)("form",{id:o,onSubmit:e=>{e.preventDefault(),t()}},d))),(0,c.createElement)(b.Flex,null,(i||s)&&(0,c.createElement)(b.FlexItem,null,(0,c.createElement)(b.Button,{variant:"tertiary",onClick:i,href:s},a)),(0,c.createElement)(D.Xp,null),m&&m.map(((e,t)=>(0,c.createElement)(b.FlexItem,{key:t},e))),(0,c.createElement)(b.FlexItem,null,(0,c.createElement)(b.Button,{variant:"primary",isBusy:r,disabled:l,form:o,type:"submit"},n))))}function Oe(e){let{heading:t,className:n,children:r}=e;return c.Children.toArray(r).some(c.isValidElement)?(0,c.createElement)("div",{className:B()("itsec-primary-form__section",n)},t&&(0,c.createElement)("h3",{className:"itsec-primary-form__section-title"},t),r):null}var Te=n(54639),Le=n(33590);const Ie=(0,Te.Zz)(Le.ZP);function we(e){let{saveLabel:t,isSaving:n,saveDisabled:r,cancelLabel:l,onCancel:i,cancelRoute:s,undoLabel:a,undoDisabled:o,onUndo:u,children:d,errors:m,apiError:p,schemaError:g,...E}=e,h=(0,O.useInstanceId)(we,"itsec-schema-form");return h=E.id||h,(0,c.createElement)(React.Fragment,null,(0,c.createElement)(b.Card,null,(0,c.createElement)(b.CardBody,null,(0,c.createElement)(D.KM,{errors:m,apiError:p,schemaError:g}),(0,c.createElement)(Ce,(0,$.Z)({},E,{id:h})))),(0,c.createElement)(xe,{id:h,saveLabel:t,cancelLabel:l,isSaving:n,saveDisabled:r,onCancel:i,cancelRoute:s,undoLabel:a,undoDisabled:o,onUndo:u},d))}function Ce(e){let{className:t,...r}=e;return(0,c.createElement)(Ie,(0,$.Z)({},r,{className:B()("itsec-primary-schema-form","rjsf",t),additionalMetaSchemas:[n(27171)]}),(0,c.createElement)(React.Fragment,null))}function xe(e){let{id:t,saveLabel:n=(0,u.__)("Save","better-wp-security"),isSaving:r,saveDisabled:l,cancelLabel:i=(0,u.__)("Cancel","better-wp-security"),onCancel:s,cancelRoute:a,undoLabel:o=(0,u.__)("Undo Changes","better-wp-security"),undoDisabled:d,onUndo:m,children:p}=e;return(0,c.createElement)(b.Flex,null,s&&(0,c.createElement)(b.FlexItem,null,(0,c.createElement)(b.Button,{variant:"tertiary",type:"button",onClick:s},i)),a&&(0,c.createElement)(b.FlexItem,null,(0,c.createElement)(F.rU,{component:(0,U.Sj)(b.Button),variant:"tertiary",type:"button",to:a},i)),(0,c.createElement)(D.Xp,null),p,m&&(0,c.createElement)(b.FlexItem,null,(0,c.createElement)(b.Button,{variant:"secondary",disabled:d,onClick:m},o)),(0,c.createElement)(b.FlexItem,null,(0,c.createElement)(b.Button,{variant:"primary",isBusy:r,disabled:r||l,form:t,type:"submit"},n)))}function Re(){const[e,t]=(0,c.useState)(!1),n=(0,h.TH)(),r="#help"===n.hash,l={...n,hash:r?"":"#help"};return(0,c.createElement)(React.Fragment,null,(0,c.createElement)(z,null,(0,c.createElement)(F.rU,{component:(0,U.Sj)(b.ToolbarButton),icon:"editor-help",to:l,disabled:!e,className:"itsec-help-toggle-link",text:r?(0,u.__)("Exit Help","better-wp-security"):(0,u.__)("Help","better-wp-security")})),(0,c.createElement)(ke,null,(e=>(0,c.createElement)(Me,{fills:e,isVisible:r,setHasHelp:t}))))}function Me(e){let{fills:t,isVisible:n,setHasHelp:r}=e;return(0,c.useEffect)((()=>r(t.length>0)),[t]),n?t:null}const{Slot:ke,Fill:Ae}=(0,b.createSlotFill)("Help");var Fe=n(51783);function De(e){let{error:t}=e;const{pathname:n}=(0,h.TH)();return(0,c.createElement)(b.Card,{className:"itsec-error-renderer"},(0,c.createElement)(b.CardBody,null,(0,c.createElement)(Fe.gI,null)),(0,c.createElement)(b.CardFooter,{isShady:!0},(0,u.__)("An unexpected error occurred.","better-wp-security"),(0,c.createElement)(D.Xp,null),(0,c.createElement)(b.Button,{variant:"secondary",onClick:()=>window.location.reload()},(0,u.__)("Refresh","better-wp-security")),(0,c.createElement)(b.ClipboardButton,{variant:"primary",text:`Page: ${n}\nError: ${t.stack}`},(0,u.__)("Copy Error","better-wp-security"))))}function $e(e){let{style:t,className:n}=e;const{installType:r}=ne();let l;return l="pro"===r?"white"===t?Fe.v5:Fe.Zj:"white"===t?Fe.CE:Fe.D5,(0,c.createElement)(l,{className:n})}var Pe=n(87514),Be=n.n(Pe);function Ue(e){return{type:"API_FETCH",request:e}}function qe(e,t){return{type:"AWAIT_PROMISE",promise:e,delay:t}}function We(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{type:"DO_ACTION",action:e,args:n}}const He={AWAIT_PROMISE:e=>{let{promise:t,delay:n}=e;return n?Promise.all([t,(r=n,new Promise((e=>setTimeout(e,r))))]):t;var r},DO_ACTION:(0,T.createRegistryControl)((e=>t=>{let{action:n,args:r}=t;(0,ee.doAction)(`ithemes-security.${n}`,e,...r)})),API_FETCH(e){let{request:t}=e;return Be()(t).catch(G.xJ)},CREATE_NOTICE:(0,T.createRegistryControl)((e=>t=>{let{status:n,content:r,options:l}=t;l.autoDismiss&&(l.id=l.id||(0,E.uniqueId)("itsec-auto-dismiss-"),setTimeout((()=>e.dispatch("core/notices").removeNotice(l.id,l.context)),l.autoDismiss)),e.dispatch("core/notices").createNotice(n,r,l)}))};function*Ze(e){const t=yield T.controls.resolveSelect(Ft,"getSiteTypes"),n=(0,E.find)(t,(t=>t.id===e));if(!n)throw(0,u.__)("No site type found with that id.","better-wp-security");yield Je(n),yield Ke()}function je(){return{type:ot}}function Ve(e){return{type:ct,answer:e}}function*Ge(e){const t=yield T.controls.select(Ft,"getAnswerRequest",e);let n;yield et();try{n=yield Ue({method:"PUT",path:`/ithemes-security/v1/site-types/${t.id}`,data:t}),yield Je(n)}catch(e){yield(r=e,{type:dt,error:r})}var r;yield et(!1)}function*Qe(){const e=yield T.controls.select(Ft,"getRestoreSiteTypeRequest");e.answers.pop(),yield et();const t=yield Ue({method:"PUT",path:`/ithemes-security/v1/site-types/${e.id}`,data:e});yield Je(t),yield et(!1)}function*ze(){const e=yield T.controls.select(Ft,"getAnswers"),t=yield T.controls.resolveSelect(L.MODULES_STORE_NAME,"getModules");for(const n of e){for(const e of n.modules)t.find((t=>{let{id:n}=t;return n===e}))?.side_effects?yield T.controls.dispatch(L.MODULES_STORE_NAME,"activateModule",e):yield T.controls.dispatch(L.MODULES_STORE_NAME,"editModule",e,{status:{selected:"active"}});for(const e in n.settings)n.settings.hasOwnProperty(e)&&(yield T.controls.dispatch(L.MODULES_STORE_NAME,"editSettings",e,n.settings[e]));yield We("onboard.applyAnswerResponse",n)}}function*Ke(){yield Ve(null),yield T.controls.dispatch(L.MODULES_STORE_NAME,"resetModuleEdits"),yield T.controls.dispatch(L.MODULES_STORE_NAME,"resetSettingEdits"),yield We("onboard.reset")}function*Ye(e){let{root:t}=e;const n=e=>{if(e instanceof Error)throw e},r=(0,E.sortBy)(yield T.controls.select(Ft,"getCompletionSteps"),"priority");try{for(const e of r){if(e.activeCallback&&!e.activeCallback({root:t}))continue;yield{type:gt,step:e};const r=e.callback();r instanceof Promise&&n(yield qe(r,(0,E.random)(1500,2500)))}yield T.controls.dispatch(L.MODULES_STORE_NAME,"editSetting","global","onboard_complete",!0),yield T.controls.dispatch(L.MODULES_STORE_NAME,"saveSettings","global"),yield{type:gt,step:!0}}catch(e){yield{type:gt,step:!1},yield function(){return{type:"CREATE_NOTICE",status:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"info",content:arguments.length>1?arguments[1]:void 0,options:{context:"ithemes-security",...arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}}}}("error",(0,u.sprintf)((0,u.__)("Could not complete setup: %s","better-wp-security"),e.message))}}function Xe(e){return{type:it,siteTypes:e}}function Je(e){return{type:st,siteType:e}}function et(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return{type:ut,isAnswering:e}}function tt(e,t){return{type:mt,id:e,component:t}}function nt(e){let{id:t,label:n,priority:r,render:l,callback:i,activeCallback:s}=e;return{type:pt,id:t,label:n,priority:r,render:l,callback:i,activeCallback:s}}function rt(e){return{type:Et,location:(0,E.trimEnd)(e,"/")}}function lt(){return{type:ht}}const it="RECEIVE_SITE_TYPES",st="RECEIVE_SITE_TYPE",at="SELECT_SITE_TYPE",ot="CLEAR_SITE_TYPE",ct="EDIT_ANSWER",ut="SET_IS_ANSWERING",dt="SET_ERROR",mt="REGISTER_QUESTION_COMPONENT",pt="REGISTER_COMPLETION_STEP",gt="SET_COMPLETION_STEP",Et="RECORD_VISITED_LOCATION",ht="CLEAR_VISITED_LOCATIONS";function ft(e){return e.siteTypes}function _t(e){return e.selectedSiteType}function yt(e){return(0,E.find)(ft(e),{id:_t(e)})}function bt(e){return e.answers}function vt(e){return e.nextQuestion}function St(e){return e.editedAnswer}function Nt(e){return e.isAnswering}function Ot(e){return e.lastError}function Tt(e,t){return e.questionComponents[t]}function Lt(e){return e.completionSteps}function It(e,t){return{id:e.selectedSiteType,answers:[...e.answers,{question:e.nextQuestion.id,answer:t}]}}function wt(e){return{id:e.selectedSiteType,answers:[...e.answers]}}function Ct(e){const t=["/onboard","/onboard/site-type"];for(let n=e.visitedLocations.length-1;n>=0;n--){const r=e.visitedLocations[n];if(!t.includes(r))return r}}function xt(e){return e.completionStep}const Rt={siteTypes:[],selectedSiteType:"",answers:[],nextQuestion:void 0,editedAnswer:void 0,lastError:void 0,isAnswering:!1,questionComponents:{},completionStep:!1,completionSteps:{},visitedLocations:[]},Mt={*fulfill(){const e=yield Ue({path:"/ithemes-security/v1/site-types"});yield Xe(e)},isFulfilled:e=>e.siteTypes.length>0},kt={*fulfill(){yield T.controls.resolveSelect(Ft,"getSiteTypes")},isFulfilled:e=>e.siteTypes.length>0},At={*fulfill(){const e=yield T.controls.select(Ft,"getRestoreSiteTypeRequest"),t=yield Ue({method:"PUT",path:`/ithemes-security/v1/site-types/${e.id}`,data:e});yield Je(t)},isFulfilled:e=>void 0!==e.nextQuestion},Ft="ithemes-security/onboard";function Dt(){const{clearVisitedLocations:e}=(0,T.useDispatch)(Ft),{siteTypes:t,lastVisitedLocation:n}=(0,T.useSelect)((e=>({siteTypes:e(Ft).getSiteTypes(),lastVisitedLocation:e(Ft).getLastVisitedLocation()})));return(0,c.createElement)(React.Fragment,null,(0,c.createElement)(ve,{title:(0,u.__)("Choose the Type of Website","better-wp-security"),subtitle:(0,u.__)("Select one of the following that best represents your website.","better-wp-security")}),n&&(0,c.createElement)(D.rN,{hasBorder:!0,onDismiss:e,messages:[(0,c.createInterpolateElement)((0,u.__)("Already started setting up iThemes Security? <a>Resume</a> from where you left off.","better-wp-security"),{a:(0,c.createElement)(F.rU,{to:n})})]}),(0,c.createElement)("ul",{className:"itsec-site-type-list"},t.map((e=>(0,c.createElement)("li",{key:e.id},(0,c.createElement)($t,{id:e.id,title:e.title,description:e.description,icon:e.icon,recommended:e.recommended}))))),(0,c.createElement)(Ae,null,(0,c.createElement)(ve,{title:(0,u.__)("Site Type","better-wp-security")}),(0,c.createElement)(D.ss,{topic:"site-type"})))}function $t(e){let{id:t,title:n,description:r,icon:l,recommended:i}=e;const{clearSiteType:s}=(0,T.useDispatch)(Ft),a=(0,h.$B)(),o=re();return(0,c.createElement)(Se,{onClick:()=>{s(),o(`${a.url}/${t}`)},title:n,description:r,icon:l,recommended:i})}function*Pt(){const e=yield Ue({path:"/ithemes-security/v1/tools"});yield{type:qt,tools:e}}function*Bt(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};yield{type:Wt,tool:e,form:n};try{t=yield Ue({path:`/ithemes-security/v1/tools/${e}`,method:"POST",data:n,parse:!1})}catch(t){const n=yield qe(G.x4.fromResponse(t.getResponse()));return yield{type:Ht,tool:e,result:n},n}const r=yield qe(G.x4.fromResponse(t));return yield{type:Ht,tool:e,result:r},r}function*Ut(e){let t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];yield{type:Zt,tool:e,enabled:n};try{t=yield Ue({path:`/ithemes-security/v1/tools/${e}`,method:"PUT",data:{enabled:n}})}catch(t){return yield{type:jt,tool:e,error:t},t}return yield{type:Vt,tool:e,data:t},t}(0,T.registerStore)(Ft,{controls:He,actions:r,selectors:l,resolvers:i,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Rt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case it:return{...e,siteTypes:t.siteTypes};case st:return{...e,selectedSiteType:t.siteType.id,nextQuestion:t.siteType.next_question,answers:t.siteType.answers,editedAnswer:t.siteType.next_question?.answer_schema?.default,lastError:void 0};case at:return{...e,selectedSiteType:t.id,answers:[],nextQuestion:void 0,lastError:void 0};case ot:return{...e,selectedSiteType:"",answers:[],nextQuestion:void 0,lastError:void 0};case ct:return{...e,editedAnswer:t.answer};case ut:return{...e,isAnswering:t.isAnswering};case dt:return{...e,lastError:t.error};case gt:return{...e,completionStep:t.step};case mt:return{...e,questionComponents:{...e.questionComponents,[t.id]:t.component}};case pt:return{...e,completionSteps:{...e.completionSteps,[t.id]:(0,E.omit)(t,["type"])}};case Et:return{...e,visitedLocations:(0,E.last)(e.visitedLocations)===t.location?e.visitedLocations:(0,E.without)(e.visitedLocations,t.location).concat(t.location)};case ht:return{...e,visitedLocations:[]};default:return e}},persist:["selectedSiteType","answers","visitedLocations"]});const qt="RECEIVE_TOOLS",Wt="START_TOOL",Ht="FINISH_TOOL",Zt="START_TOGGLE_TOOL",jt="FAILED_TOGGLE_TOOL",Vt="FINISH_TOGGLE_TOOL";var Gt=n(28306),Qt=n(59588),zt=n.n(Qt);const Kt=zt()(((e,t)=>e.map((e=>t[e.slug]||e))),{maxSize:1}),Yt=(0,T.createRegistrySelector)((e=>t=>Kt(e(mn).getToolsConfig(),t.bySlug))),Xt=(0,Gt.Z)((e=>e.slugs.map((t=>e.bySlug[t]))),(e=>[e.bySlug,e.slugs])),Jt=zt()((e=>e.reduce(((e,t)=>{for(const[n,r]of Object.entries(t.tools))e.push({slug:n,module:t.id,toggleable:!1,schedule:"",form:null,...r});return e}),[])),{maxSize:1}),en=(0,T.createRegistrySelector)((e=>()=>Jt(e(L.MODULES_STORE_NAME).getModules()))),tn=(0,T.createRegistrySelector)((e=>(t,n)=>t.bySlug[n]||e(mn).getToolsConfig().find((e=>n===e.slug))));function nn(e){return e.running}function rn(e,t){return e.running.includes(t)}function ln(e,t){return e.lastResult[t]}function sn(e,t){return e.updating.includes(t)}function an(e,t){return e.lastError[t]}const on={bySlug:{},slugs:[],running:[],lastResult:{},updating:[],lastError:{}};function*cn(){yield Pt()}function*un(){yield T.controls.resolveSelect(mn,"getTools")}const dn={*fulfill(){yield T.controls.resolveSelect(mn,"getTools")},isFulfilled:(e,t)=>!!e.bySlug[t]},mn="ithemes-security/tools",pn=((0,T.registerStore)(mn,{controls:He,actions:s,selectors:a,resolvers:o,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:on,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case qt:return{...e,bySlug:(0,E.keyBy)(t.tools,"slug"),slugs:(0,E.map)(t.tools,"slug")};case Wt:return{...e,running:[...e.running,t.tool]};case Ht:return{...e,running:(0,E.without)(e.running,t.tool),lastResult:{...e.lastResult,[t.tool]:t.result}};case Zt:return{...e,updating:[...e.updating,t.tool]};case jt:return{...e,updating:(0,E.without)(e.updating,t.tool),lastError:{...e.lastError,[t.tool]:t.error}};case Vt:return{...e,updating:(0,E.without)(e.updating,t.tool),lastError:(0,E.omit)(e.lastError,t.tool),bySlug:{...e.bySlug,[t.tool]:t.data}};default:return e}}}),{disableInlineErrors:!0});function gn(e){let{prompt:t,description:n,showErrors:r=!0,children:l}=e;const{error:i,siteTypeTitle:s}=(0,T.useSelect)((e=>({error:e(Ft).getLastError(),siteTypeTitle:e(Ft).getSelectedSiteType()?.title})));return(0,c.createElement)(React.Fragment,null,(0,c.createElement)(ve,{title:t,subtitle:n,breadcrumbs:(0,c.createElement)(fe,{title:s})}),r&&(0,c.createElement)(D.KM,{apiError:i,className:"itsec-site-type-question__error-list"}),l)}function En(e){let{question:t,onAnswer:n,goBack:r}=e;const{editAnswer:l}=(0,T.useDispatch)(Ft),{answer:i,error:s}=(0,T.useSelect)((e=>({error:e(Ft).getLastError(),answer:e(Ft).getEditedAnswer()}))),[a,o]=(0,c.useState)([]);return(0,c.createElement)(gn,{prompt:t.prompt,description:t.description,showErrors:!1},(0,c.createElement)(we,{schema:t.answer_schema,uiSchema:t.answer_schema.uiSchema,formData:i,onChange:e=>{let{formData:t}=e;return l(t)},onSubmit:(e,t)=>{let{formData:r}=e;t.preventDefault(),o([]),n(r)},saveLabel:(0,u.__)("Next","better-wp-security"),cancelLabel:(0,u.__)("Back","better-wp-security"),onCancel:r,formContext:pn,apiError:s,schemaError:a,onError:o,showErrorList:!1}))}function hn(e){let{question:t,onAnswer:n}=e;return(0,c.createElement)(gn,{prompt:t.prompt,description:t.description},(0,c.createElement)("div",{className:"itsec-site-type-questions-list"},(0,c.createElement)(Se,{onClick:()=>n(!1),title:(0,u.__)("Self","better-wp-security"),description:(0,u.__)("This is my own personal site.","better-wp-security"),direction:"vertical",icon:"admin-users",className:"itsec-site-type-question"}),(0,c.createElement)(Se,{onClick:()=>n(!0),title:(0,u.__)("Client","better-wp-security"),description:(0,u.__)("I'm making this for a client.","better-wp-security"),direction:"vertical",icon:"businessperson",className:"itsec-site-type-question"})))}function fn(){const{registerQuestionComponent:e}=(0,T.useDispatch)(Ft);(0,U.eH)(fn,(()=>{e("is-client",hn)}))}function _n(){fn();const{goNext:e}=A(),{siteType:t}=(0,h.UO)(),{isAnswering:n,selectedSiteTypeId:r,questionId:l}=(0,T.useSelect)((e=>({isAnswering:e(Ft).isAnswering(),selectedSiteTypeId:e(Ft).getSelectedSiteTypeId(),questionId:e(Ft).getNextQuestion()?.id}))),{selectSiteType:i,applyAnswerResponse:s}=(0,T.useDispatch)(Ft),a=function(){const{answerQuestion:e,repeatQuestion:t}=(0,T.useDispatch)(Ft),n=(0,T.useSelect)((e=>e(Ft).getNextQuestion())),r=n?.id,l=(0,T.useSelect)((e=>e(Ft).getQuestionComponent(r)),[r]);if(!n)return n;const i=(0,c.memo)(l||En);return(0,c.createElement)(i,{question:n,onAnswer:e,goBack:t})}();return(0,c.useLayoutEffect)((()=>{r!==t&&i(t)}),[r,t]),(0,c.useEffect)((()=>{null===a&&(s(),e())}),[a]),n?(0,c.createElement)(b.Disabled,null,a):a?(0,c.createElement)(React.Fragment,null,a,(0,c.createElement)(Ae,null,(0,c.createElement)(ve,{title:(0,u.__)("Site Type","better-wp-security"),breadcrumbs:!1}),(0,c.createElement)(D.ss,{topic:`site-type-${l}`,fallback:"site-type"}))):null}function yn(){const{path:e}=(0,h.$B)();return(0,c.createElement)(h.rs,null,(0,c.createElement)(h.AW,{path:`${e}/:siteType`},(0,c.createElement)(_n,null)),(0,c.createElement)(h.AW,{path:`${e}`},(0,c.createElement)(Dt,null)))}function bn(){const{url:e,path:t}=(0,h.$B)(),{root:n}=(0,h.UO)(),r=ue(),{installType:l}=ne(),{modules:i,dirty:s}=(0,T.useSelect)((e=>({modules:e(L.MODULES_STORE_NAME).getEditedModules(),dirty:e(L.MODULES_STORE_NAME).getDirtyModules()})),[]),a=ce().map((e=>{let{slug:t,label:l}=e;return{name:t,title:l,modules:(0,E.sortBy)(i.filter((e=>e.type===t&&"always-active"!==e.status.default&&("settings"===n||e.onboard||"import"===n&&s.includes(t))&&function(e,t){if("active"===t.status.selected)return!0;const n=e(t,"activate");return!n.hasErrors()||n.getErrorCodes().some((e=>n.getErrorData(e)[0].showMessageIfUnmet))}(r,e))),"order")}})).filter((e=>e.modules.length>0&&("settings"===n||"advanced"!==e.name))),o=(0,E.sortBy)(a.reduce(((e,t)=>e.concat(t.modules)),[]),(e=>{let{title:t}=e;return t.toLowerCase()}));if(o.length>0){const e={name:"all",title:(0,u.__)("All","better-wp-security"),modules:o};"free"===l?a.unshift(e):a.push(e)}const d=(0,u.__)("Features is the home base of iThemes Security. Enabling a security feature will unlock the related User Group, Configure, and Notification settings. Disabling a security feature will hide the related options throughout the plugin.","better-wp-security");return(0,c.createElement)(React.Fragment,null,(0,c.createElement)(x,{pages:a.map((t=>({title:t.title,to:`${e}/${t.name}`,id:t.name,replace:!0})))}),a.length>0&&(0,c.createElement)(h.rs,null,(0,c.createElement)(h.AW,{path:`${t}/:child`},(0,c.createElement)(ve,{title:(0,u.__)("Features","better-wp-security"),subtitle:(0,u.__)("Choose the security features you‘d like to enable.","better-wp-security"),help:d}),(0,c.createElement)(vn,{base:e,tabs:a}),"settings"!==n&&(0,c.createElement)(Sn,null),(0,c.createElement)(wn,{help:d})),(0,c.createElement)(h.l_,{to:`${e}/${a[0].name}`})))}function vn(e){let{base:t,tabs:n}=e;const{child:r}=(0,h.UO)(),l=re();return(0,c.createElement)(b.Card,null,(0,c.createElement)(D.y2,{isStyled:!0,tabs:n,selected:r,onSelect:e=>{l(`${t}/${e}`,"replace")}},(e=>(0,c.createElement)(Nn,{modules:e.modules}))))}function Sn(){const{next:e}=A();return(0,c.createElement)(b.Flex,null,(0,c.createElement)(D.Xp,null),(0,c.createElement)(b.FlexItem,null,(0,c.createElement)(F.rU,{component:(0,U.Sj)(b.Button),variant:"primary",to:e},(0,u.__)("Next","better-wp-security"))))}function Nn(e){let{modules:t}=e;return(0,c.createElement)(b.CardBody,null,(0,c.createElement)(On,{modules:t}))}function On(e){let{modules:t}=e;const{root:n}=(0,h.UO)(),r="settings"===n?In:Ln;return(0,c.createElement)("div",{className:"itsec-modules"},t.map((e=>(0,c.createElement)(Tn,{key:e.id,module:e,statusToggle:e.side_effects?In:r}))),1===t.length&&(0,c.createElement)("div",{"aria-hidden":"true"}))}function Tn(e){let{module:t,statusToggle:n}=e;const{hash:r}=(0,h.TH)(),{root:l}=(0,h.UO)(),i=(0,T.useSelect)((e=>e(L.MODULES_STORE_NAME).getError(t.id))),s=ue()(t,"run");return(0,c.createElement)(b.Card,{key:t.id,className:B()("itsec-module",{"itsec-highlighted-search-result":r===`#${t.id}`})},(0,c.createElement)(b.CardBody,{className:"itsec-module__body"},(0,c.createElement)("h3",null,t.title),"settings"===l&&"active"===t.status.selected&&!s.hasErrors()&&(0,c.createElement)(React.Fragment,null,t.settings?.interactive.length>0&&(0,c.createElement)(b.Tooltip,{text:(0,u.__)("Edit Settings","better-wp-security")},(0,c.createElement)(F.rU,{className:"itsec-module__settings",to:`/settings/configure/${t.type}/${t.id}`},(0,c.createElement)(b.VisuallyHidden,null,(0,u.__)("Edit Settings","better-wp-security")))),!(0,E.isEmpty)(t.user_groups)&&(0,c.createElement)(F.rU,{className:"itsec-module__user-groups",to:`/settings/user-groups?module=${t.id}`},(0,u.sprintf)((0,u.__)("User Groups (%d)","better-wp-security"),(0,E.size)(t.user_groups)))),(0,c.createElement)(D.Lu,{content:t.description,tagName:"p",id:`itsec-module-description--${t.id}`}),("active"===t.status.selected||!s.hasErrors())&&(0,c.createElement)(n,{module:t}),(0,c.createElement)(D.KM,{apiError:i,errors:s.getAllErrorMessages()})))}function Ln(e){let{module:t}=e;const{editModule:n}=(0,T.useDispatch)(L.MODULES_STORE_NAME);return(0,c.createElement)(b.FormToggle,{checked:"active"===t.status.selected,onChange:e=>n(t.id,{status:{selected:e.target.checked?"active":"inactive"}}),"aria-label":(0,u.sprintf)((0,u.__)("Enable the “%s” module.","better-wp-security"),t.title),"aria-describedby":`itsec-module-description--${t.id}`})}function In(e){let{module:t}=e;const n="active"===t.status.selected,[r,l]=(0,c.useState)(!1),{activateModule:i,deactivateModule:s}=(0,T.useDispatch)(L.MODULES_STORE_NAME);return(0,c.createElement)(b.FormToggle,{checked:n,onChange:e=>(async e=>{l(!0),e?await i(t.id):await s(t.id),l(!1)})(e.target.checked),disabled:r,"aria-label":(0,u.sprintf)((0,u.__)("Enable the “%s” module.","better-wp-security"),t.title),"aria-describedby":`itsec-module-description--${t.id}`})}function wn(e){let{help:t}=e;return(0,c.createElement)(Ae,null,(0,c.createElement)(ve,{title:(0,u.__)("Features","better-wp-security"),description:t,breadcrumbs:(0,c.createElement)(fe,{trail:ye()})}),(0,c.createElement)(D.ss,{topic:"modules"}))}function Cn(){const{url:e,path:t,isExact:n,params:{root:r}}=(0,h.$B)(),{types:l,modules:i}=function(){const{root:e}=(0,h.UO)(),{serverType:t,installType:n}=ne(),r=(0,T.useRegistry)(),{editedModules:l,activeModules:i,featureFlags:s}=(0,T.useSelect)((e=>({editedModules:e(L.MODULES_STORE_NAME).getEditedModules(),activeModules:e(L.MODULES_STORE_NAME).getActiveModules(),featureFlags:e(L.CORE_STORE_NAME).getFeatureFlags()}))),a=ue(),o=(0,E.sortBy)(l.filter((l=>{if("active"!==l.status.selected)return!1;if(!l.settings?.show_ui)return!1;if(!l.settings?.interactive.length)return!1;if("onboard"===e&&!l.settings?.onboard.length)return!1;if("import"===e&&!l.settings?.onboard.length&&!l.settings?.import.length)return!1;if(a(l,"run").hasErrors())return!1;if(l.settings?.conditional){const a=ie(l,{serverType:t,installType:n,activeModules:i,featureFlags:s,registry:r,settings:r.select(L.MODULES_STORE_NAME).getEditedSettings(l.id)});if((0,E.isEmpty)(a.properties))return!1;if((0,E.every)(a.properties,(e=>"object"===e.type&&(0,E.isEmpty)(e.properties))))return!1;if("onboard"===e&&!l.settings.onboard.some((e=>!!a.properties[e])))return!1;if("import"===e&&!l.settings.onboard.some((e=>!!a.properties[e]))&&!l.settings.import.some((e=>!!a.properties[e])))return!1}return!0})),"order");return{types:ce().map((e=>({...e,modules:o.filter((t=>t.type===e.slug))}))).filter((e=>e.modules.length>0)),modules:o}}(),s=i.filter((e=>"recommended"===e.type)),a=s.map((e=>e.id)).join("|"),o=[...s.map((e=>({slug:e.id,label:e.title}))),...l];return(0,c.createElement)(React.Fragment,null,!n&&(0,c.createElement)(x,{pages:o.filter((e=>{let{slug:t}=e;return"advanced"!==t})).map((t=>{let{slug:n,label:r}=t;return{title:r,to:`${e}/${n}`,id:n}}))}),(0,c.createElement)(h.rs,null,(0,c.createElement)(h.AW,{path:`${t}/:child(${a})`,render:e=>{let{match:t}=e;const n=i.find((e=>e.id===t.params.child));return n?(0,c.createElement)(Mn,{module:n}):null}}),(0,c.createElement)(h.AW,{path:[`${t}/:child/:tab`,`${t}/:child`],render:e=>{let{match:t}=e;const n=l.find((e=>e.slug===t.params.child));return n?(0,c.createElement)(Rn,{modules:n.modules}):null}}),(0,c.createElement)(h.AW,{path:t},o.length>0&&("settings"!==r?(0,c.createElement)(xn,{to:`${e}/${o[0].slug}`}):(0,c.createElement)(h.l_,{to:`${e}/${o[0].slug}`})))))}function xn(e){let{to:t}=e;return(0,c.createElement)(React.Fragment,null,(0,c.createElement)(ve,{title:(0,u.__)("Configure","better-wp-security"),subtitle:(0,u.__)("Based on the Security Features you’ve enabled while settings up iThemes Security, we’ve selected the most important settings for you to configure.","better-wp-security")}),(0,c.createElement)("div",{className:"itsec-configure-intro"},(0,c.createElement)(Se,{title:(0,u.__)("Recommended","better-wp-security"),description:(0,u.__)("Configure Site","better-wp-security"),icon:"star-filled",fillIcon:!0,to:t,direction:"vertical"})))}function Rn(e){let{modules:t}=e;const{url:n,path:r}=(0,h.$B)(),{child:l,tab:i,root:s,...a}=(0,h.UO)(),o=re(),u=(0,c.useMemo)((()=>t.map((e=>({name:e.id,title:e.title,module:e})))),[l,t]),d=t.find((e=>e.id===i));if(!d){const e=t.find((e=>e.type===l));return(0,c.createElement)(h.l_,{to:e?`${n}/${e.id}`:n})}return(0,c.createElement)(Mn,{module:d,tabs:u,onSelect:e=>o((0,h.Gn)(r,{...a,root:s,child:l,tab:e}))})}function Mn(e){let{module:t,tabs:n,onSelect:r}=e;const{root:l}=(0,h.UO)(),i="settings"===l?An:kn;return(0,c.createElement)(React.Fragment,null,(0,c.createElement)(ve,{title:t.title,subtitle:t.description,help:t.help,breadcrumbs:"advanced"!==t.type}),(0,c.createElement)(i,{tabs:n,module:t,onSelect:r}))}function kn(e){let{tabs:t,module:n,onSelect:r}=e;const{root:l}=(0,h.UO)(),{previous:i,goNext:s}=A(t?.map((e=>e.name)));return n?(0,c.createElement)(Fn,{tabs:t,module:n,onSelect:r,onSave:s,saveLabel:(0,u.__)("Next","better-wp-security"),saveDisabled:!1,cancelLabel:(0,u.__)("Back","better-wp-security"),cancelRoute:i,filterFields:(e,t)=>n.settings.onboard.includes(t)||"import"===l&&n.settings.import.includes(t)}):null}function An(e){let{tabs:t,module:n,onSelect:r}=e;const{saveSettings:l}=(0,T.useDispatch)(L.MODULES_STORE_NAME);return n?(0,c.createElement)(Fn,{tabs:t,module:n,onSelect:r,onSave:()=>l(n.id)}):null}function Fn(e){let{tabs:t,module:n,onSelect:r,onSave:l,saveDisabled:i,filterFields:s,...a}=e;const o=(0,O.useInstanceId)(Fn,`itsec-configure-${n.id}`),{hash:u}=(0,h.TH)(),{isSaving:d,isDirty:m,apiError:p}=(0,T.useSelect)((e=>({isSaving:e(L.MODULES_STORE_NAME).isSavingSettings(n.id),isDirty:e(L.MODULES_STORE_NAME).areSettingsDirty(n.id),apiError:e(L.MODULES_STORE_NAME).getError(n.id)})),[n.id]),{resetSettingEdits:g}=(0,T.useDispatch)(L.MODULES_STORE_NAME),{schema:f,uiSchema:_,formData:y,setFormData:v}=function(e,t){const n=(0,T.useSelect)((t=>t(L.MODULES_STORE_NAME).getEditedSettings(e.id)),[e.id]),{editSettings:r}=(0,T.useDispatch)(L.MODULES_STORE_NAME),l=se(e,n);return t&&(l.properties=(0,E.pickBy)(l.properties,t)),{schema:l,uiSchema:e.settings.schema.uiSchema,formData:n,setFormData:t=>{r(e.id,t.formData)}}}(n,s),S=(0,c.useMemo)((()=>{return u?(e=_?(0,E.cloneDeep)(_):{},t=[u.substr(1),"classNames"],"itsec-highlighted-search-result",(0,E.set)(e,t,B()((0,E.get)(e,t),"itsec-highlighted-search-result")),e):_;var e,t}),[_,u]),[N,I]=(0,c.useState)([]),w=(0,c.useMemo)((()=>({module:n.id,disableInlineErrors:!0})),[n.id]),C=e=>{I([]),l(e)};if(!n)return null;const x=()=>(0,c.createElement)(React.Fragment,null,(0,c.createElement)($n,{module:n}),(0,c.createElement)(b.CardBody,null,(0,c.createElement)(D.KM,{apiError:p,schemaError:N}),(0,c.createElement)(Ce,{id:o,onSubmit:C,schema:f,uiSchema:S,formData:y,onChange:v,idPrefix:`itsec_${n.id}`,formContext:w,onError:I,showErrorList:!1})));return(0,c.createElement)(React.Fragment,null,(0,c.createElement)(Dn,{module:n}),(0,c.createElement)(b.Card,null,t?(0,c.createElement)(D.y2,{tabs:t,selected:n.id,onSelect:r,isStyled:!0},x):x()),(0,c.createElement)(xe,(0,$.Z)({id:o,isSaving:d,saveDisabled:void 0===i?!m:i,undoDisabled:!m,onUndo:()=>g(n.id)},a)))}function Dn(e){let{module:t}=e;return(0,c.createElement)(Ae,null,(0,c.createElement)(ve,{title:t.title,description:t.help,breadcrumbs:(0,c.createElement)(fe,{trail:ye(t.title)})}),(0,c.createElement)(D.ss,{topic:t.id}))}function $n(e){let{module:t}=e;const n=[];if(!(0,E.isEmpty)(t.user_groups)||"password-requirements"===t.id){const e="password-requirements"===t.id?(0,u.__)("User Groups","better-wp-security"):(0,u.sprintf)((0,u.__)("User Groups (%d)","better-wp-security"),(0,E.size)(t.user_groups));n.push((0,c.createElement)(F.rU,{to:`/settings/user-groups?module=${t.id}`,component:(0,U.Sj)(b.Button),variant:"link",text:e,icon:"groups"}))}return n.length?(0,c.createElement)(b.CardHeader,{className:"itsec-configure-module-links"},(0,c.createElement)("ul",null,n.map(((e,t)=>(0,c.createElement)("li",{key:t},e))))):null}function Pn(){const{hash:e}=(0,h.TH)(),{tools:t,running:n,activeModules:r,isLoaded:l}=(0,T.useSelect)((e=>({tools:e(mn).getResolvedTools(),running:e(mn).getRunning(),activeModules:e(L.MODULES_STORE_NAME).getActiveModules(),isLoaded:e(mn).hasFinishedResolution("getTools")}))),i=(0,c.useMemo)((()=>t.filter((e=>r.includes(e.module)&&!1!==e.available)).map((e=>({name:e.slug,title:e.title,description:e.description,showSpinner:(0,c.createElement)(D.$j,{size:30,paused:!n.includes(e.slug)}),render:Bn})))),[t,n,r]),[s,a]=(0,c.useState)("");return(0,c.useEffect)((()=>{e&&a(e.slice(1))}),[e]),(0,c.createElement)(React.Fragment,null,(0,c.createElement)(Ae,null,(0,c.createElement)(ve,{title:(0,u.__)("Tools","better-wp-security")}),(0,c.createElement)(D.ss,{topic:"tools"})),(0,c.createElement)(ve,{title:(0,u.__)("Tools","better-wp-security")}),t.length>0&&l&&(0,c.createElement)(b.Card,null,(0,c.createElement)(D.UQ,{className:"itsec-tools-list",isStyled:!0,panels:i,allowNone:!0,expanded:s,setExpanded:a})))}function Bn(e){let{name:t,className:n,...r}=e;const{tool:l,result:i,isRunning:s}=(0,T.useSelect)((e=>({tool:e(mn).getTool(t),result:e(mn).getLastResult(t),isRunning:e(mn).isRunning(t)}))),[a,o]=(0,c.useState)([]);return(0,c.useEffect)((()=>o([])),[t]),(0,c.createElement)("div",(0,$.Z)({className:B()(n,"itsec-tool")},r),(0,c.createElement)(Un,{result:i,schemaError:a}),l.help&&(0,c.createElement)(D.Lu,{content:l.help,tagName:"p"}),(0,c.createElement)(Hn,{tool:l.slug}),l.toggleable?(0,c.createElement)(React.Fragment,null):(0,c.createElement)(qn,{tool:l,setSchemaError:o,isRunning:s}))}function Un(e){let{result:t,schemaError:n}=e;return(0,c.createElement)(React.Fragment,null,(0,c.createElement)(D.KM,{schemaError:n,apiError:t?.error}),(0,c.createElement)(D.rN,{messages:t?.success,type:"success"}),(0,c.createElement)(D.rN,{messages:t?.warning,type:"warning"}),(0,c.createElement)(D.rN,{messages:t?.info,type:"info"}))}function qn(e){let{tool:t,setSchemaError:n,isRunning:r}=e;const l=function(e){const{activeModules:t,settings:n}=(0,T.useSelect)((t=>({settings:(0,E.mapValues)(e.condition?.settings||{},((e,n)=>t(L.MODULES_STORE_NAME).getSettings(n))),activeModules:t(L.MODULES_STORE_NAME).getActiveModules()})),[e]);if(!e.condition)return!0;if(e.condition["active-modules"])for(const n of e.condition["active-modules"])if(!t.includes(n))return!1;if(e.condition.settings){const t=le();for(const[r,l]of Object.entries(e.condition.settings))if(!t.compile(l)(n[r]))return!1}return!0}(t),i=(0,O.useInstanceId)(qn,"itsec-tool-form"),s=(0,c.useMemo)((()=>({disableInlineErrors:!0,tool:t.slug}))),{runTool:a}=(0,T.useDispatch)(mn);return(0,c.createElement)(React.Fragment,null,t.form&&l&&(0,c.createElement)(Ce,{id:i,idPrefix:`itsec_tool_${t.slug}`,schema:t.form,uiSchema:t.form.uiSchema,formContext:s,showErrorList:!1,onError:n,onSubmit:e=>{let{formData:r}=e;n([]),a(t.slug,r)}}),(0,c.createElement)(b.Flex,{className:"itsec-tool__actions",justify:"flex-start"},(0,c.createElement)(b.FlexItem,null,(0,c.createElement)(b.Button,{variant:"primary",className:"itsec-tool__trigger",type:t.form?"submit":"button",form:t.form?i:void 0,onClick:t.form?void 0:()=>a(t.slug),isBusy:r,disabled:!l},(0,u.__)("Run","better-wp-security"))),(0,c.createElement)(Hn,{tool:t.slug,fillProps:{isActive:l},area:"actions"},(e=>c.Children.map(e,((e,t)=>(0,c.createElement)(b.FlexItem,{key:t},e)))))),!l&&t.condition?.description&&(0,c.createElement)(D.rN,{type:"warning",messages:[t.condition.description]}))}function Wn(e){let{tool:t,area:n="main",...r}=e;return(0,c.createElement)(b.Fill,(0,$.Z)({name:`Tool${n}${t}`},r))}function Hn(e){let{tool:t,area:n="main",...r}=e;return(0,c.createElement)(b.Slot,(0,$.Z)({name:`Tool${n}${t}`},r))}var Zn=n(51980);const jn=(0,Zn.Z)("div",{target:"erg3x952"})('display:grid;grid-template-areas:"heading heading" "text text" "dashboard settings";grid-template-columns:1fr 1fr;gap:1rem 0.625rem;@media (min-width: ',(e=>{let{theme:t}=e;return t.breaks.medium}),'px ){grid-template-areas:"heading heading heading" "text dashboard settings";grid-template-columns:4fr 1fr 1fr;gap:1rem 0.625rem;}'),Vn=(0,Zn.Z)(S.X6,{target:"erg3x951"})({name:"1c7kmgu",styles:"grid-area:heading"}),Gn=(0,Zn.Z)(S.X6,{target:"erg3x950"})({name:"1a4sv2g",styles:"grid-area:text"});function Qn(){const e=(0,G.bv)("dashboard"),t=(0,G.bv)("settings");return(0,c.createElement)(jn,null,(0,c.createElement)(Vn,{level:1,text:(0,u.__)("Great Work! Your site is ready and is more secure than ever!","better-wp-security"),size:S.yH.HUGE}),(0,c.createElement)(Gn,{level:3,text:(0,u.__)("If you want to dig into your site’s security, check out your security dashboard, and make changes via settings.","better-wp-security"),size:S.yH.LARGE,variant:S.rK.DARK}),(0,c.createElement)(S.zx,{variant:"secondary",href:e,text:(0,u.__)("Dashboard","better-wp-security")}),(0,c.createElement)(S.zx,{variant:"secondary",href:t,text:(0,u.__)("Settings","better-wp-security")}))}const zn=(0,Zn.Z)(b.CardBody,{target:"e1g23leq2"})({name:"4zk4ri",styles:"display:flex;flex-direction:column;gap:1rem"}),Kn=(0,Zn.Z)(Fe.dK,{shouldForwardProp:e=>"installType"!==e,target:"e1g23leq1"})("g{fill:",(e=>{let{installType:t}=e;return"free"===t&&"#F8D739"}),";}"),Yn=(0,Zn.Z)(S.zx,{target:"e1g23leq0"})("width:100%;background:#EDEDED!important;&:not(:hover):not(:focus){box-shadow:none!important;}@media (min-width: ",(e=>{let{theme:t}=e;return t.breaks.huge}),"px ){justify-content:left;}"),Xn=[{href:"https://ithem.es/plugin-vuln-report",text:(0,u.__)("Weekly WordPress Vulnerability Report","better-wp-security")},{href:"https://ithem.es/plugin-get-started",text:(0,u.__)("Tutorials Library","better-wp-security")},{href:"https://ithem.es/plugin-security-blog",text:(0,u.__)("Security Blogs","better-wp-security")},{href:"https://ithem.es/plugin-free-webinars",text:(0,u.__)("Upcoming Webinars","better-wp-security")},{href:"https://ithem.es/plugin-ebooks",text:(0,u.__)("Security Ebooks","better-wp-security")}];function Jn(){const{installType:e}=ne();return(0,c.createElement)(S.Tg,{variant:"primary",as:b.Card},(0,c.createElement)(zn,null,(0,c.createElement)(S.X6,{level:3,text:(0,u.__)("More Security Resources","better-wp-security"),size:S.yH.NORMAL,variant:S.rK.DARK,weight:S.fs.HEAVY,align:"center",icon:(0,c.createElement)(Kn,{installType:e}),iconSize:24}),(0,c.createElement)(S.aV,{gap:3},Xn.map((e=>{let{href:t,text:n}=e;return(0,c.createElement)(S.HC,{key:t},(0,c.createElement)(Yn,{variant:"secondary",href:t,text:n}))})))))}const er=(0,Zn.Z)(S.aV,{target:"ev1ajqq0"})("display:grid;grid-template-columns:1fr;gap:0 1rem;@media (min-width: ",(e=>{let{theme:t}=e;return t.breaks.medium}),"px ){grid-template-columns:",(e=>{let{children:t}=e;return c.Children.count(t)>3&&"repeat(2, 1fr)"}),";}"),tr=[{text:(0,u.__)("User security strengthened","better-wp-security"),activeModules:["two-factor","passwordless-login","fingerprinting"]},{text:(0,u.__)("Brute force attacks blocked","better-wp-security"),activeModules:["brute-force","network-brute-force","recaptcha"]},{text:(0,u.__)("Scanning for vulnerable themes, plugins, and known malware","better-wp-security"),activeModules:["malware-scheduling"]},{text:(0,u.__)("Monitoring for suspicious file changes","better-wp-security"),activeModules:["file-change"]},{text:(0,u.__)("Banning bad bots and user agents","better-wp-security"),activeModules:["ban-users"]}];function nr(){const{allActiveModules:e}=(0,T.useSelect)((e=>({allActiveModules:e(L.MODULES_STORE_NAME).getActiveModules()})),[]),t=tr.filter((t=>{let{activeModules:n}=t;return n.find((t=>e.includes(t)))}));return t.length?(0,c.createElement)(React.Fragment,null,(0,c.createElement)(S.xv,{text:(0,u.__)("Here are some notable improvements…","better-wp-security")}),(0,c.createElement)(er,{icon:Fe.Y_,iconSize:20,gap:4},t.map(((e,t)=>{let{text:n}=e;return(0,c.createElement)(S.HC,{key:t,text:n})})))):null}const{Slot:rr,Fill:lr}=(0,b.createSlotFill)("secureSiteEnd");function ir(){dr();const[e,t]=(0,c.useState)(!1);return e?(0,c.createElement)(cr,null):(0,c.createElement)(sr,{goToEnd:()=>t(!0)})}function sr(e){let{goToEnd:t}=e;const{root:n}=(0,h.UO)(),{completeOnboarding:r}=(0,T.useDispatch)(Ft),{steps:l,currentStep:i}=(0,T.useSelect)((e=>({steps:e(Ft).getCompletionSteps(),currentStep:e(Ft).getCompletionStep()})),[]);let s;return s=!0===i?(0,u.__)("Your site has been secured.","better-wp-security"):!1===i?(0,u.__)("Click finish to secure your site.","better-wp-security"):(0,u.__)("Your site is being secured.","better-wp-security"),(0,c.createElement)(React.Fragment,null,(0,c.createElement)(ve,{title:(0,u.__)("Secure Site","better-wp-security"),subtitle:s,breadcrumbs:!1}),(0,c.createElement)("h2",{className:"itsec-secure-site-overview"},(0,u.__)("Overview","better-wp-security")),(0,c.createElement)(ur,{steps:l,currentStep:i}),(0,c.createElement)(b.Flex,{justify:"right"},(0,c.createElement)(b.FlexItem,null,!0===i?(0,c.createElement)(S.zx,{variant:"primary",onClick:t},(0,u.__)("Finish","better-wp-security")):(0,c.createElement)(S.zx,{variant:"primary",onClick:()=>r({root:n}),disabled:!1!==i},(0,u.__)("Secure Site","better-wp-security")))))}const ar=(0,Zn.Z)("div",{target:"enj9uzz1"})("display:grid;gap:1rem 2rem;grid-template-columns:1fr;@media (min-width: ",(e=>{let{theme:t}=e;return t.breaks.huge}),"px ){grid-template-columns:4fr 1fr;}"),or=(0,Zn.Z)("div",{target:"enj9uzz0"})({name:"4zk4ri",styles:"display:flex;flex-direction:column;gap:1rem"});function cr(){return(0,c.createElement)(React.Fragment,null,(0,c.createElement)("div",{className:"itsec-secure-site-page-container"},(0,c.createElement)(ar,null,(0,c.createElement)(or,null,(0,c.createElement)(Qn,null),(0,c.createElement)(nr,null)),(0,c.createElement)(Jn,null))),(0,c.createElement)(rr,null))}function ur(e){let{steps:t,currentStep:n}=e;const{root:r}=(0,h.UO)(),[l,i]=(0,c.useState)(!1),s=(0,c.useMemo)((()=>(0,E.sortBy)((0,E.filter)(t,(e=>{let{activeCallback:t}=e;return!t||t({root:r})})),"priority").map((e=>{let{render:t,...r}=e;const l=r.id===n?.id,i=r.priority<(n?.priority||0),s=r.priority>(n?.priority||0);return{name:r.id,title:r.label,text:r.label,icon:"yes-alt",render:t&&(e=>(0,c.createElement)("div",e,(0,c.createElement)(t,null))),showSpinner:!(!0===n||!l&&!s)&&(0,c.createElement)(D.$j,{size:30,color:"--itsec-primary-theme-color",paused:s}),className:i&&"itsec-secure-site-step--complete"}}))),[t,n]);return(0,c.createElement)(b.Card,null,(0,c.createElement)(D.UQ,{isStyled:!0,className:"itsec-secure-site-steps",allowNone:!0,panels:s,expanded:l,setExpanded:i}))}function dr(){const{registerCompletionStep:e}=(0,T.useDispatch)(Ft),{saveModules:t,saveSettings:n}=(0,T.useDispatch)(L.MODULES_STORE_NAME);(0,U.eH)(dr,(()=>{e({id:"savingModules",label:(0,u.__)("Enable Features","better-wp-security"),priority:5,callback:()=>t(),render:function(){const e=(0,T.useSelect)((e=>e(L.MODULES_STORE_NAME).getEditedModules()),[]).filter((e=>"active"===e.status.selected&&e.onboard));return e.length?(0,c.createElement)(React.Fragment,null,(0,c.createElement)("p",null,(0,u.__)("The following security features will be enabled:","better-wp-security")),(0,c.createElement)("ul",null,e.map((e=>(0,c.createElement)("li",{key:e.id},e.title))))):(0,c.createElement)("p",null,(0,u.__)("No additional security features have been selected.","better-wp-security"))}}),e({id:"savingSettings",label:(0,u.__)("Configure Settings","better-wp-security"),priority:10,callback:()=>n(),render:function(){const e=(0,T.useSelect)((e=>e(L.MODULES_STORE_NAME).getEditedModules().filter((e=>"active"===e.status.selected&&e.settings?.onboard?.length>0)).flatMap((t=>{const n=e(L.MODULES_STORE_NAME).getSettingEdits(t.id);return t.settings.onboard.reduce(((e,r)=>{if(!n||!n[r])return e;const l=t.settings.schema?.uiSchema?.[r]?.["ui:title"]||t.settings.schema.properties[r].title;return e.push((0,u.sprintf)((0,u.__)("%1$s: %2$s","better-wp-security"),t.title,l)),e}),[])}))),[]);return e.length?(0,c.createElement)(React.Fragment,null,(0,c.createElement)("p",null,(0,u.__)("The following settings will be configured:","better-wp-security")),(0,c.createElement)("ul",null,e.map(((e,t)=>(0,c.createElement)("li",{key:t},e))))):(0,c.createElement)("p",null,(0,u.__)("No settings have been configured.","better-wp-security"))}})}))}function mr(e){let{onDismiss:t}=e;const{next:n}=A();return(0,c.createElement)("div",{className:"itsec-onboard-welcome-page"},(0,c.createElement)($e,{style:"white",className:"itsec-onboard-welcome-page__logo"}),(0,c.createElement)(ve,{title:(0,u.__)("Welcome to iThemes Security. You are just a few clicks away from securing your site.","better-wp-security"),subtitle:(0,u.__)("The next steps will guide you through the setup process so the most important security features are enabled for your site.","better-wp-security"),breadcrumbs:!1}),(0,c.createElement)("div",{className:"itsec-onboard-welcome-page__actions-container"},(0,c.createElement)(Fe.w8,{className:"itsec-onboard-welcome-page__graphic"}),(0,c.createElement)("div",{className:"itsec-onboard-welcome-page__actions"},(0,c.createElement)(b.Button,{onClick:t,icon:"arrow-right-alt",text:(0,u.__)("Start","better-wp-security"),iconPosition:"right",variant:"primary",className:"itsec-button-icon-right"}),(0,c.createElement)(F.rU,{to:n},(0,u.__)("Skip Setup","better-wp-security")))))}function pr(){const e=R(),{url:t,path:n}=(0,h.$B)(),{pathname:r}=(0,h.TH)(),{recordVisitedLocation:l}=(0,T.useDispatch)(Ft);return(0,c.useEffect)((()=>{l(r)}),[r]),(0,c.createElement)(h.rs,null,e.map((e=>{let{id:t,render:r}=e;return(0,c.createElement)(h.AW,{path:`${n}/:page(${t})`,key:t},(0,c.createElement)(gr,{render:r}))})),(0,c.createElement)(h.AW,{path:t},e.length>0&&(0,c.createElement)(h.l_,{to:`${t}/${e[0].id}`}),(0,c.createElement)(q,null,(0,c.createElement)(de,{guided:!0,allowBack:!0})),(0,c.createElement)(W,null)))}function gr(e){let{render:t}=e;const[n,r]=(0,c.useState)(!0),l=(0,O.useMediaQuery)("(min-width: 960px)"),{isExact:i,params:{page:s}}=(0,h.$B)();return i&&"site-type"===s?l||!n?(0,c.createElement)(React.Fragment,null,l?(0,c.createElement)(fr,null):(0,c.createElement)(Er,{page:s}),(0,c.createElement)(hr,{render:t})):(0,c.createElement)(mr,{onDismiss:()=>r(!1)}):(0,c.createElement)(React.Fragment,null,(0,c.createElement)(Er,{page:s}),(0,c.createElement)(hr,{render:t}))}function Er(e){let{page:t}=e;return(0,c.createElement)(q,null,(0,c.createElement)(de,{guided:!0,allowBack:!0}),"site-type"===t&&(0,c.createElement)(_r,null))}function hr(e){let{render:t}=e;return(0,c.createElement)(W,null,(0,c.createElement)(D.ot,null),(0,c.createElement)(t,null))}function fr(){return(0,c.createElement)(q,{className:"itsec-onboard-welcome-sidebar",logo:"white"},(0,c.createElement)("p",{className:"itsec-onboard-welcome-sidebar__lead"},(0,u.__)("Welcome to iThemes Security. You are just a few clicks away from securing your site.","better-wp-security")),(0,c.createElement)("p",{className:"itsec-onboard-welcome-sidebar__content"},(0,u.__)("The next steps will guide you through the setup process so the most important security features are enabled for your site.","better-wp-security")),(0,c.createElement)(_r,{showGraphic:!0}))}function _r(e){let{showGraphic:t}=e;const{next:n}=A();return(0,c.createElement)("div",{className:"itsec-onboard-skip-setup"},t&&(0,c.createElement)(Fe.w8,{className:"itsec-onboard-welcome-sidebar__graphic"}),(0,c.createElement)("div",{className:"itsec-onboard-skip-setup__text"},(0,c.createElement)(F.rU,{to:n},(0,u.__)("Skip Setup","better-wp-security")),(0,c.createElement)("p",{className:"itsec-onboard-skip-setup__description"},(0,u.__)("Proceed with default settings.","better-wp-security"))))}function yr(){const e=R(),{url:t,path:n}=(0,h.$B)();return(0,c.createElement)(h.rs,null,e.map((e=>{let{id:t,render:r}=e;return(0,c.createElement)(h.AW,{path:`${n}/:page(${t})`,key:t},(0,c.createElement)(q,null,(0,c.createElement)(de,null),(0,c.createElement)(Ee,null)),(0,c.createElement)(W,null,(0,c.createElement)(D.ot,null),(0,c.createElement)(r,null)))})),(0,c.createElement)(h.AW,{path:t},e.length>0&&(0,c.createElement)(h.l_,{to:`${t}/${e[0].id}`}),(0,c.createElement)(q,null,(0,c.createElement)(de,null),(0,c.createElement)(Ee,null)),(0,c.createElement)(W,null)))}function br(){const e=R(),{url:t,path:n}=(0,h.$B)();return e.length>0&&!e.find((e=>"select-export"===e.id))?(0,c.createElement)(h.l_,{to:"/"}):(0,c.createElement)(h.rs,null,e.map((e=>{let{id:t,render:r}=e;return(0,c.createElement)(h.AW,{path:`${n}/:page(${t})`,key:t},(0,c.createElement)(q,null,(0,c.createElement)(de,{guided:!0,allowBack:!0,allowForward:"select-export"!==t})),(0,c.createElement)(W,null,(0,c.createElement)(D.ot,null),(0,c.createElement)(r,null)))})),(0,c.createElement)(h.AW,{path:t},e.length>0&&(0,c.createElement)(h.l_,{to:`${t}/${e[0].id}`}),(0,c.createElement)(q,null,(0,c.createElement)(de,{guided:!0,allowBack:!0})),(0,c.createElement)(W,null)))}function vr(){return(0,c.createElement)(React.Fragment,null,(0,c.createElement)(C,{id:"site-type",title:(0,u.__)("Site Type","better-wp-security"),priority:0,roots:["onboard"]},(()=>(0,c.createElement)(yn,null))),(0,c.createElement)(C,{id:"modules",title:(0,u.__)("Features","better-wp-security"),icon:"shield",priority:5,roots:["onboard","settings","import"]},(()=>(0,c.createElement)(bn,null))),(0,c.createElement)(C,{id:"configure",title:(0,u.__)("Configure","better-wp-security"),icon:"admin-settings",priority:15,roots:["onboard","settings","import"],ignore:["/advanced/"]},(()=>(0,c.createElement)(Cn,null))),(0,c.createElement)(C,{id:"secure-site",title:(0,u.__)("Secure Site","better-wp-security"),priority:100,roots:["onboard","import"]},(()=>(0,c.createElement)(ir,null))),(0,c.createElement)(C,{id:"tools",title:(0,u.__)("Tools","better-wp-security"),icon:"admin-tools",priority:80,location:"advanced",roots:["settings"]},(()=>(0,c.createElement)(Pn,null))))}function Sr(){const{registerProvider:e}=(0,T.useDispatch)(V.G);(0,U.eH)(Sr,(()=>{e("modules",(0,u.__)("Features","better-wp-security"),5,(e=>{let{registry:t,evaluate:n,results:r}=e;return t.select(L.MODULES_STORE_NAME).getEditedModules().reduce(((e,t)=>{const l=Nr(t);return l&&(n.stringMatch(t.title)||n.stringMatch(t.description)||n.keywordMatch(t.keywords))?(r.items.push({title:t.title,description:t.description,route:l}),e+1):e}),0)})),e("settings",(0,u.__)("Settings","better-wp-security"),20,(e=>{let{registry:t,evaluate:n,results:r}=e;return t.select(L.MODULES_STORE_NAME).getEditedModules().reduce(((e,t)=>{if("active"!==t.status.selected||!t.settings?.interactive?.length)return e;const l=Nr(t);return l?e+t.settings.interactive.reduce(((e,i)=>{var s,a,o;const c=t.settings.schema.properties[i],u=t.settings.schema.uiSchema?.[i];if(!c)return e;const d=u?.ui?.title||u?.["ui:title"]||c.title,m=u?.ui?.description||u?.["ui:description"]||c.description;return n.stringMatch(d)||n.stringMatch(m)||n.keywordMatch(c.keywords)?(null!==(o=(s=r.groups)[a=t.id])&&void 0!==o||(s[a]={title:t.title,items:[]}),r.groups[t.id].items.push({title:d,description:m,route:`${l}#${i}`}),e++):e}),0):e}),0)})),e("tools",(0,u.__)("Tools","better-wp-security"),100,(e=>{let{registry:t,evaluate:n,results:r}=e;return t.select(mn).getResolvedTools().reduce(((e,t)=>t.available&&(n.stringMatch(t.title)||n.stringMatch(t.description)||n.keywordMatch(t.keywords))?(r.items.push({title:t.title,description:t.description,route:`/settings/tools#${t.slug}`}),e+1):e),0)}))}))}function Nr(e){if("custom"===e.type||"tool"===e.type)return;if("password-requirements"===e.id)return"/settings/user-groups?module=password-requirements";const t=`/settings/modules/${e.type}#${e.id}`;return"inactive"===e.status.selected?t:e.settings?.interactive.length>0?"recommended"===e.type?`/settings/configure/${e.id}`:`/settings/configure/${e.type}/${e.id}`:"always-active"!==e.status.default?t:void 0}function Or(e){let{history:t,serverType:n,installType:r,onboardComplete:l}=e;Sr();const i=l?"/settings":"/onboard";return(0,c.createElement)(y.a,{theme:S.uH},(0,c.createElement)("div",{className:"itsec-settings"},(0,c.createElement)(te.Provider,{value:{serverType:n,installType:r,onboardComplete:l}},(0,c.createElement)(h.F0,{history:t},(0,c.createElement)(f.Fz,{ReactRouterRoute:h.AW},(0,c.createElement)(b.SlotFillProvider,null,(0,c.createElement)(_.ErrorBoundary,{FallbackComponent:Tr},(0,c.createElement)(w,null,(0,c.createElement)(vr,null),(0,c.createElement)(v.PluginArea,null),(0,c.createElement)(b.Popover.Slot,null),(0,c.createElement)(h.rs,null,(0,c.createElement)(h.AW,{path:"/:root(settings)",component:yr}),(0,c.createElement)(h.AW,{path:"/:root(onboard)",component:pr}),(0,c.createElement)(h.AW,{path:"/:root(import)",component:br}),(0,c.createElement)(h.AW,{path:"/"},(0,c.createElement)(h.l_,{to:i}),(0,c.createElement)(q,null),(0,c.createElement)(W,null)))))))))))}function Tr(e){return(0,c.createElement)(b.Flex,null,(0,c.createElement)(b.FlexBlock,null,(0,c.createElement)(De,e)))}n.p=window.itsecWebpackPublicPath,(0,u.setLocaleData)({"":{}},"better-wp-security");const Lr=function(e,t){const n=(0,p.lX)(),r=n=>{const r="string"==typeof n?(0,p.cP)(n):n,l=(0,g.parse)(r.search?.substring(1))||{};return{...r,pathname:e.pathname,search:"?"+(0,g.stringify)({...l,path:r.pathname,...t})}};return{get length(){return n.length},get action(){return n.action},get location(){const e=(0,g.parse)(n.location.search.substring(1)),r=e.path||"/";return{...n.location,pathname:r,search:"?"+(0,g.stringify)((0,E.omit)(e,["path",Object.keys(t)]))}},createHref:e=>n.createHref(r(e)),push:(e,t)=>{n.push(r(e),t)},replace:(e,t)=>{n.replace(r(e),t)},go:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.go.apply(n,t)},goBack:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.goBack.apply(n,t)},goForward:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.goForward.apply(n,t)},block:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.block.apply(n,t)},listen(e){return n.listen((()=>{e(this.location,this.action)}))}}}(document.location,{page:"itsec"});m()((()=>{const e=document.getElementById("itsec-settings-root"),t=e.dataset.serverType,n=e.dataset.installType,r="1"===e.dataset.onboard;return(0,c.render)((0,c.createElement)(Or,{history:Lr,serverType:t,installType:n,onboardComplete:r}),e)}))},33590:(e,t,n)=>{"use strict";n.d(t,{bB:()=>q,ZP:()=>z});var r={};n.r(r),n.d(r,{BaseInput:()=>u,CheckboxWidget:()=>p,CheckboxesWidget:()=>g,IncludeExcludeWidget:()=>x,RadioWidget:()=>L,SelectWidget:()=>b,TextareaWidget:()=>v,ToggleWidget:()=>m});var l={};n.r(l),n.d(l,{EntitySelectField:()=>A,FileTreeField:()=>U,TextareaListField:()=>D,TitleField:()=>M});var i=n(92819),s=n(87462),a=n(6293),o=n(64893),c=n(19144);const u=function(e){const{id:t,label:n,value:r,readonly:l,disabled:u,onBlur:d,onFocus:m,options:p,onChange:g,schema:E,uiSchema:h={},...f}=e;p.inputType?f.type=p.inputType:f.type||("number"===E.type?(f.type="number",f.step="any"):"integer"===E.type?(f.type="number",f.step="1"):f.type="text"),p.autocomplete&&(f.autoComplete=p.autocomplete),E.multipleOf&&(f.step=E.multipleOf),void 0!==E.minimum&&(f.min=E.minimum),void 0!==E.maximum&&(f.max=E.maximum);const _=h["ui:description"]||E.description;return(0,a.createElement)(o.TextControl,(0,s.Z)({label:n,help:(0,a.createElement)(c.Lu,{noWrap:!0,content:_}),readOnly:l,disabled:u,value:r||""},(0,i.omit)(f,["autofocus","formContext","registry","rawErrors"]),{onChange:e=>g(""===e?p.emptyValue:e),onBlur:d&&(e=>d(f.id,e.target.value)),onFocus:m&&(e=>m(f.id,e.target.value))}))};var d=n(54639);function m(e){let{schema:t,uiSchema:n={},id:r,value:l,disabled:i,readonly:s,label:u,onBlur:m,onFocus:p,onChange:g}=e;const E=d.P6.schemaRequiresTrueValue(t),h=n["ui:description"]||t.description;return(0,a.createElement)(o.ToggleControl,{checked:l||!1,onChange:g,required:E,disabled:i,readOnly:s,label:u,help:(0,a.createElement)(c.Lu,{noWrap:!0,content:h}),onBlur:m&&(e=>m(r,e.target.checked)),onFocus:p&&(e=>p(r,e.target.checked))})}function p(e){let{schema:t,uiSchema:n={},id:r,value:l,disabled:i,readonly:s,label:u,onBlur:m,onFocus:p,onChange:g}=e;const E=d.P6.schemaRequiresTrueValue(t),h=n["ui:description"]||t.description;return(0,a.createElement)(o.CheckboxControl,{checked:l||!1,onChange:g,required:E,disabled:i,readOnly:s,label:u,help:(0,a.createElement)(c.Lu,{noWrap:!0,content:h}),onBlur:m&&(e=>m(r,e.target.checked)),onFocus:p&&(e=>p(r,e.target.checked))})}function g(e){const{disabled:t,options:n,value:r,readonly:l,onChange:i,label:s,schema:o,uiSchema:u={}}=e,{enumOptions:d,enumDisabled:m=[],enumDescriptions:p=[]}=n,g=u["ui:description"]||o.description,E=d.map(((e,t)=>({...e,disabled:m.includes(e.value),help:p[t]&&(0,a.createElement)(c.Lu,{noWrap:!0,content:p[t]})})));return(0,a.createElement)(c.w2,{value:r||[],onChange:i,options:E,label:s||u["ui:title"]||o.title,help:(0,a.createElement)(c.Lu,{noWrap:!0,content:g}),readOnly:l,disabled:t})}const{asNumber:E,guessType:h}=d.P6,f=new Set(["number","integer"]);function _(e,t){const{type:n,items:r}=e;if(""!==t){if("array"===n&&r&&f.has(r.type))return t.map(E);if("boolean"===n)return"true"===t;if("number"===n)return E(t);if(e.enum){if(e.enum.every((e=>"number"===h(e))))return E(t);if(e.enum.every((e=>"boolean"===h(e))))return"true"===t}return t}}function y(e,t){return t?[].slice.call(e.target.options).filter((e=>e.selected)).map((e=>e.value)):e.target.value}const b=function(e){const{schema:t,uiSchema:n={},id:r,options:l,value:i,label:s,required:u,disabled:d,readonly:m,multiple:p,onChange:g,onBlur:E,onFocus:h,placeholder:f}=e,{enumOptions:b,enumDisabled:v}=l,S=p?[]:"",N=[];p||void 0!==t.default||N.push({value:"",label:f});for(const e of b)N.push({...e,disabled:v&&v.includes(e.value)});const O=n["ui:description"]||t.description;return(0,a.createElement)(o.SelectControl,{multiple:p,options:N,value:void 0===i?S:i,label:s,help:(0,a.createElement)(c.Lu,{noWrap:!0,content:O}),required:u,disabled:d,readOnly:m,onChange:e=>g(_(t,e)),onBlur:E&&(e=>E(r,_(t,y(e,p)))),onFocus:h&&(e=>h(r,_(t,y(e,p))))})};function v(e){let{schema:t,uiSchema:n={},id:r,value:l,disabled:u,readonly:d,label:m,onBlur:p,onFocus:g,onChange:E,...h}=e;const f=n["ui:description"]||t.description;return(0,a.createElement)(o.TextareaControl,(0,s.Z)({value:void 0===l?"":l,onChange:E,disabled:u,readOnly:d,label:m,help:(0,a.createElement)(c.Lu,{noWrap:!0,content:f}),onBlur:p&&(e=>p(r,e.target.value)),onFocus:g&&(e=>g(r,e.target.value))},(0,i.without)(h,["autofocus","formContext","registry","rawErrors"])))}const{asNumber:S,guessType:N}=d.P6,O=new Set(["number","integer"]);function T(e,t){const{type:n,items:r}=e;if(""!==t){if("array"===n&&r&&O.has(r.type))return t.map(S);if("boolean"===n)return"true"===t;if("number"===n)return S(t);if(e.enum){if(e.enum.every((e=>"number"===N(e))))return S(t);if(e.enum.every((e=>"boolean"===N(e))))return"true"===t}return t}}function L(e){let{schema:t,uiSchema:n={},id:r,options:l,value:i,label:s,required:u,disabled:d,readonly:m,onChange:p,onBlur:g,onFocus:E}=e;const{enumOptions:h}=l,f=n["ui:description"]||t.description;return(0,a.createElement)(o.RadioControl,{selected:i,options:h,label:s,help:(0,a.createElement)(c.Lu,{noWrap:!0,content:f}),required:u,disabled:d,readOnly:m,onChange:e=>p(T(t,e)),onBlur:g&&(e=>g(r,T(t,e.target.value))),onFocus:E&&(e=>E(r,T(t,e.target.value)))})}var I=n(95122),w=n(82839),C=n(81019);function x(e){let{id:t,disabled:n,options:r,value:l,onChange:s,schema:c,autofocus:u,readonly:d}=e;const{enumOptions:m,enumDisabled:p=[],excludeList:{title:g=(0,I.__)("Excluded","better-wp-security"),description:E=(0,I.__)("The list of items to exclude from the selection.","better-wp-security"),button:h=(0,I.__)("Include","better-wp-security")}={},includeList:{title:f=(0,I.__)("Included","better-wp-security"),description:_=(0,I.__)("The list of items to include in the selection.","better-wp-security"),button:y=(0,I.__)("Exclude","better-wp-security")}={},title:b=c.title,description:v=c.description}=r;(0,a.useEffect)((()=>{const e=m.map((e=>e.value)),t=l.filter((t=>e.includes(t)));t.length!==l.length&&s(t)}),[l,m,s]);const[S,N]=(0,i.partition)(m,(e=>!l.includes(e.value)));return(0,a.createElement)("div",{className:"itsec-rjsf-include-exclude-widget"},b&&(0,a.createElement)(o.BaseControl.VisualLabel,null,b),v&&(0,a.createElement)("p",null,v),(0,a.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__sides",id:t},(0,a.createElement)(R,{id:t+"__exclude",options:S,label:g,description:E,button:h,disabled:n||d,disabledOptions:p,autofocus:u,onToggle:e=>{(0,w.speak)((0,I.sprintf)((0,I.__)("Moved %1$s to %2$s.","better-wp-security"),(0,i.find)(S,{value:e}).label,f)),s([...l,e])}}),(0,a.createElement)(R,{id:t+"__include",options:N,label:f,description:_,button:y,disabled:n||d,disabledOptions:p,onToggle:e=>{(0,w.speak)((0,I.sprintf)((0,I.__)("Moved %1$s to %2$s.","better-wp-security"),(0,i.find)(N,{value:e}).label,g)),s(l.filter((t=>t!==e)))}})))}function R(e){let{id:t,label:n,description:r,options:l,button:s,onToggle:u,disabled:d,disabledOptions:m=[],autofocus:p}=e;const g=t+"__option__",[E,h]=(0,a.useState)("");return E&&!(0,i.find)(l,{value:E})&&h(""),(0,a.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__side"},(0,a.createElement)(o.BaseControl,{id:t,help:(0,a.createElement)(c.Lu,{noWrap:!0,content:r}),className:"itsec-rjsf-include-exclude-widget__listbox"},(0,a.createElement)("span",{className:"components-base-control__label",id:t+"__label"},n),(0,a.createElement)(c.T2,{role:"listbox",id:t,active:E&&g+E,"aria-labelledby":t+"__label","aria-describedby":r&&t+"__help",onNavigate:e=>h(e.substr(g.length)),onKeyDown:e=>{let{keyCode:t}=e;if(!E||t!==C.DELETE&&t!==C.BACKSPACE)return;const n=(0,i.findIndex)(l,{value:E}),r=n+1<l.length?n+1:n-1;u(E),h(l[r]?.value||"")},autoFocus:p},l.map((e=>(0,a.createElement)("div",{id:g+e.value,key:e.value,role:d||m.includes(e.value)?"presentation":"option","aria-selected":e.value===E||void 0,onClick:d||m.includes(e.value)?void 0:()=>h(e.value)},e.label))))),(0,a.createElement)(o.Button,{variant:"secondary",disabled:!E,className:"itsec-rjsf-include-exclude-widget__move",onClick:()=>u(E),"aria-keyshortcuts":"Delete Backspace"},s))}function M(e){const{id:t,title:n,required:r}=e;return(0,a.createElement)("span",{className:"itsec-rjsf-title-field",id:t},n,r&&(0,a.createElement)("span",{className:"required"},"*"))}const{getUiOptions:k}=d.P6;function A(e){let{uiSchema:t,schema:n,idSchema:r,name:l,formData:i,disabled:s,readonly:o,onChange:u}=e;const d=k(t);return(0,a.createElement)(c.fv,{id:r.$id,value:i,disabled:s,readonly:o,onChange:u,isMultiple:"array"===n.type,label:t["ui:title"]||n.title||l,description:t["ui:description"]||n.description,path:d.path,query:d.query,labelAttr:d.labelAttr,idAttr:d.idAttr,searchArg:d.searchArg})}const{getUiOptions:F}=d.P6;function D(e){let{uiSchema:t,schema:n,name:r,formData:l,disabled:i,readonly:s,onChange:o}=e;const u=t["ui:title"]||n.title||r,d=t["ui:description"]||n.description,m=F(t),{rows:p,placeholder:g}=m;return(0,a.createElement)(c.yA,{label:u,help:(0,a.createElement)(c.Lu,{noWrap:!0,content:d}),disabled:i,readonly:s,rows:p,value:l,onChange:o,placeholder:g})}var $=n(87514),P=n.n($),B=n(73470);function U(e){let{idSchema:t,formData:n,onChange:r,uiSchema:l,schema:s,name:u,disabled:d,readonly:m,autofocus:p}=e;const g=t.$id,E=l["ui:title"]||s.title||u,h=l["ui:description"]||s.description,[f,_]=(0,a.useState)([]),[y,b]=(0,a.useState)("");(0,a.useEffect)((()=>{P()({path:(0,B.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:"/"})}).then(_)}),[]);const v=e=>{r(n.includes(e)?n.filter((t=>t!==e)):[...n,e])};return(0,a.createElement)("div",{className:"itsec-rjsf-file-tree"},h&&(0,a.createElement)(c.Lu,{content:h,tagName:"p"}),(0,a.createElement)("div",{className:"itsec-rjsf-file-tree__controls"},(0,a.createElement)("div",null,(0,a.createElement)(c.mp,{tree:f,id:g,label:(0,I.__)("File Selector","better-wp-security"),active:y,setActive:b,onActivate:v,onLoad:async e=>{const t=await P()({path:(0,B.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:e})}),n=(0,i.cloneDeep)(f);(0,c.in)(n,(n=>{if(n.id===e)return n.children=t,c.in.halt})),_(n)}}),(0,a.createElement)(o.Button,{variant:"secondary",disabled:!y,className:"itsec-rjsf-file-tree__select",onClick:()=>v(y),"aria-keyshortcuts":"Enter Space"},(0,I.__)("Select","better-wp-security"))),(0,a.createElement)(c.yA,{value:n,onChange:r,className:"itsec-rjsf-file-tree__list",label:E,disabled:d,readonly:m,autoFocus:p})))}function q(e){let{name:t,...n}=e;return(0,a.createElement)(o.Fill,(0,s.Z)({name:`RjsfField${t}`},n))}function W(e){let{name:t,...n}=e;return(0,a.createElement)(o.Slot,(0,s.Z)({name:`RjsfField${t}`},n))}const{ADDITIONAL_PROPERTY_FLAG:H,getUiOptions:Z}=d.P6;function j(e){const{id:t,classNames:n,disabled:r,label:l,onKeyChange:i,onDropPropertyClick:s,readonly:c,required:u,schema:d,uiSchema:m}=e,p=`${l} Key`,g=d.hasOwnProperty(H),{removable:E}=Z(m);return g&&!1!==E?(0,a.createElement)("div",{className:n},(0,a.createElement)("div",{className:"row"},(0,a.createElement)("div",{className:"col-xs-5 form-additional"},(0,a.createElement)(o.TextControl,{label:p,required:u,id:`${t}-key`,onBlur:e=>i(e.target.value)})),(0,a.createElement)("div",{className:"form-additional form-group col-xs-5"},e.children),(0,a.createElement)("div",{className:"col-xs-2"},(0,a.createElement)(o.Button,{icon:"no-alt",isDestructive:!0,disabled:r||c,onClick:s(l)})))):(0,a.createElement)("div",{className:n},e.children)}const{canExpand:V}=d.P6;function G(e){let{className:t,onClick:n,disabled:r}=e;return(0,a.createElement)("div",{className:"row"},(0,a.createElement)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${t}`},(0,a.createElement)(o.Button,{icon:"plus-alt2",className:"btn-add col-xs-12","aria-label":(0,I.__)("Add","better-wp-security"),tabIndex:"0",onClick:n,disabled:r})))}const Q={FieldTemplate:function(e){const{children:t,errors:n,hidden:r,schema:l,uiSchema:i,formContext:s,onChange:c}=e;if(r)return null;const{resettable:u}=Z(i);return(0,a.createElement)(j,e,t,(0,a.createElement)(W,{name:e.id,fillProps:e}),u&&(0,a.createElement)(o.Button,{className:"itsec-rjsf-reset-field",variant:"secondary",onClick:()=>c(l.default)},(0,I.__)("Restore Default","better-wp-security")),!0!==s?.disableInlineErrors&&n)},ObjectFieldTemplate:function(e){const{TitleField:t,DescriptionField:n,schema:r,uiSchema:l,properties:i}=e;if(!i.length)return null;const s=(l["ui:sections"]||[]).reduce(((e,t)=>({...e,[t.fields.find((e=>!!r.properties[e]))]:t})),{});return(0,a.createElement)("div",{className:"itsec-rjsf-object-fieldset",id:e.idSchema.$id},(l["ui:title"]||e.title)&&(0,a.createElement)(t,{id:`${e.idSchema.$id}__title`,title:e.title||l["ui:title"],required:e.required,formContext:e.formContext}),e.description&&(0,a.createElement)(n,{id:`${e.idSchema.$id}__description`,description:(0,a.createElement)(c.Lu,{noWrap:!0,content:e.description}),formContext:e.formContext}),i.map((e=>{let{name:t,content:n}=e;return s[t]?(0,a.createElement)(a.Fragment,{key:t},(0,a.createElement)("h3",{className:"itsec-rjsf-section-title"},s[t].title),s[t].description&&(0,a.createElement)("p",{className:"itsec-rjsf-section-description"},(0,a.createElement)(c.Lu,{noWrap:!0,content:s[t].description})),n):n})),V(r,l,e.formData)&&(0,a.createElement)(G,{className:"object-property-expand",onClick:e.onAddClick(r),disabled:e.disabled||e.readonly}))},ErrorList:function(e){let{errors:t}=e;return(0,a.createElement)(c.KM,{errors:t.map((function(){let{stack:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e})).filter((e=>!!e))})},widgets:r,fields:l},z=Q},50460:(e,t,n)=>{"use strict";n.d(t,{G:()=>P,o:()=>C});var r={};n.r(r),n.d(r,{REGISTER_PROVIDER:()=>F,registerProvider:()=>A});var l={};n.r(l),n.d(l,{getProviders:()=>D});var i=n(87462),s=n(6293),a=n(73727),o=n(16550),c=n(90071),u=n(92819),d=n(64893),m=n(95122),p=n(48015),g=n(9576),E=n(81019),h=n(82839),f=n(78363),_=n(91991),y=n(19144),b=n(86033),v=n(13092);function S(e,t,n){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}var N=new WeakMap,O=new WeakMap,T=new WeakMap,L=new WeakMap,I=new WeakMap;class w{constructor(e,t){S(this,N,{writable:!0,value:void 0}),S(this,O,{writable:!0,value:void 0}),S(this,T,{writable:!0,value:void 0}),S(this,L,{writable:!0,value:void 0}),S(this,I,{writable:!0,value:void 0}),(0,v.Z)(this,N,e),(0,v.Z)(this,O,t),(0,v.Z)(this,T,t.select(P).getProviders()),this._prepare()}_prepare(){(0,v.Z)(this,I,(0,b.Z)(this,N).split(/\s+/g).map((e=>e.trim().toLowerCase())).filter((e=>!!e)));const e=(0,b.Z)(this,N).endsWith(" ");(0,v.Z)(this,L,new RegExp((0,b.Z)(this,I).map(((t,n)=>n+1!==(0,b.Z)(this,I).length||e?`(?=.*\\b${(0,u.escapeRegExp)(t)}\\b)`:`(?=.*\\b${(0,u.escapeRegExp)(t)})`)).join("")+".+","gi"))}_stringMatch(e){return e&&(0,b.Z)(this,L).test(e)}_keywordMatch(e){return!(!e||!e.length)&&e.some((e=>(0,b.Z)(this,I).some(((t,n)=>e.includes(" ")?this._stringMatch(e):n===(0,b.Z)(this,I).length-1?e.startsWith(t):t===e))))}getResults(){if((0,b.Z)(this,N).length<3)return[{},0];let e=0;const t=[],n={stringMatch:e=>this._stringMatch(e),keywordMatch:e=>this._keywordMatch(e)};for(const r of(0,b.Z)(this,T)){const l={title:r.title,items:[],groups:{}};e+=r.callback({evaluate:n,results:l,registry:(0,b.Z)(this,O)}),!l.items.length&&(0,u.isEmpty)(l.groups)||t.push(l)}return[t,e]}}const C=(0,s.forwardRef)((function(e,t){let{onPick:n=u.noop,showResults:r}=e;const[l,a]=(0,s.useState)(""),[o,c]=(0,s.useState)(!1),d=(0,s.useRef)(),y=(0,s.useRef)(),[b,v]=(0,s.useState)([]),S=(0,p.useRegistry)(),N=(0,s.useCallback)((e=>{const t=new w(e,S).getResults();v(t[0]),(0,h.speak)((0,m.sprintf)((0,m._n)("%d result found.","%d results found.",t[1],"better-wp-security"),t[1]))}),[S]),O=(0,g.useDebounce)(N,50),T=(0,s.useCallback)((e=>{d.current&&(e.preventDefault(),d.current.focus())}),[d]);return(0,g.useKeyboardShortcut)("/",T),(0,s.createElement)("div",(0,i.Z)({className:"itsec-search"},(0,_.Zk)((()=>c(!1)))),(0,s.createElement)("div",null,(0,s.createElement)(f.lD,{value:l,onChange:e=>{a(e),O(e)},onFocus:()=>c(!0),onKeyDown:e=>{e.keyCode===E.DOWN&&(e.preventDefault(),y.current.focus())},ref:(0,_.qq)([t,d]),placeholder:(0,m.__)("Search for feature, settings, and more","better-wp-security"),omitSeparators:!0}),(o||r)&&l.length>=3&&(0,s.createElement)(x,{results:b,exitSearch:e=>{n(e),c(!1)},ref:y,onPick:n})))})),x=(0,s.forwardRef)((function(e,t){let{results:n,exitSearch:r,onPick:l}=e;const a=(0,s.useRef)();(0,s.useImperativeHandle)(t,(()=>({focus(){a.current.focus()}})));const p=(0,g.useInstanceId)(x,"itsec-search"),h=p+"__result__",f=function(){const e=(0,o.k6)();return function(t){return e[arguments.length>1&&void 0!==arguments[1]?arguments[1]:"push"]((0,c.ob)(t))}}(),[_,b]=(0,s.useState)("");return(0,u.isEmpty)(n)?null:(0,s.createElement)(React.Fragment,null,(0,s.createElement)(d.VisuallyHidden,{id:p+"__label"},(0,m.__)("Search Results","better-wp-security")),(0,s.createElement)(y.T2,{className:"itsec-search__results",id:p,active:_&&h+_,onNavigate:e=>b(e.substr(h.length)),onKeyDown:e=>{let{keyCode:t}=e;!_||t!==E.ENTER&&t!==E.SPACE||(l(_),f(_),r())},onFocus:()=>{if(!_&&!(0,u.isEmpty)(n)){const[,e]=Object.entries(n)[0];if(e.items?.length)b(e.items[0].route);else if(!(0,u.isEmpty)(e.groups)){const[,t]=Object.entries(e.groups)[0];b(t.items[0].route)}}},role:"listbox",descendantRoles:"option",ref:a,"aria-labelledby":p+"__label"},(0,u.map)(n,((e,t)=>(0,s.createElement)(R,(0,i.Z)({key:t},e,{active:_,idPrefix:h,exitSearch:r}))))))}));function R(e){let{title:t,items:n,groups:r,...l}=e;const a=(0,g.useInstanceId)(x,"itsec-search__kind");return(0,s.createElement)("ul",{className:"itsec-search__kind",role:"group","aria-labelledby":a},(0,s.createElement)("li",{role:"presentation",id:a},t),(n||[]).map((e=>(0,s.createElement)(k,(0,i.Z)({key:e.route},e,l)))),(0,u.map)(r,((e,t)=>(0,s.createElement)(M,(0,i.Z)({key:t},e,l)))))}function M(e){let{title:t,items:n,...r}=e;const l=(0,g.useInstanceId)(x,"itsec-search__group");return(0,s.createElement)("ul",{className:"itsec-search__group",role:"group","aria-labelledby":l},(0,s.createElement)("li",{role:"presentation",id:l},(0,s.createElement)("span",null,t)),(n||[]).map((e=>(0,s.createElement)(k,(0,i.Z)({key:e.route},e,r)))))}function k(e){let{title:t,description:n,route:r,active:l,idPrefix:i,exitSearch:o}=e;return(0,s.createElement)("li",{className:"itsec-search__result",role:"option","aria-selected":l===r||void 0,id:i+r,"aria-label":t},(0,s.createElement)(a.rU,{to:r,tabIndex:-1,onClick:()=>o(r)},(0,s.createElement)("span",null,t),(0,s.createElement)(y.Lu,{content:n,noHtml:!0,tagName:"p"})))}function A(e,t,n,r){return{type:F,slug:e,title:t,priority:n,callback:r}}const F="REGISTER_PROVIDER",D=(0,n(28306).Z)((e=>(0,u.sortBy)(e.providers,"priority")),(e=>e.providers)),$={providers:{}},P="ithemes-security/search";(0,p.registerStore)(P,{actions:r,selectors:l,reducer:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$,t=arguments.length>1?arguments[1]:void 0;return t.type===F?{...e,providers:{...e.providers,[t.slug]:(0,u.omit)(t,["type"])}}:e}})},31600:e=>{e.exports=function(){return this.itsec.packages.data}()},82839:e=>{e.exports=function(){return this.wp.a11y}()},87514:e=>{e.exports=function(){return this.wp.apiFetch}()},64893:e=>{e.exports=function(){return this.wp.components}()},9576:e=>{e.exports=function(){return this.wp.compose}()},48015:e=>{e.exports=function(){return this.wp.data}()},25993:e=>{e.exports=function(){return this.wp.domReady}()},6293:e=>{e.exports=function(){return this.wp.element}()},54761:e=>{e.exports=function(){return this.wp.hooks}()},95122:e=>{e.exports=function(){return this.wp.i18n}()},81834:e=>{e.exports=function(){return this.wp.isShallowEqual}()},81019:e=>{e.exports=function(){return this.wp.keycodes}()},3571:e=>{e.exports=function(){return this.wp.plugins}()},14776:e=>{e.exports=function(){return this.wp.primitives}()},73470:e=>{e.exports=function(){return this.wp.url}()},99196:e=>{"use strict";e.exports=window.React},91850:e=>{"use strict";e.exports=window.ReactDOM},92819:e=>{"use strict";e.exports=window.lodash}},e=>{e.O(0,[271,655,363,96,639,434,986,991,144,783],(()=>(46385,e(e.s=46385))));var t=e.O();((window.itsec=window.itsec||{}).pages=window.itsec.pages||{}).settings=t}]);